<!DOCTYPE html>
<html xmlns:og="http://ogp.me/ns#" prefix="og: http://ogp.me/ns#">
<head>
<title>MockServer</title>
<link rel=author href="https://plus.google.com/u/0/110954472544793839756">
<link rel=apple-touch-icon-precomposed href=apple-touch-icon.png />
<link rel="shortcut icon" href=apple-touch-icon.png>
<link rel=canonical href="http://www.mock-server.com/index.html"/>
<meta http-equiv=Content-Type content="text/html; charset=UTF-8">
<meta name=format-detection content="telephone=no">
<meta name=viewport content="width=device-width, initial-scale=1.0">
<meta name=google-site-verification content=QIzvnb0rY1MnkLjIDI217X0RjxZCX2tWdUp1CvejoVw />
<meta name=msvalidate.01 content=9DBA7A5F05A6179123259382E10FB4A7 />
<meta id=description name=description content="An API to easily mock any system or service you integrate with via HTTP from either Java or JavaScript.">
<meta name=title content="Mock Server">
<meta property=og:locale content=en_GB>
<meta property=og:type content=website>
<meta property=og:image content="http://www.mock-server.com/apple-touch-icon.png">
<meta property=og:url content="http://www.mock-server.com/">
<meta property=og:site_name content=MockServer>
<meta property=og:title content=MockServer>
<meta property=og:description content="An API to easily mock any system or service you integrate with via HTTP or HTTPS from either Java or JavaScript.">
<meta property=article:author content="James D Bloom">
<link rel=stylesheet href="http://yui.yahooapis.com/pure/0.3.0/pure-min.css">
<style>@font-face{font-family:'Amatic SC';font-style:normal;font-weight:400;src:local('Amatic SC Regular'), local('AmaticSC-Regular'), url(http://fonts.gstatic.com/s/amaticsc/v6/Okxzx9KFf3K6HDHUkyuFnALUuEpTyoUstqEm5AMlJo4.woff2) format('woff2');}
@font-face{font-family:'Amatic SC';font-style:normal;font-weight:400;src:local('Amatic SC Regular'), local('AmaticSC-Regular'), url(http://fonts.gstatic.com/s/amaticsc/v6/DPPfSFKxRTXvae2bKDzp5JBw1xU1rKptJj_0jans920.woff2) format('woff2');unicode-range:U+0000-00FF, U+0131, U+0152-0153, U+02C6, U+02DA, U+02DC, U+2000-206F, U+2074, U+20AC, U+2212, U+2215, U+E0FF, U+EFFD, U+F000;}
@font-face{font-family:'Averia Sans Libre';font-style:normal;font-weight:300;src:local('Averia Sans Libre Light'), local('AveriaSansLibre-Light'), url(http://fonts.gstatic.com/s/averiasanslibre/v4/_9-jTfQjaBsWAF_yp5z-V04cM99XCQRVmxgO633ffOA.woff2) format('woff2');}
@font-face{font-family:'Averia Sans Libre';font-style:normal;font-weight:300;src:local('Averia Sans Libre Light'), local('AveriaSansLibre-Light'), url(http://fonts.gstatic.com/s/averiasanslibre/v4/_9-jTfQjaBsWAF_yp5z-V_koENfi5euK3Pq4bmjrPH33rGVtsTkPsbDajuO5ueQw.woff2) format('woff2');unicode-range:U+0000-00FF, U+0131, U+0152-0153, U+02C6, U+02DA, U+02DC, U+2000-206F, U+2074, U+20AC, U+2212, U+2215, U+E0FF, U+EFFD, U+F000;}
@font-face{font-family:'Averia Sans Libre';font-style:normal;font-weight:400;src:local('Averia Sans Libre Regular'), local('AveriaSansLibre-Regular'), url(http://fonts.gstatic.com/s/averiasanslibre/v4/yRJpjT39KxACO9F31mj_Lg_aUQhQc-G_aklsCon-jQY.woff2) format('woff2');}
@font-face{font-family:'Averia Sans Libre';font-style:normal;font-weight:400;src:local('Averia Sans Libre Regular'), local('AveriaSansLibre-Regular'), url(http://fonts.gstatic.com/s/averiasanslibre/v4/yRJpjT39KxACO9F31mj_LhCOgf-7aQX9fZ-hXCrVrYo.woff2) format('woff2');unicode-range:U+0000-00FF, U+0131, U+0152-0153, U+02C6, U+02DA, U+02DC, U+2000-206F, U+2074, U+20AC, U+2212, U+2215, U+E0FF, U+EFFD, U+F000;}
@font-face{font-family:'Averia Sans Libre';font-style:normal;font-weight:700;src:local('Averia Sans Libre Bold'), local('AveriaSansLibre-Bold'), url(http://fonts.gstatic.com/s/averiasanslibre/v4/_9-jTfQjaBsWAF_yp5z-V0J3cPP3VWuuE8k_Cc188yQ.woff2) format('woff2');}
@font-face{font-family:'Averia Sans Libre';font-style:normal;font-weight:700;src:local('Averia Sans Libre Bold'), local('AveriaSansLibre-Bold'), url(http://fonts.gstatic.com/s/averiasanslibre/v4/_9-jTfQjaBsWAF_yp5z-V8pHOr3R2x3hfHkOMkOS3eH3rGVtsTkPsbDajuO5ueQw.woff2) format('woff2');unicode-range:U+0000-00FF, U+0131, U+0152-0153, U+02C6, U+02DA, U+02DC, U+2000-206F, U+2074, U+20AC, U+2212, U+2215, U+E0FF, U+EFFD, U+F000;}
@font-face{font-family:'Averia Sans Libre';font-style:italic;font-weight:300;src:local('Averia Sans Libre Light Italic'), local('AveriaSansLibre-LightItalic'), url(http://fonts.gstatic.com/s/averiasanslibre/v4/o7BEIK-fG3Ykc5Rzteh88UxVhMOIGwO6Rm52_FRVSdv3rGVtsTkPsbDajuO5ueQw.woff2) format('woff2');}
@font-face{font-family:'Averia Sans Libre';font-style:italic;font-weight:300;src:local('Averia Sans Libre Light Italic'), local('AveriaSansLibre-LightItalic'), url(http://fonts.gstatic.com/s/averiasanslibre/v4/o7BEIK-fG3Ykc5Rzteh88ZbIugc8LufP8miEb02o61br7w4p9aSvGirXi6XmeXNA.woff2) format('woff2');unicode-range:U+0000-00FF, U+0131, U+0152-0153, U+02C6, U+02DA, U+02DC, U+2000-206F, U+2074, U+20AC, U+2212, U+2215, U+E0FF, U+EFFD, U+F000;}
@font-face{font-family:'Averia Sans Libre';font-style:italic;font-weight:400;src:local('Averia Sans Libre Italic'), local('AveriaSansLibre-Italic'), url(http://fonts.gstatic.com/s/averiasanslibre/v4/COEzR_NPBSUOl3pFwPbPoMCKgybYoeSbPL9GUfZ5oCA.woff2) format('woff2');}
@font-face{font-family:'Averia Sans Libre';font-style:italic;font-weight:400;src:local('Averia Sans Libre Italic'), local('AveriaSansLibre-Italic'), url(http://fonts.gstatic.com/s/averiasanslibre/v4/COEzR_NPBSUOl3pFwPbPoGNnJO4MW90OISdcxxyk-Nk.woff2) format('woff2');unicode-range:U+0000-00FF, U+0131, U+0152-0153, U+02C6, U+02DA, U+02DC, U+2000-206F, U+2074, U+20AC, U+2212, U+2215, U+E0FF, U+EFFD, U+F000;}
@font-face{font-family:'Averia Sans Libre';font-style:italic;font-weight:700;src:local('Averia Sans Libre Bold Italic'), local('AveriaSansLibre-BoldItalic'), url(http://fonts.gstatic.com/s/averiasanslibre/v4/o7BEIK-fG3Ykc5Rzteh88bPfFCtUty54p_5YsoBApOb3rGVtsTkPsbDajuO5ueQw.woff2) format('woff2');}
@font-face{font-family:'Averia Sans Libre';font-style:italic;font-weight:700;src:local('Averia Sans Libre Bold Italic'), local('AveriaSansLibre-BoldItalic'), url(http://fonts.gstatic.com/s/averiasanslibre/v4/o7BEIK-fG3Ykc5Rzteh88dEXTlIQ3TpfLdEAyfwQjoTr7w4p9aSvGirXi6XmeXNA.woff2) format('woff2');unicode-range:U+0000-00FF, U+0131, U+0152-0153, U+02C6, U+02DA, U+02DC, U+2000-206F, U+2074, U+20AC, U+2212, U+2215, U+E0FF, U+EFFD, U+F000;}
@font-face{font-family:'Belgrano';font-style:normal;font-weight:400;src:local('Belgrano'), local('Belgrano-Regular'), url(http://fonts.gstatic.com/s/belgrano/v6/dWuBwiYWQRmoVIeQtckYE-vvDin1pK8aKteLpeZ5c0A.woff2) format('woff2');}
@font-face{font-family:'Belgrano';font-style:normal;font-weight:400;src:local('Belgrano'), local('Belgrano-Regular'), url(http://fonts.gstatic.com/s/belgrano/v6/GRNc1JaQ0xFKocBu6SI7lnYhjbSpvc47ee6xR_80Hnw.woff2) format('woff2');unicode-range:U+0000-00FF, U+0131, U+0152-0153, U+02C6, U+02DA, U+02DC, U+2000-206F, U+2074, U+20AC, U+2212, U+2215, U+E0FF, U+EFFD, U+F000;}
@font-face{font-family:'Belleza';font-style:normal;font-weight:400;src:local('Belleza'), local('Belleza-Regular'), url(http://fonts.gstatic.com/s/belleza/v4/SknodUDx393EPLQTiDXEcKCWcynf_cDxXwCLxiixG1c.woff2) format('woff2');}
@font-face{font-family:'Belleza';font-style:normal;font-weight:400;src:local('Belleza'), local('Belleza-Regular'), url(http://fonts.gstatic.com/s/belleza/v4/tE5ZBYKbZUSjF3Y3-bviJFKPGs1ZzpMvnHX-7fPOuAc.woff2) format('woff2');unicode-range:U+0100-024F, U+1E00-1EFF, U+20A0-20AB, U+20AD-20CF, U+2C60-2C7F, U+A720-A7FF;}
@font-face{font-family:'Belleza';font-style:normal;font-weight:400;src:local('Belleza'), local('Belleza-Regular'), url(http://fonts.gstatic.com/s/belleza/v4/xEPmIBkiiqzU5bI7YoAucALUuEpTyoUstqEm5AMlJo4.woff2) format('woff2');unicode-range:U+0000-00FF, U+0131, U+0152-0153, U+02C6, U+02DA, U+02DC, U+2000-206F, U+2074, U+20AC, U+2212, U+2215, U+E0FF, U+EFFD, U+F000;}
@font-face{font-family:'Codystar';font-style:normal;font-weight:400;src:local('Codystar'), url(http://fonts.gstatic.com/s/codystar/v4/FMXbVwVRZIkl3vMxJBaWIevvDin1pK8aKteLpeZ5c0A.woff2) format('woff2');}
@font-face{font-family:'Codystar';font-style:normal;font-weight:400;src:local('Codystar'), url(http://fonts.gstatic.com/s/codystar/v4/YAU6iOg_5olnitSr-UvZGhkAz4rYn47Zy2rvigWQf6w.woff2) format('woff2');unicode-range:U+0100-024F, U+1E00-1EFF, U+20A0-20AB, U+20AD-20CF, U+2C60-2C7F, U+A720-A7FF;}
@font-face{font-family:'Codystar';font-style:normal;font-weight:400;src:local('Codystar'), url(http://fonts.gstatic.com/s/codystar/v4/vO78uQGcYk_rDbnNA1ruZHYhjbSpvc47ee6xR_80Hnw.woff2) format('woff2');unicode-range:U+0000-00FF, U+0131, U+0152-0153, U+02C6, U+02DA, U+02DC, U+2000-206F, U+2074, U+20AC, U+2212, U+2215, U+E0FF, U+EFFD, U+F000;}
@font-face{font-family:'Concert One';font-style:normal;font-weight:400;src:local('Concert One'), local('ConcertOne-Regular'), url(http://fonts.gstatic.com/s/concertone/v7/N5IWCIGhUNdPZn_efTxKN5Bw1xU1rKptJj_0jans920.woff2) format('woff2');}
@font-face{font-family:'Concert One';font-style:normal;font-weight:400;src:local('Concert One'), local('ConcertOne-Regular'), url(http://fonts.gstatic.com/s/concertone/v7/eNLG875uBc3mU2X9z56PW6E8kM4xWR1_1bYURRojRGc.woff2) format('woff2');unicode-range:U+0100-024F, U+1E00-1EFF, U+20A0-20AB, U+20AD-20CF, U+2C60-2C7F, U+A720-A7FF;}
@font-face{font-family:'Concert One';font-style:normal;font-weight:400;src:local('Concert One'), local('ConcertOne-Regular'), url(http://fonts.gstatic.com/s/concertone/v7/eNLG875uBc3mU2X9z56PW4gp9Q8gbYrhqGlRav_IXfk.woff2) format('woff2');unicode-range:U+0000-00FF, U+0131, U+0152-0153, U+02C6, U+02DA, U+02DC, U+2000-206F, U+2074, U+20AC, U+2212, U+2215, U+E0FF, U+EFFD, U+F000;}
@font-face{font-family:'Dosis';font-style:normal;font-weight:400;src:local('Dosis Regular'), local('Dosis-Regular'), url(http://fonts.gstatic.com/s/dosis/v4/MPprbfOI7dT--4otxNtsnQ.woff2) format('woff2');}
@font-face{font-family:'Dosis';font-style:normal;font-weight:400;src:local('Dosis Regular'), local('Dosis-Regular'), url(http://fonts.gstatic.com/s/dosis/v4/3isE9muMMOq1K7TQ7HkKvIDGDUGfDkXyfkzVDelzfFk.woff2) format('woff2');unicode-range:U+0100-024F, U+1E00-1EFF, U+20A0-20AB, U+20AD-20CF, U+2C60-2C7F, U+A720-A7FF;}
@font-face{font-family:'Dosis';font-style:normal;font-weight:400;src:local('Dosis Regular'), local('Dosis-Regular'), url(http://fonts.gstatic.com/s/dosis/v4/oaBFj7Fz9Y9_eW3k9Jd9X6CWcynf_cDxXwCLxiixG1c.woff2) format('woff2');unicode-range:U+0000-00FF, U+0131, U+0152-0153, U+02C6, U+02DA, U+02DC, U+2000-206F, U+2074, U+20AC, U+2212, U+2215, U+E0FF, U+EFFD, U+F000;}
@font-face{font-family:'Duru Sans';font-style:normal;font-weight:400;src:local('Duru Sans'), local('DuruSans-Regular'), url(http://fonts.gstatic.com/s/durusans/v8/i0GBsUVLSophumkxpeUQ8gLUuEpTyoUstqEm5AMlJo4.woff2) format('woff2');}
@font-face{font-family:'Duru Sans';font-style:normal;font-weight:400;src:local('Duru Sans'), local('DuruSans-Regular'), url(http://fonts.gstatic.com/s/durusans/v8/IbQjRlkfZKyDj_oEiizaoYX0hVgzZQUfRDuZrPvH3D8.woff2) format('woff2');unicode-range:U+0100-024F, U+1E00-1EFF, U+20A0-20AB, U+20AD-20CF, U+2C60-2C7F, U+A720-A7FF;}
@font-face{font-family:'Duru Sans';font-style:normal;font-weight:400;src:local('Duru Sans'), local('DuruSans-Regular'), url(http://fonts.gstatic.com/s/durusans/v8/0rnIdjSQWlqFS5KpKzVfzpBw1xU1rKptJj_0jans920.woff2) format('woff2');unicode-range:U+0000-00FF, U+0131, U+0152-0153, U+02C6, U+02DA, U+02DC, U+2000-206F, U+2074, U+20AC, U+2212, U+2215, U+E0FF, U+EFFD, U+F000;}
@font-face{font-family:'Economica';font-style:normal;font-weight:400;src:local('Economica'), local('Economica-Regular'), url(http://fonts.gstatic.com/s/economica/v4/moxe3LED6tpJEJY6zBmQ1gLUuEpTyoUstqEm5AMlJo4.woff2) format('woff2');}
@font-face{font-family:'Economica';font-style:normal;font-weight:400;src:local('Economica'), local('Economica-Regular'), url(http://fonts.gstatic.com/s/economica/v4/ivOlup5oBnODGd64nVDAFIX0hVgzZQUfRDuZrPvH3D8.woff2) format('woff2');unicode-range:U+0100-024F, U+1E00-1EFF, U+20A0-20AB, U+20AD-20CF, U+2C60-2C7F, U+A720-A7FF;}
@font-face{font-family:'Economica';font-style:normal;font-weight:400;src:local('Economica'), local('Economica-Regular'), url(http://fonts.gstatic.com/s/economica/v4/jObgDQiPUtmACAaaK3pMG5Bw1xU1rKptJj_0jans920.woff2) format('woff2');unicode-range:U+0000-00FF, U+0131, U+0152-0153, U+02C6, U+02DA, U+02DC, U+2000-206F, U+2074, U+20AC, U+2212, U+2215, U+E0FF, U+EFFD, U+F000;}
@font-face{font-family:'Open Sans';font-style:normal;font-weight:400;src:local('Open Sans'), local('OpenSans'), url(http://fonts.gstatic.com/s/opensans/v10/TCmDhmS1RRL7aqhqZW19hwLUuEpTyoUstqEm5AMlJo4.woff2) format('woff2');}
@font-face{font-family:'Open Sans';font-style:normal;font-weight:400;src:local('Open Sans'), local('OpenSans'), url(http://fonts.gstatic.com/s/opensans/v10/K88pR3goAWT7BTt32Z01m5Bw1xU1rKptJj_0jans920.woff2) format('woff2');unicode-range:U+0460-052F, U+20B4, U+2DE0-2DFF, U+A640-A69F;}
@font-face{font-family:'Open Sans';font-style:normal;font-weight:400;src:local('Open Sans'), local('OpenSans'), url(http://fonts.gstatic.com/s/opensans/v10/RjgO7rYTmqiVp7vzi-Q5UZBw1xU1rKptJj_0jans920.woff2) format('woff2');unicode-range:U+0400-045F, U+0490-0491, U+04B0-04B1, U+2116;}
@font-face{font-family:'Open Sans';font-style:normal;font-weight:400;src:local('Open Sans'), local('OpenSans'), url(http://fonts.gstatic.com/s/opensans/v10/ttwNtsRpgsxVmgGGmiUOEpBw1xU1rKptJj_0jans920.woff2) format('woff2');unicode-range:U+02BC, U+0900-097F, U+1CD0-1CF6, U+1CF8-1CF9, U+200B-200D, U+20A8, U+20B9, U+25CC, U+A830-A839, U+A8E0-A8FB;}
@font-face{font-family:'Open Sans';font-style:normal;font-weight:400;src:local('Open Sans'), local('OpenSans'), url(http://fonts.gstatic.com/s/opensans/v10/LWCjsQkB6EMdfHrEVqA1KZBw1xU1rKptJj_0jans920.woff2) format('woff2');unicode-range:U+1F00-1FFF;}
@font-face{font-family:'Open Sans';font-style:normal;font-weight:400;src:local('Open Sans'), local('OpenSans'), url(http://fonts.gstatic.com/s/opensans/v10/xozscpT2726on7jbcb_pApBw1xU1rKptJj_0jans920.woff2) format('woff2');unicode-range:U+0370-03FF;}
@font-face{font-family:'Open Sans';font-style:normal;font-weight:400;src:local('Open Sans'), local('OpenSans'), url(http://fonts.gstatic.com/s/opensans/v10/59ZRklaO5bWGqF5A9baEEZBw1xU1rKptJj_0jans920.woff2) format('woff2');unicode-range:U+0102-0103, U+1EA0-1EF1, U+20AB;}
@font-face{font-family:'Open Sans';font-style:normal;font-weight:400;src:local('Open Sans'), local('OpenSans'), url(http://fonts.gstatic.com/s/opensans/v10/u-WUoqrET9fUeobQW7jkRZBw1xU1rKptJj_0jans920.woff2) format('woff2');unicode-range:U+0100-024F, U+1E00-1EFF, U+20A0-20AB, U+20AD-20CF, U+2C60-2C7F, U+A720-A7FF;}
@font-face{font-family:'Open Sans';font-style:normal;font-weight:400;src:local('Open Sans'), local('OpenSans'), url(http://fonts.gstatic.com/s/opensans/v10/cJZKeOuBrn4kERxqtaUH3ZBw1xU1rKptJj_0jans920.woff2) format('woff2');unicode-range:U+0000-00FF, U+0131, U+0152-0153, U+02C6, U+02DA, U+02DC, U+2000-206F, U+2074, U+20AC, U+2212, U+2215, U+E0FF, U+EFFD, U+F000;}
@font-face{font-family:'Oswald';font-style:normal;font-weight:400;src:local('Oswald Regular'), local('Oswald-Regular'), url(http://fonts.gstatic.com/s/oswald/v10/-sNwA3uCf2jBgZqkcV7dY_esZW2xOQ-xsNqO47m55DA.woff2) format('woff2');}
@font-face{font-family:'Oswald';font-style:normal;font-weight:400;src:local('Oswald Regular'), local('Oswald-Regular'), url(http://fonts.gstatic.com/s/oswald/v10/Qw6_9HvXRQGg5mMbFR3Phn-_kf6ByYO6CLYdB4HQE-Y.woff2) format('woff2');unicode-range:U+0100-024F, U+1E00-1EFF, U+20A0-20AB, U+20AD-20CF, U+2C60-2C7F, U+A720-A7FF;}
@font-face{font-family:'Oswald';font-style:normal;font-weight:400;src:local('Oswald Regular'), local('Oswald-Regular'), url(http://fonts.gstatic.com/s/oswald/v10/_P8jt3Y65hJ9c4AzRE0V1OvvDin1pK8aKteLpeZ5c0A.woff2) format('woff2');unicode-range:U+0000-00FF, U+0131, U+0152-0153, U+02C6, U+02DA, U+02DC, U+2000-206F, U+2074, U+20AC, U+2212, U+2215, U+E0FF, U+EFFD, U+F000;}
body{color:#000;min-width:345px;}
#layout,
#menu,
.menu-link{-webkit-transition:all 0.2s ease-out;-moz-transition:all 0.2s ease-out;-ms-transition:all 0.2s ease-out;-o-transition:all 0.2s ease-out;transition:all 0.2s ease-out;}
#layout{padding-left:200px;left:0;}
.content{margin:0 auto;padding:0 2em;max-width:1350px;margin-bottom:50px;line-height:1.6em;}
.header{margin:0;color:#333;text-align:center;padding:2.5em 2em 0;border-bottom:1px solid #eee;}
.header h1{margin:0.2em 0;font-weight:300;font:4em 'Averia Sans Libre', 'Helvetica Neue', Helvetica, Arial, sans-serif;}
.header h2{font-weight:300;color:#ccc;padding:0;margin-top:0;}
#menu{margin-left:-200px;width:200px;position:fixed;top:0;left:200px;bottom:0;z-index:1;background:#191818;overflow-y:auto;-webkit-overflow-scroll:touch;}
#menu li a{color:#999;border:none;padding:0.6em 0 0.6em 0.6em;}
#menu .pure-menu,
#menu .pure-menu ul{border:none;background:transparent;}
#menu .pure-menu ul,
#menu .pure-menu .menu-item-divided{}
#menu .pure-menu li a:hover,
#menu .pure-menu li a:focus{background:#ffffff;color:#000;}
#menu .pure-menu-selected,
#menu .pure-menu-heading{padding-left:5px;border-bottom:1px solid #333;}
#menu div:not(:first-of-type) .pure-menu-selected,
#menu div:not(:first-of-type) .pure-menu-heading{border-top:1px solid #333;}
#menu div:first-of-type .pure-menu-selected:first-of-type,
#menu div:first-of-type .pure-menu-heading:first-of-type{margin-top:5px;}
#menu div:last-of-type li:last-of-type{margin-bottom:25px;}
#menu .pure-menu-selected a{color:#fff;}
#menu .pure-menu-heading{font:110% 'Averia Sans Libre', 'Helvetica Neue', Helvetica, Arial, sans-serif;color:#ffffff;padding:10px 10px;margin:0;}
.menu-link{display:none;top:0;left:200px;background:#000;font-size:10px;z-index:10;width:2em;height:auto;padding:2.2em 1.6em;}
.menu-link:hover,
.menu-link:focus{background:#000;}
.menu-link span{position:relative;display:block;}
.menu-link span,
.menu-link span:before,
.menu-link span:after{background-color:#fff;width:100%;height:0.2em;}
.menu-link span:before,
.menu-link span:after{position:absolute;margin-top:-0.6em;content:" ";}
.menu-link span:after{margin-top:0.6em;}
a.anchor, a.anchor:hover, a.anchor:active, a.anchor:focus{display:block;margin-bottom:10px;text-decoration:none;border:0 none;outline:0;cursor:default;}
pre{white-space:pre;word-wrap:normal !important;}
ul, ol{margin-left:1%;padding-left:1%;}
.code{display:block;white-space:pre;overflow:auto;width:95%;margin:1em auto;padding:1%;background-color:#0f0101;color:#F1F1F1;-moz-border-radius:8px;-o-border-radius:8px;-ms-border-radius:8px;-khtml-border-radius:8px;border-radius:8px;font-family:Menlo, Monaco, "Courier New", monospace;font-size:1em;border:1px solid #888;}
.inline{display:inline-block;white-space:pre;word-wrap:normal;overflow:auto;margin:0;}
.xml{color:#C9C9C9;}
span.keyword{color:#5B93DA;}
span.annotation{color:#bdb76b;}
span.numeric_literal{color:#008dff;}
span.final,
span.constant{color:#e28964;font-style:italic;}
span.string_literal,
span.command_line_argument_switch{color:#5BA382;}
span.this_value{color:#CF0808;}
span.element{color:#89bdff;font-size:0.9em;}
span.attribute_name,
span.comment,
span.command_line_argument_placeholder{color:#9c9c9c;font-style:italic;font-size:0.9em;}
span.comment a{color:#6391c3;text-decoration:none;}
span.comment.bold{color:gray;}
span.javadoc_param_name{color:#c5c5c5;}
span.javadoc_param_annotation{color:#9c9c9c;text-decoration:underline;}
span.element_value{font-size:1.15em;color:#E2642F;}
span.attribute_value{color:blue;}
.sub_title{margin-top:3em;font-weight:bold;}
@media (max-width:767px){html{font-size:75%;}
.header{}
.header h1{font-size:2.5em;}
.header h2{font-size:1.25em;}
#layout{position:relative;padding-left:0;}
#layout.active{position:relative;left:200px;}
#layout.active #menu{left:200px;width:200px;}
#menu{left:0;}
.menu-link{position:fixed;left:0;display:block;}
#layout.active .menu-link{left:200px;}
a.anchor, a.anchor:hover, a.anchor:active, a.anchor:focus{margin-bottom:35px;}
ul, ol{margin-left:2%;padding-left:2%;}
.content{padding:0 1.5%}
.code{padding:1%;font-size:0.65em;}
}
@media (max-width:568px){ul, ol{margin-left:4%;padding-left:4%;}
.code{padding:2%;}
}</style>
</head>
<body>
<div id=layout>
<a href="#menu" id=menuLink class=menu-link><span></span></a>
<div id=menu>
<div class="pure-menu pure-menu-open">
<span class=pure-menu-heading>What?</span>
<ul>
<li><a href="#what-is-mockserver">What is MockServer</a></li>
<li><a href="#why-use-mockserver">Why use MockServer</a></li>
</ul>
</div>
<div class="pure-menu pure-menu-open">
<span class=pure-menu-heading>How?</span>
<ul>
<li><a href="#getting-started">Getting Started</a></li>
<li><a href="#starting-mockserver">Starting MockServer</a></li>
<li><a href="#create-expectations">Creating Expectations</a></li>
<li><a href="#verify-behaviour">Verifying Behaviour</a></li>
<li><a href="#analysing-behaviour">Analysing Behaviour</a></li>
<li><a href="#ensuring-tests-can-run-in-parallel">Running Tests In Parallel</a></li>
<li><a href="#clear-and-reset">Clear & Reset</a></li>
<li><a href="#debugging-issues">Debugging Issues</a></li>
<li><a href="#requirements">Requirements</a></li>
</ul>
</div>
<div class="pure-menu pure-menu-open">
<span class=pure-menu-heading>Where?</span>
<ul>
<li><a href="#downloads">Downloads</a></li>
<li><a href="#github">GitHub</a></li>
<li><a href="#maven-central">Maven Central</a></li>
<li><a href="#ruby-gems">Ruby Gems</a></li>
<li><a href="#npm-modules">npm</a></li>
<li><a href="#vertx-registry">Vert.X Registry</a></li>
<li><a href="#docker-index">Docker</a></li>
<li><a href="#continuous-integration">Continuous Integration</a></li>
<li><a href="#backlog">Backlog</a></li>
</ul>
</div>
<div class="pure-menu pure-menu-open">
<ul>
<li class=pure-menu-heading><a href="#site-map">Site Map</a></li>
</ul>
</div>
</div>
<div id=main>
<div class=header>
<h1>MockServer</h1>
<h2>Easy mocking of any system you integrate with via HTTP or HTTPS</h2>
</div>
<div class=content itemscope itemtype="http://schema.org/Article">
<a href="https://github.com/jamesdbloom/mockserver"><img style="position: absolute; top: 0; right: 0; border: 0;" width=149 height=149 src="images/forkme_right_red.png" alt="Fork us on GitHub"></a>
<a name=what-is-mockserver class=anchor href="#what-is-mockserver">&nbsp;</a>
<div style="float: right; overflow: hidden;">
<a href="https://drone.io/github.com/jamesdbloom/mockserver"><img width=80 height=18 src="https://drone.io/github.com/jamesdbloom/mockserver/status.png" alt="Drone.io Build Status"></a>
</div>
<h2>What is MockServer</h2>
<p>MockServer is for mocking of any system you integrate with via HTTP or HTTPS (i.e. services, web sites, etc).</p>
<p>MockServer can:</p>
<ul>
<li><strong>return a "mock" response</strong> when a request matches an expectation (<a href="#mocking">see more below</a>)</li>
<li><strong>forward a request</strong> when the request matches an expectation (i.e. ack as a selective proxy) (<a href="#mocking">see more below</a>)</li>
<li><strong>execute a callback</strong> (in Java) when a request matches an expectation, allowing the response to be created dynamically (<a href="#mocking">see more below</a>)</li>
<li><strong>verify requests</strong> have been sent (i.e. in a test assertion) (<a href="#verify-behaviour">see more below</a>)</li>
<li><strong>record requests and responses</strong> to analyse how a system behaves (<a href="#proxying">see more below</a>)</li>
</ul>
<p>MockServer Clients:</p>
<p>There are currently clients written in Java, JavaScript and Ruby (<a href="#clients">see more below</a>) although any language that can send JSON via HTTP can easily use MockServer API.</p>
<ul>
<li><a href="#clients">Java</a></li>
<li><a href="#clients">JavaScript</a> (browser API & Node.js)</li>
<li><a href="https://github.com/jamesdbloom/mockserver/blob/master/mockserver-client-ruby/README.md">Ruby</a></li>
</ul>
<a name=mocking class=anchor href="#mocking">&nbsp;</a>
<h3>Mocking</h3>
<p>To mock an HTTP / HTTPS interaction an expectation is setup specifying how a request should be matched and what action MockServer should take with when the request has been matched.</p>
<p>When a request is matched there are three actions that can be defined as follows:</p>
<ul>
<li><strong>respond</strong> - return a "mock" response</li>
<li><strong>forward</strong> - forward the request</li>
<li><strong>callback</strong> - execute a callback</li>
</ul>
<p>For example to create an expectation using <strong>Java</strong> then has a respond action:</p>
<pre><code class=code><span class=keyword>new</span> MockServerClient(<span class=string_literal>"localhost"</span>, <span class=numeric_literal>9999</span>)
        .when(
                request()
                        .withMethod(<span class=string_literal>"POST"</span>)
                        .withPath(<span class=string_literal>"/login"</span>)
                        .withQueryStringParameters(
                                <span class=keyword>new</span> Parameter(<span class=string_literal>"returnUrl"</span>, <span class=string_literal>"/account"</span>)
                        )
                        .withCookies(
                                <span class=keyword>new</span> Cookie(<span class=string_literal>"sessionId"</span>, <span class=string_literal>"2By8LOhBmaW5nZXJwcmludCIlMDAzMW"</span>)
                        )
                        .withBody(<span class=string_literal>"{username: 'foo', password: 'bar'}"</span>),
                Times.exactly(<span class=numeric_literal>1</span>)
        )
        .respond(
                response()
                        .withStatusCode(<span class=numeric_literal>401</span>)
                        .withHeaders(
                                <span class=keyword>new</span> Header(<span class=string_literal>"Content-Type"</span>, <span class=string_literal>"application/json; charset=utf-8"</span>),
                                <span class=keyword>new</span> Header(<span class=string_literal>"Cache-Control"</span>, <span class=string_literal>"public, max-age=86400"</span>)
                        )
                        .withBody(<span class=string_literal>"{ message: 'incorrect username and password combination' }"</span>)
                        .withDelay(<span class=keyword>new</span> Delay(TimeUnit.<span class=constant>SECONDS</span>, <span class=numeric_literal>1</span>))
        );</code></pre>
<p style="margin-top: 2em;">Or to create an expectation using <strong>JavaScript</strong>:</p>
<pre><code class=code>mockServerClient(<span class=string_literal>"http://localhost:9999"</span>).mockAnyResponse({
    <span class=string_literal>"httpRequest"</span>: {
        <span class=string_literal>"method"</span>: <span class=string_literal>"POST"</span>,
        <span class=string_literal>"path"</span>: <span class=string_literal>"/login"</span>,
        <span class=string_literal>"queryStringParameters"</span>: [
            {
                <span class=string_literal>"name"</span>: <span class=string_literal>"returnUrl"</span>,
                <span class=string_literal>"values"</span>: [<span class=string_literal>"/account"</span>]
            }
        ],
        <span class=string_literal>"cookies"</span>: [
            {
                <span class=string_literal>"name"</span>: <span class=string_literal>"sessionId"</span>,
                <span class=string_literal>"values"</span>: [<span class=string_literal>"2By8LOhBmaW5nZXJwcmludCIlMDAzMW"</span>]
            }
        ],
        <span class=string_literal>"body"</span>: {
            <span class=string_literal>"type"</span>: <span class=string_literal>"JSON"</span>,
            <span class=string_literal>"value"</span>: JSON.stringify({ username: <span class=string_literal>"foo"</span>, password: <span class=string_literal>"bar"</span> })
        }
    },
    <span class=string_literal>"httpResponse"</span>: {
        <span class=string_literal>"statusCode"</span>: <span class=numeric_literal>401</span>,
        <span class=string_literal>"headers"</span>: [
            {
                <span class=string_literal>"name"</span>: <span class=string_literal>"Content-Type"</span>,
                <span class=string_literal>"values"</span>: [<span class=string_literal>"application/json; charset=utf-8"</span>]
            },
            {
                <span class=string_literal>"name"</span>: <span class=string_literal>"Cache-Control"</span>,
                <span class=string_literal>"values"</span>: [<span class=string_literal>"public, max-age=86400"</span>]
            }
        ],
        <span class=string_literal>"body"</span>: JSON.stringify({ message: <span class=string_literal>"incorrect username and password combination"</span> }),
        <span class=string_literal>"delay"</span>: {
            <span class=string_literal>"timeUnit"</span>: <span class=string_literal>"SECONDS"</span>,
            <span class=string_literal>"value"</span>: <span class=numeric_literal>1</span>
        }
    },
    <span class=string_literal>"times"</span>: {
        <span class=string_literal>"remainingTimes"</span>: <span class=numeric_literal>1</span>,
        <span class=string_literal>"unlimited"</span>: <span class=keyword>false</span>
    }
});
</code></pre>
<h3>Requests can be matched on:</h3>
<ul>
<li><strong>path</strong> - regex or plain text</li>
<li><strong>query string</strong> - regex or plain text</li>
<li><strong>headers</strong> - regex or plain text</li>
<li><strong>cookies</strong> - regex or plain text</li>
<li><strong>body</strong> - XPath, json, regex, plain text (exact match), or body parameters</li>
</ul>
<p>The body can be matched using plain text, a json expression, an XPath expression or a regular expression, see <a href="http://saxon.sourceforge.net/saxon6.5.3/expressions.html">XPath Expression Syntax</a> for supported XPath syntax.</p>
<p>All other matching can be done using plain text or a regular expression, see <a href="http://docs.oracle.com/javase/6/docs/api/java/util/regex/Pattern.html">Pattern (Java Platform SE 6)</a> for supported regular expression syntax.</p>
<p>For more details see the section below on <a href="#create-expectations">creating expectations</a>.</p>
<h3>Actions can be defined:</h3>
<p>When a request is matched there are three actions that can be defined as follows:</p>
<ul>
<li><strong>respond</strong> - return a "mock" response</li>
<li><strong>forward</strong> - forward the request</li>
<li><strong>callback</strong> - execute a callback</li>
</ul>
<h4><em>Respond Actions</em></h4>
<p>A response action defines a mock response. Each response can contain:</p>
<ul>
<li><strong>status code</strong></li>
<li><strong>body</strong></li>
<li><strong>headers</strong></li>
<li><strong>cookies</strong></li>
</ul>
<p>Responses can be further controlled using:</p>
<ul>
<li>a delay before the response is sent</li>
<li>the number of times the response is sent (including unlimited)</li>
</ul>
<p>For more details see the section below on <a href="#create-expectations">creating expectations</a>.</p>
<h4><em>Forward Actions</em></h4>
<p>A forward action defines how a request should be forwarded. Each forward can contain:</p>
<ul>
<li><strong>host</strong></li>
<li><strong>port</strong></li>
<li><strong>scheme</strong></li>
</ul>
<p>Only the host is mandatory as the port is default to 80 and the scheme is defaulted to HTTP.</p>
<p>For more details see the section below on <a href="#create-expectations">creating expectations</a>.</p>
<h4><em>Callback Actions</em></h4>
<p>A callback action defines a class that will be used to dynamically generate the response. Each callback contains:</p>
<ul>
<li><strong>callbackClass</strong></li>
</ul>
<p>The class must define a default constructor and implement <strong>org.mockserver.mock.action.ExpectationCallback</strong>.</p>
<p>For more details see the section below on <a href="#create-expectations">creating expectations</a>.</p>
<a name=proxying class=anchor href="#proxying">&nbsp;</a>
<h3>Proxying</h3>
<p>MockServer also provides an HTTP / HTTPS proxy that can be used to record requests / responses.</p>
<p>Once requests / responses have been recorded:</p>
<ul>
<li>They can be queried pragmatically to confirm what requests have been sent and what responses have been received.
<ul>
<li>This supports test assertions that confirm what requests the system-under-test has been sending during a test.</li>
</ul>
</li>
<li>They can be output in JSON format to log what request the system under has sent and what responses it received.
<ul>
<li>This is useful for analysing an existing system prior to writing automated tests.</li>
<li>This is also useful to simplify the creation of test setup code as the JSON output is in MockServer expectation format.</li>
</ul>
</li>
<li>They can be output in human readable Java code format that can be pasted directly into a test setup method.
<ul>
<li>This is useful to simplify the creation of expectations in test setup methods as the code can be easily pasted directly into a test setup method and then modified as appropriate for the needs of the test scenario.</li>
</ul>
</li>
</ul>
<p>For example to use the proxy to verify a request has been sent:</p>
<pre><code class=code><span class=keyword>new</span> ProxyClient(<span class=string_literal>"localhost"</span>, <span class=numeric_literal>9999</span>)
        .verify(
                request()
                        .withMethod(<span class=string_literal>"POST"</span>)
                        .withPath(<span class=string_literal>"/login"</span>)
                        .withBody(<span class=string_literal>"{username: 'foo', password: 'bar'}"</span>),
                VerificationTimes.exactly(<span class=numeric_literal>1</span>)
        );</code></pre>
<p>For example to use the proxy to print recorded requests and response to the log as JSON:</p>
<pre><code class=code><span class=keyword>new</span> ProxyClient(<span class=string_literal>"localhost"</span>, <span class=numeric_literal>9999</span>)
        .dumpToLogAsJSON(
                request()
                        .withPath(<span class=string_literal>"/login"</span>)
        );</code></pre>
<p>This would result in entries in the <strong>mockserver_request.log</strong> file of the following format:</p>
<pre><code class=code>2014-01-11 13:08:54,225 {
    <span class=string_literal>"httpRequest"</span>: {
        <span class=string_literal>"method"</span>: <span class=string_literal>"POST"</span>,
        <span class=string_literal>"path"</span>: <span class=string_literal>"/login"</span>,
        <span class=string_literal>"body"</span>: {
            <span class=string_literal>"type"</span>: <span class=string_literal>"STRING"</span>,
            <span class=string_literal>"value"</span>: <span class=string_literal>"{username: 'foo', password: 'bar'}"</span>,
        },
        <span class=string_literal>"cookies"</span>: [
            {
                <span class=string_literal>"name"</span>: <span class=string_literal>"sid"</span>,
                <span class=string_literal>"values"</span>: [ <span class=string_literal>"05F1A3D2F2143C49727"</span> ]
            }
        ],
        <span class=string_literal>"headers"</span>: [
            {
                <span class=string_literal>"name"</span>: <span class=string_literal>"Accept-Language"</span>,
                <span class=string_literal>"values"</span>: [ <span class=string_literal>"en-US,en;q=0.8,fa;q=0.6"</span> ]
            },
            {
                <span class=string_literal>"name"</span>: <span class=string_literal>"Cookie"</span>,
                <span class=string_literal>"values"</span>: [ <span class=string_literal>"sid=05F1A3D2F2143C49727"</span> ]
            },
            {
                <span class=string_literal>"name"</span>: <span class=string_literal>"Host"</span>,
                <span class=string_literal>"values"</span>: [ <span class=string_literal>"localhost:2021"</span> ]
            },
            {
                <span class=string_literal>"name"</span>: <span class=string_literal>"Content-Length"</span>,
                <span class=string_literal>"values"</span>: [ <span class=string_literal>"34"</span> ]
            },
            {
                <span class=string_literal>"name"</span>: <span class=string_literal>"Accept-Encoding"</span>,
                <span class=string_literal>"values"</span>: [ <span class=string_literal>"gzip,deflate,sdch"</span> ]
            },
            {
                <span class=string_literal>"name"</span>: <span class=string_literal>"User-Agent"</span>,
                <span class=string_literal>"values"</span>: [ <span class=string_literal>"Mozilla/5.0 (Macintosh; Intel Mac OS X 10_9_1) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/31.0.1650.63 Safari/537.36"</span> ]
            },
            {
                <span class=string_literal>"name"</span>: <span class=string_literal>"Accept"</span>,
                <span class=string_literal>"values"</span>: [ <span class=string_literal>"*/*"</span> ]
            },
            {
                <span class=string_literal>"name"</span>: <span class=string_literal>"Content-Type"</span>,
                <span class=string_literal>"values"</span>: [ <span class=string_literal>"text/plain"</span> ]
            }
        ]
    },
    <span class=string_literal>"httpResponse"</span>: {
        <span class=string_literal>"statusCode"</span>: <span class=numeric_literal>200</span>,
        <span class=string_literal>"body"</span>: <span class=string_literal>"{ message: 'success' }"</span>,
        <span class=string_literal>"headers"</span>: [
            {
                <span class=string_literal>"name"</span>: <span class=string_literal>"Content-Type"</span>,
                <span class=string_literal>"values"</span>: [ <span class=string_literal>"application/json; charset=utf-8"</span> ]
            },
            {
                <span class=string_literal>"name"</span>: <span class=string_literal>"Cache-Control"</span>,
                <span class=string_literal>"values"</span>: [ <span class=string_literal>"no-cache, no-store"</span> ]
            }
        ]
    },
    <span class=string_literal>"times"</span>: {
        <span class=string_literal>"remainingTimes"</span>: <span class=numeric_literal>1</span>,
        <span class=string_literal>"unlimited"</span>: <span class=keyword>false</span>
    }
}</code></pre>
<a name=versions class=anchor href="#versions">&nbsp;</a>
<h2>Versions</h2>
<p>MockServer is flexible and support numerous usage patterns.</p>
<p>The mock server can be run:</p>
<ul>
<li>via the mockserver-maven-plugin, for example, as part of a build cycle</li>
<li>programmatically via an API, for example, in an <span class=annotation>@Before</span> / <span class=annotation>@After</span> method</li>
<li>from the command line as a stand-alone process, for example, as part of a deployment process to a test environment</li>
<li>from a Grunt build using a Grunt plugin</li>
<li>from an Node.js code using an npm plugin</li>
</ul>
<p>MockServer is available as:</p>
<ul>
<li>a stand alone Netty web server that is fully self contained</li>
<li>a deployable WAR that runs on any JEE web server</li>
<li>a Vert.X module that runs on a Vert.X</li>
<li>a Grunt plugin (that has the embedded Netty server bundle with it)</li>
<li>an npm plugin (that has the embedded Netty server bundle with it)</li>
</ul>
<a name=clients class=anchor href="#clients">&nbsp;</a>
<h2>Clients</h2>
<p>MockServer has the following clients:</p>
<p><strong>Note:</strong> It is not necessary to use the provided clients because the protocol is very simple JSON/HTTP.</p>
<ul>
<li>Java
<ul>
<li><a href="#java-mockserver-client"><strong>org.mockserver.client.server.MockServerClient</strong></a> - supports:
<ul>
<li>creating expectations</li>
<li>clearing expectations (selectively)</li>
<li>resetting (clearing all expectations)</li>
<li>dumping all expectations to the log (for debugging)</li>
<li>verifying which requests have been received</li>
</ul>
</li>
<li><a href="#java-proxy-client"><strong>org.mockserver.client.proxy.ProxyClient</strong></a> - supports:
<ul>
<li>verifying which requests have been recorded</li>
<li>retrieving all recorded requests / responses as JSON or Expectation objects</li>
<li>outputting to the log all recorded requests / responses as Expectations in JSON format</li>
<li>outputting to the log all recorded requests / responses as Expectations in Java code format that can be pasted into test setup methods</li>
<li>clearing recorded requests / responses (selectively)</li>
<li>resetting (clearing all recorded requests / responses)</li>
</ul>
</li>
</ul>
</li>
<li>JavaScript (both browser API & Node.js module)
<ul>
<li><a href="#javascript-mockserver-client"><strong>mockServerClient</strong></a> - supports:
<ul>
<li>creating expectations</li>
<li>clearing expectations (selectively)</li>
<li>resetting (clearing all expectations)</li>
<li>dumping all expectations to the log (for debugging)</li>
<li>verifying which requests have been received</li>
</ul>
</li>
<li><a href="#javascript-proxy-client"><strong>proxyClient</strong></a> - supports:
<ul>
<li>verifying which requests have been recorded</li>
<li>retrieving all recorded requests / responses as JSON or Expectation objects</li>
<li>outputting to the log all recorded requests / responses as Expectations in JSON format</li>
<li>clearing recorded requests / responses (selectively)</li>
<li>resetting (clearing all recorded requests / responses)</li>
</ul>
</li>
</ul>
</li>
</ul>
<a name=java-mockserver-client class=anchor href="#java-mockserver-client">&nbsp;</a>
<p><strong>Java MockServer Client</strong></p>
<p>To simplest way to interact with MockServer from Java is to use <strong>org.mockserver.client.server.MockServerClient</strong> which provides the following API:</p>
<pre><code class=code><span class=keyword>public class</span> MockServerClient {

    <span class=comment>/**
     * Start the client communicating to a MockServer at the specified host and port
     * for example:
     *
     *   MockServerClient mockServerClient = <span class=keyword>new</span> MockServerClient(<span class=string_literal>"localhost"</span>, <span class=numeric_literal>8080</span>);
     *
     * <span class=javadoc_param_annotation>@param</span> <span class=javadoc_param_name>host</span> the host for MockServer to communicate with
     * <span class=javadoc_param_annotation>@param</span> <span class=javadoc_param_name>port</span> the port for MockServer to communicate with
     */</span>
    <span class=keyword>public</span> MockServerClient(String host, <span class=keyword>int</span> port);

    <span class=comment>/**
     * Start the client communicating to a MockServer at the specified host and port
     * and contextPath for example:
     *
     *   MockServerClient mockServerClient = <span class=keyword>new</span> MockServerClient(<span class=string_literal>"localhost"</span>, <span class=numeric_literal>8080</span>);
     *
     * <span class=javadoc_param_annotation>@param</span> <span class=javadoc_param_name>host</span> the host for MockServer to communicate with
     * <span class=javadoc_param_annotation>@param</span> <span class=javadoc_param_name>port</span> the port for MockServer to communicate with
     * <span class=javadoc_param_annotation>@param</span> <span class=javadoc_param_name>contextPath</span> the context path that MockServer war is deployed to
     */</span>
    <span class=keyword>public</span> MockServerClient(String host, <span class=keyword>int</span> port, String contextPath);

    <span class=comment>/**
     * Specify an unlimited expectation that will respond regardless of the number of matching http
     * for example:
     *
     *   <span class=this_value>mockServerClient</span>
     *           .when(
     *                   request()
     *                           .withPath(<span class=string_literal>"/some_path"</span>)
     *                           .withBody(<span class=string_literal>"some_request_body"</span>)
     *           )
     *           .respond(
     *                   response()
     *                           .withBody(<span class=string_literal>"some_response_body"</span>)
     *                           .withHeaders(
     *                                   <span class=keyword>new</span> Header(<span class=string_literal>"responseName"</span>, <span class=string_literal>"responseValue"</span>)
     *                           )
     *           );
     *
     * <span class=javadoc_param_annotation>@param</span> <span class=javadoc_param_name>httpRequest</span> the http request that must be matched for this expectation to respond
     * <span class=javadoc_param_annotation>@return</span> an Expectation object that can be used to specify the response
     */</span>
    <span class=keyword>public</span> ForwardChainExpectation when(HttpRequest httpRequest);

    <span class=comment>/**
     * Specify an limited expectation that will respond a specified number of times when the http is matched
     * for example:
     *
     *   <span class=this_value>mockServerClient</span>
     *           .when(
     *                   <span class=keyword>new</span> HttpRequest()
     *                           .withPath(<span class=string_literal>"/some_path"</span>)
     *                           .withBody(<span class=string_literal>"some_request_body"</span>),
     *                   Times.exactly(<span class=numeric_literal>5</span>)
     *           )
     *           .respond(
     *                   <span class=keyword>new</span> HttpResponse()
     *                           .withBody(<span class=string_literal>"some_response_body"</span>)
     *                           .withHeaders(
     *                                   <span class=keyword>new</span> Header(<span class=string_literal>"responseName"</span>, <span class=string_literal>"responseValue"</span>)
     *                           )
     *           );
     *
     * <span class=javadoc_param_annotation>@param</span> <span class=javadoc_param_name>httpRequest</span> the http request that must be matched for this expectation to respond
     * <span class=javadoc_param_annotation>@param</span> <span class=javadoc_param_name>times</span>       the number of times to respond when this http is matched
     * <span class=javadoc_param_annotation>@return</span> an Expectation object that can be used to specify the response
     */</span>
    <span class=keyword>public</span> ForwardChainExpectation when(HttpRequest httpRequest, Times times);

    <span class=comment>/**
     * Pretty-print the json for all expectations to the log.  They are printed into a dedicated log called mockserver_request.log
     */</span>
    <span class=keyword>public</span> MockServerClient dumpToLog();

    <span class=comment>/**
     * Pretty-print the json for all expectations that match the request to the log.  They are printed into a dedicated log called mockserver_request.log
     *
     * <span class=javadoc_param_annotation>@param</span> <span class=javadoc_param_name>httpRequest</span> the http request that is matched against when deciding what to log if null all requests are logged
     */</span>
    <span class=keyword>public</span> MockServerClient dumpToLog(HttpRequest httpRequest);

    <span class=comment>/**
     * Reset MockServer by clearing all expectations
     */</span>
    <span class=keyword>public</span> MockServerClient reset();

    <span class=comment>/**
     * Stop MockServer gracefully (only support for Netty and Vert.X versions, not supported for WAR version)
     */</span>
    <span class=keyword>public</span> MockServerClient stop();

    <span class=comment>/**
     * Clear all expectations that match the http
     *
     * <span class=javadoc_param_annotation>@param</span> <span class=javadoc_param_name>httpRequest</span> the http request that is matched against when deciding whether to clear each expectation if null all expectations are cleared
     */</span>
    <span class=keyword>public</span> MockServerClient clear(HttpRequest httpRequest);

    <span class=comment>/**
     * Verify a request has been sent for example:
     *
     *   <span class=this_value>mockServerClient</span>
     *           .verify(
     *                   request()
     *                           .withPath(<span class=string_literal>"/some_path"</span>)
     *                           .withBody(<span class=string_literal>"some_request_body"</span>)
     *           );
     *
     * <span class=javadoc_param_annotation>@param</span> <span class=javadoc_param_name>httpRequests</span> the http requests that must be matched for this verification to pass
     * <span class=javadoc_param_annotation>@throws</span> <span class=javadoc_param_name>AssertionError</span> if the request has not been found
     */</span>
    <span class=keyword>public</span> MockServerClient verify(HttpRequest... httpRequests); <span class=keyword>throws</span> AssertionError

    <span class=comment>/**
     * Verify a request has been sent for example:
     *
     *   <span class=this_value>mockServerClient</span>
     *           .verify(
     *                   request()
     *                           .withPath(<span class=string_literal>"/some_path"</span>)
     *                           .withBody(<span class=string_literal>"some_request_body"</span>),
     *                   VerificationTimes.exactly(<span class=numeric_literal>3</span>)
     *           );
     *
     * Times supports multiple static factory methods:
     *
     *   once()      - verify the request was only received once
     *   exactly(<span class=numeric_literal>n</span>)  - verify the request was only received exactly <span class=numeric_literal>n</span> times
     *   atLeast(<span class=numeric_literal>n</span>)  - verify the request was only received at least <span class=numeric_literal>n</span> times
     *
     * <span class=javadoc_param_annotation>@param</span> <span class=javadoc_param_name>httpRequest</span> the http request that must be matched for this verification to pass
     * <span class=javadoc_param_annotation>@param</span> <span class=javadoc_param_name>times</span>       the number of times this request must be matched
     * <span class=javadoc_param_annotation>@throws</span> <span class=javadoc_param_name>AssertionError</span> if the request has not been found
     */</span>
    <span class=keyword>public</span> MockServerClient verify(HttpRequest httpRequest, org.mockserver.verify.VerificationTimes times); <span class=keyword>throws</span> AssertionError

    <span class=comment>/**
     * Retrieve the recorded requests that match the httpRequest parameter as expectations, use null for the parameter to retrieve all requests
     *
     * <span class=javadoc_param_annotation>@param</span> <span class=javadoc_param_name>httpRequest</span> the http request that is matched against when deciding whether to return each expectation, use null to retrieve for all requests
     * <span class=javadoc_param_annotation>@return</span> an array of all expectations that have been recorded by the proxy
     */</span>
    <span class=keyword>public</span> Expectation[] retrieveAsExpectations(HttpRequest httpRequest);

    <span class=comment>/**
     * Retrieve the recorded requests that match the httpRequest parameter as a JSON array, use null for the parameter to retrieve all requests
     *
     * <span class=javadoc_param_annotation>@param</span> <span class=javadoc_param_name>httpRequest</span> the http request that is matched against when deciding whether to return each expectation, use null to retrieve for all requests
     * <span class=javadoc_param_annotation>@return</span> a JSON array of all expectations that have been recorded by the proxy
     */</span>
    <span class=keyword>public</span> String retrieveAsJSON(HttpRequest httpRequest);
}</code></pre>
<a name=java-proxy-client class=anchor href="#java-proxy-client">&nbsp;</a>
<p><strong>Java Proxy Client</strong></p>
<p>To simplest way to interact with proxy from Java is to use <strong>org.mockserver.client.proxy.ProxyClient</strong> which provides the following API:</p>
<pre><code class=code><span class=keyword>public class</span> ProxyClient {

    <span class=comment>/**
     * Start the client communicating to the proxy at the specified host and port
     * for example:
     *   ProxyClient mockServerClient = <span class=keyword>new</span> ProxyClient(<span class=string_literal>"localhost"</span>, <span class=numeric_literal>1080</span>);
     *
     * <span class=javadoc_param_annotation>@param</span> <span class=javadoc_param_name>host</span> the host for the proxy to communicate with
     * <span class=javadoc_param_annotation>@param</span> <span class=javadoc_param_name>port</span> the port for the proxy to communicate with
     */</span>
    <span class=keyword>public</span> ProxyClient(String host, <span class=keyword>int</span> port);

    <span class=comment>/**
     * Pretty-print the json for all requests / responses as Expectations to the log.
     * They are printed into a dedicated log called mockserver_request.log
     */</span>
    <span class=keyword>public</span> ProxyClient dumpToLogAsJSON();

    <span class=comment>/**
     * Pretty-print the json for matching requests and their responses as Expectations to the log.
     * They are printed into a dedicated log called mockserver_request.log
     *
     * <span class=javadoc_param_annotation>@param</span> <span class=javadoc_param_name>httpRequest</span> the http request that is matched against when deciding what to log if null all requests are logged
     */</span>
    <span class=keyword>public</span> ProxyClient dumpToLogAsJSON(HttpRequest httpRequest);

    <span class=comment>/**
     * Output Java code for creating all requests / responses as Expectations to the log.
     * They are printed into a dedicated log called mockserver_request.log
     */</span>
    <span class=keyword>public</span> ProxyClient dumpToLogAsJava();

    <span class=comment>/**
     * Output Java code for creating matching requests and their responses as Expectations to the log.
     * They are printed into a dedicated log called mockserver_request.log
     *
     * <span class=javadoc_param_annotation>@param</span> <span class=javadoc_param_name>httpRequest</span> the http request that is matched against when deciding what to log if null all requests are logged
     */</span>
    <span class=keyword>public</span> ProxyClient dumpToLogAsJava(HttpRequest httpRequest);

    <span class=comment>/**
     * Reset the proxy by clearing recorded requests
     */</span>
    <span class=keyword>public</span> ProxyClient reset();

    <span class=comment>/**
     * Stop the proxy gracefully (only support for Netty and Vert.X versions, not supported for WAR version)
     */</span>
    <span class=keyword>public</span> ProxyClient stop();

    <span class=comment>/**
     * Clear all recorded requests that match the httpRequest parameter
     *
     * <span class=javadoc_param_annotation>@param</span> <span class=javadoc_param_name>httpRequest</span> the http request that is matched against when deciding whether to clear recorded requests
     */</span>
    <span class=keyword>public</span> ProxyClient clear(HttpRequest httpRequest);

    <span class=comment>/**
     * Verify a request has been sent for example:
     *
     *   <span class=this_value>mockServerClient</span>
     *           .verify(
     *                   request()
     *                           .withPath(<span class=string_literal>"/some_path"</span>)
     *                           .withBody(<span class=string_literal>"some_request_body"</span>)
     *           );
     *
     * <span class=javadoc_param_annotation>@param</span> <span class=javadoc_param_name>httpRequest</span> the http request that must be matched for this verification to pass
     * @throws AssertionError if the request has not been found
     */</span>
    <span class=keyword>public</span> ProxyClient verify(HttpRequest httpRequest); <span class=keyword>throws</span> AssertionError

    <span class=comment>/**
     * Verify a request has been sent for example:
     *
     *   <span class=this_value>mockServerClient</span>
     *           .verify(
     *                   request()
     *                           .withPath(<span class=string_literal>"/some_path"</span>)
     *                           .withBody(<span class=string_literal>"some_request_body"</span>),
     *                   VerificationTimes.exactly(<span class=numeric_literal>3</span>)
     *           );
     *
     * Times supports multiple static factory methods:
     *
     *   once()      - verify the request was only received once
     *   exactly(<span class=numeric_literal>n</span>)  - verify the request was only received exactly <span class=numeric_literal>n</span> times
     *   atLeast(<span class=numeric_literal>n</span>)  - verify the request was only received at least <span class=numeric_literal>n</span> times
     *
     * <span class=javadoc_param_annotation>@param</span> <span class=javadoc_param_name>httpRequest</span> the http request that must be matched for this verification to pass
     * <span class=javadoc_param_annotation>@param</span> <span class=javadoc_param_name>times</span>       the number of times this request must be matched
     * @throws AssertionError if the request has not been found
     */</span>
    <span class=keyword>public</span> ProxyClient verify(HttpRequest httpRequest, Times times); <span class=keyword>throws</span> AssertionError

    <span class=comment>/**
     * Retrieve the recorded requests that match the httpRequest parameter as expectations, use null for the parameter to retrieve all requests
     *
     * <span class=javadoc_param_annotation>@param</span> <span class=javadoc_param_name>httpRequest</span> the http request that is matched against when deciding whether to return each expectation, use null for the parameter to retrieve for all requests
     * @return an array of all expectations that have been recorded by the proxy
     */</span>
    <span class=keyword>public</span> Expectation[] retrieveAsExpectations(HttpRequest httpRequest);

    <span class=comment>/**
     * Retrieve the recorded requests that match the httpRequest parameter as a JSON array, use null for the parameter to retrieve all requests
     *
     * <span class=javadoc_param_annotation>@param</span> <span class=javadoc_param_name>httpRequest</span> the http request that is matched against when deciding whether to return each expectation, use null for the parameter to retrieve for all requests
     * @return a JSON array of all expectations that have been recorded by the proxy
     */</span>
    <span class=keyword>public</span> String retrieveAsJSON(HttpRequest httpRequest);
}</code></pre>
<a name=javascript-mockserver-client class=anchor href="#javascript-mockserver-client">&nbsp;</a>
<p><strong>JavaScript MockServer Client</strong></p>
<p>To interact with MockServer from JavaScript it is possible to use either:</p>
<ul>
<li>a browser based API file <a href="https://rawgit.com/jamesdbloom/mockserver/master/mockserver-javascript-client/src/main/javascript/mockServerClient.js"><strong>mockServerClient.js</strong></a></li>
<li>a Node.js npm module <a href="https://www.npmjs.org/package/mockserver-client"><strong>mockserver-client</strong></a><br/><a href="https://www.npmjs.org/package/mockserver-client"><img width=408 height=81 src="https://nodei.co/npm/mockserver-client.png?downloads=true&downloadRank=true&stars=true" alt=mockserver-client-node /></a></li>
</ul>
<p>To include the browser based in an HTML page use one of the following script tag to load the file from <a href="http://www.maxcdn.com/">MaxCDN</a>:</p>
<pre><code class=code>&lt;<span class=annotation>script</span> <span class=keyword>type</span>=<span class=string_literal>"text/javascript"</span> <span class=keyword>src</span>=<span class=string_literal>"https://cdn.rawgit.com/jamesdbloom/mockserver/cd04edaf0ad132e3639af355d2ab4887f85e98ae/mockserver-client-javascript/src/main/javascript/mockServerClient.js"</span>&gt;&lt;/<span class=annotation>script</span>&gt;</code></pre>
<p>To use the Node.js module add the following code to your node project:</p>
<pre><code class=code><span class=keyword>var</span> mockServer = require(<span class=string_literal>'mockserver-client'</span>),
    mockServerClient = mockServer.mockServerClient;</code></pre>
<p>Both versions of <strong>mockServerClient</strong> provide the same API as follows:</p>
<pre><code class=code><span class=keyword>var</span> mockServerClient = function (mockServerUrl) {
    <span class=string_literal>"use strict"</span>;

    <span class=comment>/**
     * The default headers added to to the mocked response when using mockSimpleResponse(...)
     */</span>
    <span class=keyword>var</span> defaultResponseHeaders = [
            {<span class=string_literal>'name'</span>: <span class=string_literal>'Content-Type'</span>, <span class=string_literal>'values'</span>: [<span class=string_literal>'application/json; charset=utf-8'</span>]},
            {<span class=string_literal>'name'</span>: <span class=string_literal>'Cache-Control'</span>, <span class=string_literal>'values'</span>: [<span class=string_literal>'no-cache, no-store'</span>]}
    ],

    <span class=comment>/**
     * Setup an expectation in MockServer by specifying an expectation object
     * for example:
     *
     *   mockServerClient(<span class=string_literal>'localhost'</span>, <span class=numeric_literal>1080</span>).mockAnyResponse(
     *       {
     *           <span class=string_literal>'httpRequest'</span>: {
     *               <span class=string_literal>'path'</span>: <span class=string_literal>'/somePath'</span>,
     *               <span class=string_literal>'body'</span>: {
     *                   <span class=string_literal>'type'</span>: <span class=string_literal>'STRING'</span>,
     *                   <span class=string_literal>'value'</span>: <span class=string_literal>'someBody'</span>
     *               }
     *           },
     *           <span class=string_literal>'httpResponse'</span>: {
     *               <span class=string_literal>'statusCode'</span>: <span class=string_literal>200</span>,
     *               <span class=string_literal>'body'</span>: Base64.encode(JSON.stringify({ name: <span class=string_literal>'first_body'</span> })),
     *               <span class=string_literal>'delay'</span>: {
     *                   <span class=string_literal>'timeUnit'</span>: <span class=string_literal>'MILLISECONDS'</span>,
     *                   <span class=string_literal>'value'</span>: <span class=string_literal>250</span>
     *               }
     *           },
     *           <span class=string_literal>'times'</span>: {
     *               <span class=string_literal>'remainingTimes'</span>: <span class=string_literal>1</span>,
     *               <span class=string_literal>'unlimited'</span>: <span class=keyword>false</span>
     *           }
     *       }
     *   );
     *
     * <span class=javadoc_param_annotation>@param</span> <span class=javadoc_param_name>expectation</span> the expectation to setup in MockServer
     */</span>
    mockAnyResponse = function (expectation),

    <span class=comment>/**
     * Setup an expectation in MockServer without having to specify the full expectation object
     * for example:
     *
     *   mockServerClient(<span class=string_literal>'localhost'</span>, <span class=numeric_literal>1080</span>).mockSimpleResponse(<span class=string_literal>'/somePath'</span>, { <span class=string_literal>'name'</span>: <span class=string_literal>'value'</span> }, <span class=numeric_literal>203</span>);
     *
     * <span class=javadoc_param_annotation>@param</span> <span class=javadoc_param_name>path</span>         the path to match requests against
     * <span class=javadoc_param_annotation>@param</span> <span class=javadoc_param_name>responseBody</span> the response body to return if a request matches
     * <span class=javadoc_param_annotation>@param</span> <span class=javadoc_param_name>statusCode</span>   the response code to return if a request matches
     */</span>
    mockSimpleResponse = function (path, responseBody, statusCode),

    <span class=comment>/**
     * Override the default headers that are used to specify the response headers in mockSimpleResponse(...)
     * (note: if you use mockAnyResponse(...) the default headers are not used)
     * for example:
     *
     *   mockServerClient(<span class=string_literal>'localhost'</span>, <span class=numeric_literal>1080</span>).setDefaultHeaders([
     *       {<span class=string_literal>'name'</span>: <span class=string_literal>'Content-Type'</span>, <span class=string_literal>'values'</span>: [<span class=string_literal>'application/json; charset=utf-8'</span>]},
     *       {<span class=string_literal>'name'</span>: <span class=string_literal>'Cache-Control'</span>, <span class=string_literal>'values'</span>: [<span class=string_literal>'no-cache, no-store'</span>]}
     *   ])
     *
     * <span class=javadoc_param_annotation>@param</span> <span class=javadoc_param_name>headers</span> the path to match requests against
     */</span>
    setDefaultHeaders = function (headers),

    <span class=comment>/**
     * Verify a request has been sent for example:
     *
     *   client.verify({
     *       <span class=string_literal>'httpRequest'</span>: {
     *           <span class=string_literal>'method'</span>: <span class=string_literal>'POST'</span>,
     *           <span class=string_literal>'path'</span>: <span class=string_literal>'/somePath'</span>
     *       }
     *   }, 2, true);
     *
     * <span class=javadoc_param_annotation>@param</span> <span class=javadoc_param_name>request</span> the http request that must be matched for this verification to pass
     * <span class=javadoc_param_annotation>@param</span> <span class=javadoc_param_name>count</span>   the number of times this request must be matched
     * <span class=javadoc_param_annotation>@param</span> <span class=javadoc_param_name>exact</span>   true if the count is matched as "equal to" or false if the count is matched as "greater than or equal to"
     * <span class=javadoc_param_annotation>@throws</span> an error is the verify fails detailing which requests have been sent
     */</span>
    verify = function (request, count, exact),

    <span class=comment>/**
     * Verify a sequence of requests has been sent for example:
     *
     *   client.verifySequence(
     *       {
     *          <span class=string_literal>'method'</span>: <span class=string_literal>'POST'</span>,
     *          <span class=string_literal>'path'</span>: <span class=string_literal>'/first_request'</span>
     *       },
     *       {
     *          <span class=string_literal>'method'</span>: <span class=string_literal>'POST'</span>,
     *          <span class=string_literal>'path'</span>: <span class=string_literal>'/second_request'</span>
     *       },
     *       {
     *          <span class=string_literal>'method'</span>: <span class=string_literal>'POST'</span>,
     *          <span class=string_literal>'path'</span>: <span class=string_literal>'/third_request'</span>
     *       }
     *   );
     *
     * <span class=javadoc_param_annotation>@param</span> <span class=javadoc_param_name>arguments</span> the list of http requests that must be matched for this verification to pass
     * <span class=javadoc_param_annotation>@throws</span> an error is the verify fails detailing which requests have been sent
     */</span>
    verifySequence = function (),

    <span class=comment>/**
     * Reset MockServer by clearing all expectations
     */</span>
    reset = function (path),

    <span class=comment>/**
     * Clear all expectations that match the specified path
     *
     * <span class=javadoc_param_annotation>@param</span> <span class=javadoc_param_name>path</span> the path to decide which expectations to cleared
     */</span>
    clear = function (path),

    <span class=comment>/**
     * Pretty-print the json for all expectations for the specified path.
     * This is particularly helpful when debugging expectations. The expectation
     * are printed into a dedicated log called mockserver_request.log
     *
     * <span class=javadoc_param_annotation>@param</span> <span class=javadoc_param_name>path</span> the path to decide which expectations to dump to the log
     */</span>
    dumpToLogs = function (path);

    <span class=keyword>return</span> {
        mockAnyResponse: mockAnyResponse,
        mockSimpleResponse: mockSimpleResponse,
        setDefaultHeaders: setDefaultHeaders,
        verify: verify,
        reset: reset,
        clear: clear,
        dumpToLogs: dumpToLogs
    };
};</code></pre>
<a name=javascript-proxy-client class=anchor href="#javascript-proxy-client">&nbsp;</a>
<p><strong>JavaScript Proxy Client</strong></p>
<p>To interact with the proxy from JavaScript it is possible to use either:</p>
<ul>
<li>a browser based API file <a href="https://rawgit.com/jamesdbloom/mockserver/master/mockserver-javascript-client/src/main/javascript/proxyClient.js"><strong>proxyClient.js</strong></a></li>
<li>a Node.js npm module <a href="https://www.npmjs.org/package/mockserver-client"><strong>mockserver-client</strong></a><br/><a href="https://www.npmjs.org/package/mockserver-client"><img width=408 height=81 src="https://nodei.co/npm/mockserver-client.png?downloads=true&downloadRank=true&stars=true" alt=mockserver-client-node /></a></li>
</ul>
<p>To include this file is an HTML page use one of the following script tag to load the file from <a href="http://www.maxcdn.com/">MaxCDN</a>:</p>
<pre><code class=code>&lt;<span class=annotation>script</span> <span class=keyword>type</span>=<span class=string_literal>"text/javascript"</span> <span class=keyword>src</span>=<span class=string_literal>"https://cdn.rawgit.com/jamesdbloom/mockserver/cd04edaf0ad132e3639af355d2ab4887f85e98ae/mockserver-client-javascript/src/main/javascript/proxyClient.js"</span>&gt;&lt;/<span class=annotation>script</span>&gt;</code></pre>
<p>To use the Node.js module add the following code to your node project:</p>
<pre><code class=code><span class=keyword>var</span> mockServer = require(<span class=string_literal>'mockserver-client'</span>),
    proxyClient = mockServer.proxyClient;</code></pre>
<p>Both versions of <strong>proxyClient</strong> provide the same API as follows:</p>
<pre><code class=code><span class=keyword>var</span> proxyClient = function (host, port) {
    <span class=string_literal>"use strict"</span>;

    <span class=comment>/**
     * Retrieve the recorded requests that match the httpRequest parameter as a JSON array, use null for the parameter to retrieve all requests
     *
     * <span class=javadoc_param_annotation>@param</span> <span class=javadoc_param_name>request</span> the http request that is matched against when deciding whether to return each expectation, use null for the parameter to retrieve for all requests
     * <span class=javadoc_param_annotation>@param</span> a JSON array of all expectations that have been recorded by the proxy
     */</span>
    <span class=keyword>var</span> retrieve = function (request),

    <span class=comment>/**
     * Verify a request has been sent for example:
     *
     *   client.verify({
     *       <span class=string_literal>'httpRequest'</span>: {
     *           <span class=string_literal>'method'</span>: <span class=string_literal>'POST'</span>,
     *           <span class=string_literal>'path'</span>: <span class=string_literal>'/somePath'</span>
     *       }
     *   }, 2, true);
     *
     * <span class=javadoc_param_annotation>@param</span> <span class=javadoc_param_name>request</span> the http request that must be matched for this verification to pass
     * <span class=javadoc_param_annotation>@param</span> <span class=javadoc_param_name>count</span>   the number of times this request must be matched
     * <span class=javadoc_param_annotation>@param</span> <span class=javadoc_param_name>exact</span>   true if the count is matched as "equal to" or false if the count is matched as "greater than or equal to"
     * <span class=javadoc_param_annotation>@throws</span> an error is the verify fails detailing which requests have been sent
     */</span>
    verify = function (request, count, exact),

    <span class=comment>/**
     * Verify a sequence of requests has been sent for example:
     *
     *   client.verifySequence(
     *       {
     *          <span class=string_literal>'method'</span>: <span class=string_literal>'POST'</span>,
     *          <span class=string_literal>'path'</span>: <span class=string_literal>'/first_request'</span>
     *       },
     *       {
     *          <span class=string_literal>'method'</span>: <span class=string_literal>'POST'</span>,
     *          <span class=string_literal>'path'</span>: <span class=string_literal>'/second_request'</span>
     *       },
     *       {
     *          <span class=string_literal>'method'</span>: <span class=string_literal>'POST'</span>,
     *          <span class=string_literal>'path'</span>: <span class=string_literal>'/third_request'</span>
     *       }
     *   );
     *
     * <span class=javadoc_param_annotation>@param</span> <span class=javadoc_param_name>arguments</span> the list of http requests that must be matched for this verification to pass
     * <span class=javadoc_param_annotation>@throws</span> an error is the verify fails detailing which requests have been sent
     */</span>
    verifySequence = function (),

    <span class=comment>/**
     * Reset the proxy by clearing all recorded requests
     */</span>
    reset = function (),

    <span class=comment>/**
     * Clear all recorded requests that match the specified path
     *
     * <span class=javadoc_param_annotation>@param</span> <span class=javadoc_param_name>path</span> the path to decide which expectations to cleared
     */</span>
    clear = function (path),

    <span class=comment>/**
     * Pretty-print the json for all requests / responses that match the specified path
     * as Expectations to the log. They are printed into a dedicated log called mockserver_request.log
     *
     * <span class=javadoc_param_annotation>@param</span> <span class=javadoc_param_name>path</span> the path to decide which expectations to dump to the log
     */</span>
    dumpToLogs = function (path);

    <span class=keyword>return</span> {
        retrieve: retrieve,
        verify: verify,
        reset: reset,
        clear: clear,
        dumpToLogs: dumpToLogs
    };
};</code></pre>
<a name=why-use-mockserver class=anchor href="#why-use-mockserver">&nbsp;</a>
<h2>Why use MockServer</h2>
<p>MockServer allows you to mock any server or service that you connect to over HTTP or HTTPS, such as a REST or RPC service. </p>
<p>This is useful in the following scenarios:</p>
<ul>
<li>testing
<ul>
<li>easily recreate all types of responses for HTTP dependencies such as REST or RPC services to test applications easily and affectively</li>
<li>isolate the system under test to ensure tests run reliably and only fail when there is a genuine bug. It is important only the system under test is tested and not its dependencies to avoid tests failing due to irrelevant external changes such as network failure or a server being rebooted / redeployed.</li>
<li>easily setup mock responses independently for each test to ensure test data is encapsulated with each test. Avoid sharing data between tests that is difficult to manage and maintain and risks tests infecting each other.</li>
</ul>
</li>
<li>de-coupling development
<ul>
<li>start working against a service API before the service is available. If an API or service is not yet fully developed MockServer can mock the API allowing any team who is using the service to start work without being delayed.</li>
<li>isolate development teams particularly critical during the initial development phases when the APIs / services may be extremely unstable and volatile. Using MockServer allows development work to continue even when an external service fails.</li>
</ul>
</li>
</ul>
<p>A system with service dependencies as follows:</p>
<p><a href="images/SystemInProduction.png" target=_blank><img src="images/SystemInProduction.png" alt="System In Production" style="max-width:100%;"></a></p>
<p>Could be tested with MockServer, mocking the service dependencies, as follows:</p>
<p><a href="images/SystemUnderTest.png" target=_blank><img src="images/SystemUnderTest.png" alt="Mocking service dependencies with MockServer" style="max-width:100%;"></a></p>
<a name=getting-started class=anchor href="#getting-started">&nbsp;</a>
<h2>Getting Started</h2>
<p>To use MockServer:</p>
<ol>
<li><a href="#starting-mockserver">Start MockServer</a></li>
<li><a href="#create-expectations">Create Expectations</a></li>
<li><a href="#verify-behaviour">Verify Behaviour</a></li>
<li>Run Tests</li>
</ol>
<a name=starting-mockserver class=anchor href="#starting-mockserver">&nbsp;</a>
<h3>Starting MockServer</h3>
<p>Before any mock expectation can be sent to MockServer it must be started.</p>
<p>The mock server can be run:</p>
<ul>
<li>via a <a href="#maven-plugin"><strong>Maven Plugin</strong></a> as part of a Maven build cycle</li>
<li><a href="#client-api"><strong>programmatically via an API</strong></a> in an <span class=annotation>@Before</span> or <span class=annotation>@After</span> method</li>
<li><a href="#junit-rule"><strong>using a JUnit @Rule</strong></a> via a <span class=annotation>@Rule</span> annotated field in a JUnit test</li>
<li><a href="#running-from-command-line"><strong>from the command line</strong></a> as a stand-alone process in a test environment</li>
<li>as a <a href="#docker-container"><strong>Docker container</strong></a> in any Docker enabled environment</li>
<li>as a <a href="#vertx-module"><strong>Vert.X module</strong></a> as part of an existing Vert.X environment</li>
<li>as a <a href="#deployable-war"><strong>deployable WAR</strong></a> to an existing application server</li>
<li>as a <a href="https://www.npmjs.org/package/mockserver-grunt"><strong>Grunt plugin</strong></a> as part of a Grunt build cycle</li>
<li>as a <a href="https://www.npmjs.org/package/mockserver-grunt"><strong>Node.js (npm) module</strong></a> from any Node.js code</li>
</ul>
<p>MockServer is available as:</p>
<ul>
<li>a stand alone Netty web server that is fully self contained</li>
<li>a deployable WAR that runs on any JEE web server</li>
<li>a fully encapsulated Docker container</li>
<li>a Vert.X module that runs on a Vert.X</li>
</ul>
<p>It is also possible to build and run MockServer directly from source code <a href="#build-and-run-from-source">as described below</a></p>
<a name=maven-plugin class=anchor href="#maven-plugin">&nbsp;</a>
<h4>Maven Plugin</h4>
<p>To run MockServer as part of your build add the following plugin to your pom.xml:</p>
<pre><code class="code xml">&lt;<span class=element>plugin</span>&gt;
    &lt;<span class=element>groupId</span>&gt;<span class=element_value>org.mock-server</span>&lt;/<span class=element>groupId</span>&gt;
    &lt;<span class=element>artifactId</span>&gt;<span class=element_value>mockserver-maven-plugin</span>&lt;/<span class=element>artifactId</span>&gt;
    &lt;<span class=element>version</span>&gt;<span class=element_value>3.9.8</span>&lt;/<span class=element>version</span>&gt;
    &lt;<span class=element>configuration</span>&gt;
        &lt;<span class=element>serverPort</span>&gt;<span class=element_value>1080</span>&lt;/<span class=element>serverPort</span>&gt;
        &lt;<span class=element>proxyPort</span>&gt;<span class=element_value>1090</span>&lt;/<span class=element>proxyPort</span>&gt;
        &lt;<span class=element>logLevel</span>&gt;<span class=element_value>DEBUG</span>&lt;/<span class=element>logLevel</span>&gt;
        &lt;<span class=element>initializationClass</span>&gt;<span class=element_value>org.mockserver.maven.ExampleInitializationClass</span>&lt;/<span class=element>initializationClass</span>&gt;
    &lt;/<span class=element>configuration</span>&gt;
    &lt;<span class=element>executions</span>&gt;
        &lt;<span class=element>execution</span>&gt;
            &lt;<span class=element>id</span>&gt;<span class=element_value>process-test-classes</span>&lt;/<span class=element>id</span>&gt;
            &lt;<span class=element>phase</span>&gt;<span class=element_value>process-test-classes</span>&lt;/<span class=element>phase</span>&gt;
            &lt;<span class=element>goals</span>&gt;
                &lt;<span class=element>goal</span>&gt;<span class=element_value>start</span>&lt;/<span class=element>goal</span>&gt;
            &lt;/<span class=element>goals</span>&gt;
        &lt;/<span class=element>execution</span>&gt;
        &lt;<span class=element>execution</span>&gt;
            &lt;<span class=element>id</span>&gt;<span class=element_value>verify</span>&lt;/<span class=element>id</span>&gt;
            &lt;<span class=element>phase</span>&gt;<span class=element_value>verify</span>&lt;/<span class=element>phase</span>&gt;
            &lt;<span class=element>goals</span>&gt;
                &lt;<span class=element>goal</span>&gt;<span class=element_value>stop</span>&lt;/<span class=element>goal</span>&gt;
            &lt;/<span class=element>goals</span>&gt;
        &lt;/<span class=element>execution</span>&gt;
    &lt;/<span class=element>executions</span>&gt;
&lt;/<span class=element>plugin</span>&gt;</code></pre>
<p>This will start MockServer during the <strong>process-test-classes</strong> phase and will stop MockServer during the <strong>verify</strong> phase. For more details about Maven build phases see:
<a href="http://maven.apache.org/guides/introduction/introduction-to-the-lifecycle.html">Introduction to the Build Lifecycle</a>.</p>
<p>This ensures that any integration tests you run during the <strong>test</strong> or <strong>integration-test</strong> phases can use MockServer on the port specified.</p>
<p>It is also possible to run MockServer as a forked JVM using the <span class=annotation>runForked</span> and <span class=annotation>stopForked</span> goals as follows:</p>
<pre><code class="code xml"> &lt;<span class=element>plugin</span>&gt;
     &lt;<span class=element>groupId</span>&gt;<span class=element_value>org.mock-server</span>&lt;/<span class=element>groupId</span>&gt;
     &lt;<span class=element>artifactId</span>&gt;<span class=element_value>mockserver-maven-plugin</span>&lt;/<span class=element>artifactId</span>&gt;
     &lt;<span class=element>version</span>&gt;<span class=element_value>3.9.8</span>&lt;/<span class=element>version</span>&gt;
     &lt;<span class=element>configuration</span>&gt;
        &lt;<span class=element>serverPort</span>&gt;<span class=element_value>1080</span>&lt;/<span class=element>serverPort</span>&gt;
        &lt;<span class=element>proxyPort</span>&gt;<span class=element_value>1090</span>&lt;/<span class=element>proxyPort</span>&gt;
        &lt;<span class=element>logLevel</span>&gt;<span class=element_value>DEBUG</span>&lt;/<span class=element>logLevel</span>&gt;
        &lt;<span class=element>initializationClass</span>&gt;<span class=element_value>org.mockserver.maven.ExampleInitializationClass</span>&lt;/<span class=element>initializationClass</span>&gt;
     &lt;/<span class=element>configuration</span>&gt;
     &lt;<span class=element>executions</span>&gt;
         &lt;<span class=element>execution</span>&gt;
             &lt;<span class=element>id</span>&gt;<span class=element_value>process-test-classes</span>&lt;/<span class=element>id</span>&gt;
             &lt;<span class=element>phase</span>&gt;<span class=element_value>process-test-classes</span>&lt;/<span class=element>phase</span>&gt;
             &lt;<span class=element>goals</span>&gt;
                 &lt;<span class=element>goal</span>&gt;<span class=element_value>runForked</span>&lt;/<span class=element>goal</span>&gt;
             &lt;/<span class=element>goals</span>&gt;
         &lt;/<span class=element>execution</span>&gt;
         &lt;<span class=element>execution</span>&gt;
             &lt;<span class=element>id</span>&gt;<span class=element_value>verify</span>&lt;/<span class=element>id</span>&gt;
             &lt;<span class=element>phase</span>&gt;<span class=element_value>verify</span>&lt;/<span class=element>phase</span>&gt;
             &lt;<span class=element>goals</span>&gt;
                 &lt;<span class=element>goal</span>&gt;<span class=element_value>stopForked</span>&lt;/<span class=element>goal</span>&gt;
             &lt;/<span class=element>goals</span>&gt;
         &lt;/<span class=element>execution</span>&gt;
     &lt;/<span class=element>executions</span>&gt;
 &lt;/<span class=element>plugin</span>&gt;</code></pre>
<p>
<strong>Note:</strong> If you use the <span class=annotation>runForked</span> goal as above and the <strong>test</strong> phase fails (because a test has failed) MockServer will not be stopped as Maven does not run any more phases after a phase has failed. In the case above the
<strong>verify</strong> phase is not run if a test fails so the forked MockServer will not be stopped. If you want to ensure MockServer is stopped even when there are test failures make sure you use <span class=annotation>start</span> and
<span class=annotation>stop</span> goals as these run MockServer on a separate thread that is stopped however maven exits (even if a test fails). </p>
<p>These goals can be used from the command line as well to start and stop MockServer, as follows:</p>
<p>To run MockServer synchronously and block:</p>
<pre><code class=code>mvn mockserver:run</code></pre>
<p>To run MockServer asynchronously as a forked JVM:</p>
<pre><code class=code>mvn mockserver:runForked</code></pre>
<p>To stop a forked instance of MockServer running on the same machine:</p>
<pre><code class=code>mvn mockserver:stopForked</code></pre>
<p>The <strong>stopForked</strong> goal does assumes that MockServer is running on the same physical machine as it uses 127.0.0.1 to communicate with MockServer stop socket.</p>
<p>The Maven plugin has the following goals:</p>
<ul>
<li>
<strong>start</strong> - start MockServer, do not block, but stop when build ends
</li>
<li>
<strong>stop</strong> - stop a MockServer started earlier as part of the current build
</li>
<li>
<strong>run</strong> - run MockServer and block waiting for requests (timeout config if provided limits how long to block for)
</li>
<li>
<strong>runForked</strong> - run MockServer as separate forked JVM, do not block, stay alive when build ends
</li>
<li>
<strong>stopForked</strong> - stop a forked MockServer, previously started by a runForked goal
</li>
</ul>
<p>The Maven plugin can be configured as follows:</p>
<ul>
<li>
<strong>serverPort</strong> - The port MockServer listens to incoming HTTP and HTTPS requests, port unification is used to support HTTP and HTTPS on the same port (required: false - but at least one of the two ports must be specified)
</li>
<li>
<strong>proxyPort</strong> - The port the proxy listens to incoming HTTP, HTTP -> HTTPS CONNECT, HTTPS and SOCKS requests, port unification supports for all protocols on the same port (required: false - but at least one of the two ports must be specified)
</li>
<li>
<strong>timeout</strong> - How long to block waiting for MockServer, used by <strong>run</strong> goal, 0 means wait indefinitely (required: false, default: 0)
</li>
<li>
<strong>logLevel</strong> - The logging level (required: false, default: WARN)
</li>
<li>
<strong>skip</strong> - Prevent the plugin from running (required: false, default: false)
</li>
<li>
<strong>initializationClass</strong> - To enable the creation of default expectations that are generic across all tests or mocking scenarios a class can be specified to initialize expectations in MockServer, this class must implement
<span class=annotation>org.mockserver.initialize.ExpectationInitializer</span> interface, the <span class=annotation>initializeExpectations(MockServerClient mockServerClient)</span> method will be called once MockServer has been started (but ONLY if
<strong>serverPort</strong> has been set), however it should be noted that it is generally better practice to create all expectations locally in each test (or test class) for clarity, simplicity and to avoid brittle tests. Note: that the plugin must be started during the
<strong>process-test-classes</strong> to ensure that the initialization class has been compiled from either <strong>src/main/java</strong> or <strong>src/test/java</strong> locations. (required: false, default: false)
</li>
</ul>
<a name=client-api class=anchor href="#client-api">&nbsp;</a>
<h4>Client API&nbsp;&nbsp;-&nbsp;&nbsp;starting and stopping</h4>
<p>Use the client API to run MockServer programmatically.</p>
<p>First add the following maven dependency:</p>
<pre><code class="code xml">&lt;!-- mockserver --&gt;
&lt;<span class=element>dependency</span>&gt;
     &lt;<span class=element>groupId</span>&gt;<span class=element_value>org.mock-server</span>&lt;<span class=element>/groupId</span>&gt;
     &lt;<span class=element>artifactId</span>&gt;<span class=element_value>mockserver-netty</span>&lt;<span class=element>/artifactId</span>&gt;
     &lt;<span class=element>version</span>&gt;<span class=element_value>3.9.8</span>&lt;<span class=element>/version</span>&gt;
&lt;<span class=element>/dependency</span>&gt;</code></pre>
<p>To start the server and create a client the simplest way is to the start factory methods ClientAndServer.startClientAndServer or ClientAndProxy.startClientAndProxy as follows:</p>
<p>Add includes:</p>
<pre><code class=code><span class=keyword>import static</span> org.mockserver.integration.ClientAndProxy.startClientAndProxy;
<span class=keyword>import static</span> org.mockserver.integration.ClientAndServer.startClientAndServer;</code></pre>
<p>Add fields:</p>
<pre><code class=code><span class=keyword>private</span> ClientAndProxy <span class=this_value>proxy</span>;
<span class=keyword>private</span> ClientAndServer <span class=this_value>mockServer</span>;</code></pre>
<p>Use factory method to start server and client when appropriate, for example in <span class=annotation>@Before</span> method:</p>
<pre><code class=code><span class=annotation>@Before</span>
<span class=keyword>public void</span> startProxy() {
    <span class=this_value>mockServer</span> = startClientAndServer(<span class=numeric_literal>8080</span>);
    <span class=this_value>proxy</span> = startClientAndProxy(<span class=numeric_literal>9090</span>);
}</code></pre>
<p>Stop server and client when appropriate, for example in <span class=annotation>@After</span> method:</p>
<pre><code class=code><span class=annotation>@After</span>
<span class=keyword>public void</span> stopProxy() {
    <span class=this_value>proxy</span>.stop();
    <span class=this_value>mockServer</span>.stop();
}</code></pre>
<p>The <a href="https://github.com/jamesdbloom/mockserver/tree/master/mockserver-examples">mockserver-example</a> project contains an example test called
<a href="https://github.com/jamesdbloom/mockserver/blob/master/mockserver-examples/src/test/java/org/mockserver/web/controller/BooksPageIntegrationTest.java">BookPageIntegrationTest</a> that demonstrates a fully working example.</p>
<a name=junit-rule class=anchor href="#junit-rule">&nbsp;</a>
<h4>Running MockServer via a JUnit @Rule</h4>
<p>MockServer can be run using the MockServerRule. The MockServerRule starts MockServer on a free port before the any test runs and stops MockServer after all tests have completed. A MockServerClient is then assigned to any field in the unit test of type org.mockserver.client.server.MockServerClient</p>
<pre><code class=code><span class=annotation>@Rule</span>
<span class=keyword>public</span> MockServerRule mockServerRule = <span class=keyword>new</span> MockServerRule(<span class=keyword>this</span>);

<span class=keyword>private</span> MockServerClient mockServerClient;</code></pre>
<p>Any test method can now use the <strong>mockServerClient</strong> field to <a href="#create-expectations">create expectation</a> or <a href="#verify-behaviour">verify</a> requests.</p>
<p>The MockServerRule has the following constructors:</p>
<pre><code class=code><span class=comment>/**
 * Start MockServer prior to test execution and stop MockServer after the tests have completed.
 * This constructor dynamically allocates a free port for MockServer to use.
 *
 * <span class=javadoc_param_annotation>@param</span> <span class=javadoc_param_name>target</span> an instance of the test being executed
 */</span>
<span class=keyword>public</span> MockServerRule(Object target);

<span class=comment>/**
 * Start MockServer prior to test execution and stop MockServer after the tests have completed.
 * This constructor dynamically allocates a free port for MockServer to use.
 *
 * <span class=javadoc_param_annotation>@param</span> <span class=javadoc_param_name>target</span> an instance of the test being executed
 * <span class=javadoc_param_annotation>@param</span> <span class=javadoc_param_name>perTestSuite</span> indicates how many instances of MockServer are created
 *                     if true a single MockServer is created per JVM
 *                     if false one instance per test class is created
 */</span>
<span class=keyword>public</span> MockServerRule(Object target, <span class=keyword>boolean</span> per TestSuite);
<span class=comment>/**
 * Start the proxy prior to test execution and stop the proxy after the tests have completed.
 * This constructor dynamically create a proxy that accepts HTTP requests on the specified port
 *
 * <span class=javadoc_param_annotation>@param</span> <span class=javadoc_param_name>httpPort</span> the HTTP port for the proxy
 * <span class=javadoc_param_annotation>@param</span> <span class=javadoc_param_name>target</span> an instance of the test being executed
 */</span>
<span class=keyword>public</span> MockServerRule(Integer httpPort, Object target);

<span class=comment>/**
 * Start the proxy prior to test execution and stop the proxy after the tests have completed.
 * This constructor dynamically create a proxy that accepts HTTP requests on the specified port
 *
 * <span class=javadoc_param_annotation>@param</span> <span class=javadoc_param_name>httpPort</span> the HTTP port for the proxy
 * <span class=javadoc_param_annotation>@param</span> <span class=javadoc_param_name>target</span> an instance of the test being executed
 * <span class=javadoc_param_annotation>@param</span> <span class=javadoc_param_name>perTestSuite</span> indicates how many instances of MockServer are created
 *                     if true a single MockServer is created per JVM
 *                     if false one instance per test class is created
 */</span>
<span class=keyword>public</span> MockServerRule(Integer httpPort, Object target, <span class=keyword>boolean</span> per TestSuite);

<span class=comment>/**
 * Start the proxy prior to test execution and stop the proxy after the tests have completed.
 * This constructor dynamically create a proxy that accepts HTTP and HTTPS requests on the specified ports
 *
 * <span class=javadoc_param_annotation>@param</span> <span class=javadoc_param_name>httpPort</span> the HTTP port for the proxy
 * <span class=javadoc_param_annotation>@param</span> <span class=javadoc_param_name>httpsPort</span> the HTTPS port for the proxy
 * <span class=javadoc_param_annotation>@param</span> <span class=javadoc_param_name>target</span> an instance of the test being executed
 * <span class=javadoc_param_annotation>@param</span> <span class=javadoc_param_name>perTestSuite</span> indicates how many instances of MockServer are created
 *                     if true a single MockServer is created per JVM
 *                     if false one instance per test class is created
 */</span>
<span class=keyword>public</span> MockServerRule(Integer httpPort, Integer httpsPort, Object target, <span class=keyword>boolean</span> per TestSuite);</code></pre>
<p>The proxy can be run using the ProxyRule. The ProxyRule starts the proxy before the any test runs and stops the proxy after all tests have completed. A ProxyClient is then assigned to any field in the unit test of type org.mockserver.client.proxy.ProxyClient</p>
<pre><code class=code><span class=annotation>@Rule</span>
<span class=keyword>public</span> ProxyRule proxyRule = <span class=keyword>new</span> ProxyRule(<span class=numeric_literal>8080</span>, <span class=keyword>this</span>);

<span class=keyword>private</span> ProxyClient proxyClient;</code></pre>
<p>Any test method can now use the <strong>proxyClient</strong> field to <a href="#verify-behaviour">verify</a> requests or <a href="#analysing-behaviour">anaylse a system's behaviour</a>.</p>
<p>The ProxyRule has the following constructors:</p>
<pre><code class=code><span class=comment>/**
 * Start the proxy prior to test execution and stop the proxy after the tests have completed.
 * This constructor dynamically allocates a free port for the proxy to use.
 * Note: The getHttpPort getter can be used to retrieve the dynamically allocated port.
 *
 * <span class=javadoc_param_annotation>@param</span> <span class=javadoc_param_name>target</span> an instance of the test being executed
 */</span>
<span class=keyword>public</span> ProxyRule(Object target);

<span class=comment>/**
 * Start the proxy prior to test execution and stop the proxy after the tests have completed.
 * This constructor dynamically allocates a free port for the proxy to use.
 *
 * <span class=javadoc_param_annotation>@param</span> <span class=javadoc_param_name>target</span> an instance of the test being executed
 * <span class=javadoc_param_annotation>@param</span> <span class=javadoc_param_name>perTestSuite</span> indicates how many instances of the proxy are created
 *                     if true a single proxy is created per JVM
 *                     if false one instance per test class is created
 */</span>
<span class=keyword>public</span> ProxyRule(Object target, <span class=keyword>boolean</span> per TestSuite);

<span class=comment>/**
 * Start the proxy prior to test execution and stop the proxy after the tests have completed.
 * This constructor dynamically create a proxy that accepts HTTP requests on the specified port
 *
 * <span class=javadoc_param_annotation>@param</span> <span class=javadoc_param_name>httpPort</span> the HTTP port for the proxy
 * <span class=javadoc_param_annotation>@param</span> <span class=javadoc_param_name>target</span> an instance of the test being executed
 */</span>
<span class=keyword>public</span> ProxyRule(Integer httpPort, Object target);

<span class=comment>/**
 * Start the proxy prior to test execution and stop the proxy after the tests have completed.
 * This constructor dynamically create a proxy that accepts HTTP requests on the specified port
 *
 * <span class=javadoc_param_annotation>@param</span> <span class=javadoc_param_name>httpPort</span> the HTTP port for the proxy
 * <span class=javadoc_param_annotation>@param</span> <span class=javadoc_param_name>target</span> an instance of the test being executed
 * <span class=javadoc_param_annotation>@param</span> <span class=javadoc_param_name>perTestSuite</span> indicates how many instances of the proxy are created
 *                     if true a single proxy is created per JVM
 *                     if false one instance per test class is created
 */</span>
<span class=keyword>public</span> ProxyRule(Integer httpPort, Object target, <span class=keyword>boolean</span> per TestSuite);

<span class=comment>/**
 * Start the proxy prior to test execution and stop the proxy after the tests have completed.
 * This constructor dynamically create a proxy that accepts HTTP and HTTPS requests on the specified ports
 *
 * <span class=javadoc_param_annotation>@param</span> <span class=javadoc_param_name>httpPort</span> the HTTP port for the proxy
 * <span class=javadoc_param_annotation>@param</span> <span class=javadoc_param_name>httpsPort</span> the HTTPS port for the proxy
 * <span class=javadoc_param_annotation>@param</span> <span class=javadoc_param_name>target</span> an instance of the test being executed
 * <span class=javadoc_param_annotation>@param</span> <span class=javadoc_param_name>perTestSuite</span> indicates how many instances of the proxy are created
 *                     if true a single proxy is created per JVM
 *                     if false one instance per test class is created
 */</span>
<span class=keyword>public</span> ProxyRule(Integer httpPort, Integer httpsPort, Object target, <span class=keyword>boolean</span> per TestSuite);</code></pre>
<a name=running-from-command-line class=anchor href="#running-from-command-line">&nbsp;</a>
<h4>Running From Command Line</h4>
<p>MockServer can be run directly from the command line and using Netty as follow:</p>
<ol>
<li><p>download <a href="http://search.maven.org/remotecontent?filepath=org/mock-server/mockserver-netty/3.9.8/mockserver-netty-3.9.8-jar-with-dependencies.jar">mockserver-netty-3.9.8-jar-with-dependencies.jar</a> from Maven Central</p></li>
<li>
<code class="code inline">java -jar &lt;path to mockserver-netty-3.9.8-jar-with-dependencies.jar&gt; -serverPort &lt;port&gt;</code>
</li>
</ol>
<p>The command line supports the following options:</p>
<pre><code class=code>java -jar &lt;path to jar&gt; [-serverPort &lt;port&gt;]        \
    [-proxyPort &lt;port&gt;]

    valid options are:
    -serverPort &lt;port&gt;         specifies the HTTP and HTTPS port for the
    MockServer port unification is used to
    support HTTP and HTTPS on the same port

    -proxyPort &lt;path&gt;          specifies the HTTP, HTTPS, SOCKS and HTTP
    CONNECT port for proxy, port unification
    supports for all protocols on the same port</code></pre>
<p>For example:</p>
<pre><code class=code>java -Dmockserver.logLevel=DEBUG -jar ~/Downloads/mockserver-netty-3.9.8-jar-with-dependencies.jar -serverPort <span class=numeric_literal>8080</span> -proxyPort <span class=numeric_literal>9090</span></code></pre>
<a name=docker-container class=anchor href="#docker-container">&nbsp;</a>
<h4><a href="https://registry.hub.docker.com/u/jamesdbloom/mockserver/">Docker Container</a></h4>
<p>MockServer can be run as a <a href="https://registry.hub.docker.com/u/jamesdbloom/mockserver/">Docker container</a>.</p>
<p>First, you'll need to <a href="https://docs.docker.com/">install Docker</a>.</p>
<p>Then to run MockServer as a Docker container run the following command:</p>
<pre><code class=code>docker run -d -P jamesdbloom/mockserver</code></pre>
<p>This command will map the ports exposed by MockServer and Proxy to dynamic ports using the <strong>-P</strong> option. To specify which ports are used you can specify one or more port mappings using the <strong>-p
<span class=annotation>&lt;host port&gt;</span>:<span class=annotation>&lt;container port&gt;</span></strong> option. You only need to specify mapping for ports you need to use, for example, if you are not using the proxy there is no need to provide port mapping options for the proxy ports.</p>
<p>To run MockServer specifying as a Docker container run the following command (replacing each <strong><span class=annotation>&lt; ... &gt;</span></strong> section with the appropriate port value):</p>
<pre><code class=code>docker run -d -p <span class=annotation>&lt;serverPort&gt;</span>:<span class=numeric_literal>8080</span> -p <span class=annotation>&lt;proxyPort&gt;</span>:<span class=numeric_literal>9090</span> jamesdbloom/mockserver</code></pre>
<p><strong>Note</strong>: you only need to specify mapping for ports you need to use, for example, if you are only using MockServer to mock HTTP endpoints then only specify <strong>-p <span class=annotation>&lt;serverPort&gt;</span>:<span class=numeric_literal>8080</span></strong> as follows (replacing each
<strong><span class=annotation>&lt; ... &gt;</span></strong> section with the appropriate port value):</p>
<pre><code class=code>docker run -d -p <span class=annotation>&lt;serverPort&gt;</span>:<span class=numeric_literal>8080</span> jamesdbloom/mockserver</code></pre>
<p>This MockServer docker container exposes the following ports:</p>
<ul>
<li><strong>serverPort</strong> 8080</li>
<li><strong>proxyPort</strong> 9090</li>
</ul>
<a name=vertx-module class=anchor href="#vertx-module">&nbsp;</a>
<h4>Vert.X Module</h4>
<p>MockServer can be run as a Vert.X module. However, support for the Vert.X module was stopped at version 2.9. This is because Vert.X requires Java 7 and MockServer Vert.X module was the only MockServer module that relied on Java 7 making the build and development process more complex.</p>
<p>First, you'll need to <a href="http://vertx.io/install.html">install Vert.x</a>.</p>
<p>Then to run MockServer as Vert.X module run the following command:</p>
<pre><code class=code>vertx install org.mock-server~mockserver-vertx~2.9
export VERTX_OPTS=<span class=string_literal>"-Dmockserver.serverPort=8080 -Dmockserver.serverSecurePort=1443 -Dmockserver.logLevel=TRACE"</span>
vertx runmod org.mock-server~mockserver-vertx~2.9</code></pre>
<p>The specify the HTTP port and / or HTTPS port the <strong>VERTX_OPTS</strong> environment variable must be set specifying the system property <strong>mockserver.serverPort</strong> for the HTTP port and <strong>mockserver.serverSecurePort</strong> for the HTTPS port.</p>
<p><strong>Note:</strong> At least one of either the HTTP or the HTTPS port must be specified for MockServer to run.</p>
<pre><code class=code>export VERTX_OPTS=<span class=string_literal>"-Dmockserver.serverPort=8080 -Dmockserver.serverSecurePort=1443 -Dmockserver.logLevel=TRACE"</span></code></pre>
<p>It is also possible to update the default logging level by setting the system properties <strong>mockserver.logLevel</strong> as above.</p>
<a name=deployable-war class=anchor href="#deployable-war">&nbsp;</a>
<h4>Web Archive (WAR)</h4>
<p>To run as a WAR deployed on any JEE web server:</p>
<ol>
<li>download <a href="http://search.maven.org/remotecontent?filepath=org/mock-server/mockserver-war/3.9.8/mockserver-war-3.9.8.war">mockserver-war-3.9.8.war</a> from Maven Central</li>
<li>deploy <strong>mockserver-war-3.9.8.war</strong> to any JEE web server</li>
</ol>
<p><strong>WAR Context Path</strong></p>
<p>The WAR context path is ignored from all request matching for path.</p>
<p>The MockServerClient constructor includes an argument for the context path that the WAR has been deployed to, as follows:</p>
<pre><code class=code><span class=keyword>public</span> MockServerClient(String host, <span class=keyword>int</span> port, String contextPath)</code></pre>
<a name=build-and-run-from-source class=anchor href="#build-and-run-from-source">&nbsp;</a>
<h4>Build & Run From Source</h4>
<p>MockServer is now only built using maven as the use of gradle caused problems with the Travis CI environment so the gradle build was removed.</p>
<p>First clone the repository as follows:</p>
<pre><code class=code>git clone https://github.com/jamesdbloom/mockservice.git
cd mockserver</code></pre>
<p>Next build and run the project using maven.</p>
<p><strong><em>Maven</em></strong></p>
<p>To build an executable jar containing all dependencies run the following command:</p>
<pre><code class=code>mvn clean package</code></pre>
<p>This will produce a jar file under the target directory called, as follows:</p>
<pre><code class=code>mockserver-netty/target/mockserver-netty-3.9.8-jar-with-dependencies.jar</code></pre>
<p>Run MockServer then using the executable jar as per the instruction above in <a href="#running-from-command-line">Running From The Command Line</a></p>
<p><strong>Create Client For Existing MockServer or Proxy</strong></p>
<p>To create a pointing at an existing endpoint using the MockServerClient and ProxyClient constructors, for example:</p>
<pre><code class=code><span class=annotation>@Before</span>
<span class=keyword>public void</span> startProxy() {
    <span class=this_value>mockServer</span> = <span class=keyword>new</span> MockServerClient(<span class=string_literal>"localhost"</span>, <span class=numeric_literal>8080</span>);
    <span class=this_value>proxy</span> = <span class=keyword>new</span> ProxyClient(<span class=string_literal>"localhost"</span>, <span class=numeric_literal>9090</span>);
}</code></pre>
<p>The MockServerClient has the following methods:</p>
<pre><code class=code><span class=comment>/**
* Start the client communicating to a MockServer at the specified host and port
* for example:
*
*   MockServerClient mockServerClient = <span class=keyword>new</span> MockServerClient(<span class=string_literal>"localhost"</span>, <span class=numeric_literal>8080</span>);
*
* <span class=javadoc_param_annotation>@param</span> <span class=javadoc_param_name>host</span> the host for MockServer to communicate with
* <span class=javadoc_param_annotation>@param</span> <span class=javadoc_param_name>port</span> the port for MockServer to communicate with
*/</span>
<span class=keyword>public</span> MockServerClient(String host, <span class=keyword>int</span> port);

<span class=comment>/**
* Start the client communicating to a MockServer at the specified host and port
* and contextPath for example:
*
*   MockServerClient mockServerClient = <span class=keyword>new</span> MockServerClient(<span class=string_literal>"localhost"</span>, <span class=numeric_literal>8080</span>, <span class=string_literal>"/mockserver"</span>);
*
* <span class=javadoc_param_annotation>@param</span> <span class=javadoc_param_name>host</span> the host for MockServer to communicate with
* <span class=javadoc_param_annotation>@param</span> <span class=javadoc_param_name>port</span> the port for MockServer to communicate with
* <span class=javadoc_param_annotation>@param</span> <span class=javadoc_param_name>contextPath</span> the context path that MockServer war is deployed to
*/</span>
<span class=keyword>public</span> MockServerClient(String host, <span class=keyword>int</span> port, String contextPath);

<span class=comment>/**
* Specify an unlimited expectation that will respond regardless of the number of matching http
* for example:
*
*   <span class=this_value>mockServerClient</span>
*           .when(
*                   request()
*                           .withPath(<span class=string_literal>"/some_path"</span>)
*                           .withBody(<span class=string_literal>"some_request_body"</span>)
*           )
*           .respond(
*                   response()
*                           .withBody(<span class=string_literal>"some_response_body"</span>)
*                           .withHeaders(
*                                   <span class=keyword>new</span> Header(<span class=string_literal>"responseName"</span>, <span class=string_literal>"responseValue"</span>)
*                           )
*           );
*
* or:
*   <span class=this_value>mockServerClient</span>
*           .when(
*                   request()
*                           .withPath(<span class=string_literal>"/some_path"</span>)
*                           .withBody(<span class=string_literal>"some_request_body"</span>)
*           )
*           .forward(
*                   forward()
*                           .withHost(<span class=string_literal>"some_host_name"</span>)
*                           .withPort(<span class=numeric_literal>80</span>)
*           );
*
* <span class=javadoc_param_annotation>@param</span> <span class=javadoc_param_name>httpRequest</span> the http request that must be matched for this expectation to respond
* <span class=javadoc_param_annotation>@return</span> an Expectation object that can be used to specify the response
*/</span>
<span class=keyword>public</span> ForwardChainExpectation when(HttpRequest httpRequest);

<span class=comment>/**
* Specify an limited expectation that will respond a specified number of times when the http is matched
* for example:
*
*   <span class=this_value>mockServerClient</span>
*           .when(
*                   <span class=keyword>new</span> HttpRequest()
*                           .withPath(<span class=string_literal>"/some_path"</span>)
*                           .withBody(<span class=string_literal>"some_request_body"</span>),
*                   Times.exactly(<span class=numeric_literal>5</span>)
*           )
*           .respond(
*                   <span class=keyword>new</span> HttpResponse()
*                           .withBody(<span class=string_literal>"some_response_body"</span>)
*                           .withHeaders(
*                                   <span class=keyword>new</span> Header(<span class=string_literal>"responseName"</span>, <span class=string_literal>"responseValue"</span>)
*                           )
*           );
*
* or:
*   <span class=this_value>mockServerClient</span>
*           .when(
*                   request()
*                           .withPath(<span class=string_literal>"/some_path"</span>)
*                           .withBody(<span class=string_literal>"some_request_body"</span>),
*                   Times.once()
*           )
*           .forward(
*                   forward()
*                           .withHost(<span class=string_literal>"some_host_name"</span>)
*                           .withPort(<span class=numeric_literal>80</span>)
*           );
*
* <span class=javadoc_param_annotation>@param</span> <span class=javadoc_param_name>httpRequest</span> the http request that must be matched for this expectation to respond
* <span class=javadoc_param_annotation>@param</span> <span class=javadoc_param_name>times</span>       the number of times to respond when this http is matched
* <span class=javadoc_param_annotation>@return</span> an Expectation object that can be used to specify the response
*/</span>
<span class=keyword>public</span> ForwardChainExpectation when(HttpRequest httpRequest, Times times);

<span class=comment>/**
* Pretty-print the json for all expectations to the log.
* They are printed into a dedicated log called <span class=annotation>mockserver_request.log</span>
*/</span>
<span class=keyword>public</span> MockServerClient dumpToLog();

<span class=comment>/**
* Pretty-print the json for all expectations that match the request to the log.
* They are printed into a dedicated log called <span class=annotation>mockserver_request.log</span>
*
* <span class=javadoc_param_annotation>@param</span> <span class=javadoc_param_name>httpRequest</span> the http request that is matched against when deciding what to log
*                    if <span class=keyword>null</span> all requests are logged
*/</span>
<span class=keyword>public</span> MockServerClient dumpToLog(HttpRequest httpRequest);

<span class=comment>/**
* Reset MockServer by clearing all expectations
*/</span>
<span class=keyword>public</span> MockServerClient reset();

<span class=comment>/**
* Clear all expectations that match the http
*
* <span class=javadoc_param_annotation>@param</span> <span class=javadoc_param_name>httpRequest</span> the http request that is matched against when deciding whether to clear each expectation
*                    if <span class=keyword>null</span> all expectations are cleared
*/</span>
<span class=keyword>public</span> MockServerClient clear(HttpRequest httpRequest);</code></pre>
<p>The ProxyClient has the following methods:</p>
<pre><code class=code><span class=comment>/**
* Start the client communicating to the proxy at the specified host and port
* for example:
*   ProxyClient mockServerClient = <span class=keyword>new</span> ProxyClient(<span class=string_literal>"localhost"</span>, <span class=numeric_literal>1080</span>);
*
* <span class=javadoc_param_annotation>@param</span> <span class=javadoc_param_name>host</span> the host for the proxy to communicate with
* <span class=javadoc_param_annotation>@param</span> <span class=javadoc_param_name>port</span> the port for the proxy to communicate with
*/</span>
<span class=keyword>public</span> ProxyClient(String host, <span class=keyword>int</span> port);

<span class=comment>/**
* Pretty-print the json for all requests / responses as Expectations to the log.
* They are printed into a dedicated log called <span class=annotation>mockserver_request.log</span>
*/</span>
<span class=keyword>public</span> ProxyClient dumpToLogAsJSON();

<span class=comment>/**
* Pretty-print the json for matching requests and their responses as Expectations to the log.
* They are printed into a dedicated log called <span class=annotation>mockserver_request.log</span>
*
* <span class=javadoc_param_annotation>@param</span> <span class=javadoc_param_name>httpRequest</span> the http request that is matched against when deciding what to log
*                    if <span class=keyword>null</span> all requests are logged
*/</span>
<span class=keyword>public</span> ProxyClient dumpToLogAsJSON(HttpRequest httpRequest);

<span class=comment>/**
* Output Java code for creating all requests / responses as Expectations to the log.
* They are printed into a dedicated log called <span class=annotation>mockserver_request.log</span>
*/</span>
<span class=keyword>public</span> ProxyClient dumpToLogAsJava();

<span class=comment>/**
* Output Java code for creating matching requests and their responses as Expectations to the log.
* They are printed into a dedicated log called <span class=annotation>mockserver_request.log</span>
*
* <span class=javadoc_param_annotation>@param</span> <span class=javadoc_param_name>httpRequest</span> the http request that is matched against when deciding what to log
*                    if <span class=keyword>null</span> all requests are logged
*/</span>
<span class=keyword>public</span> ProxyClient dumpToLogAsJava(HttpRequest httpRequest);

<span class=comment>/**
* Reset the proxy by clearing recorded requests
*/</span>
<span class=keyword>public</span> ProxyClient reset();

<span class=comment>/**
* Clear all recorded requests that match the httpRequest parameter
*
* <span class=javadoc_param_annotation>@param</span> <span class=javadoc_param_name>httpRequest</span> the http request that is matched against when deciding whether to clear recorded requests
*/</span>
<span class=keyword>public</span> ProxyClient clear(HttpRequest httpRequest);

<span class=comment>/**
* Verify a request has been sent for example:
*
*   <span class=this_value>mockServerClient</span>
*           .verify(
*                   request()
*                           .withPath(<span class=string_literal>"/some_path"</span>)
*                           .withBody(<span class=string_literal>"some_request_body"</span>)
*           );
*
* <span class=javadoc_param_annotation>@param</span> <span class=javadoc_param_name>httpRequest</span> the http request that must be matched for this verification to pass
* <span class=javadoc_param_annotation>@throws</span> <span class=javadoc_param_name>AssertionError</span> if the request has not been found
*/</span>
<span class=keyword>public</span> ProxyClient verify(HttpRequest httpRequest) <span class=keyword>throws</span> AssertionError;

<span class=comment>/**
* Verify a request has been sent for example:
*
*   <span class=this_value>mockServerClient</span>
*           .verify(
*                   request()
*                           .withPath(<span class=string_literal>"/some_path"</span>)
*                           .withBody(<span class=string_literal>"some_request_body"</span>),
*                   VerificationTimes.exactly(<span class=numeric_literal>3</span>)
*           );
*
* <span class=javadoc_param_annotation>@param</span> <span class=javadoc_param_name>httpRequest</span> the http request that must be matched for this verification to pass
* <span class=javadoc_param_annotation>@param</span> <span class=javadoc_param_name>times</span> the number of times this request must be matched
* <span class=javadoc_param_annotation>@throws</span> <span class=javadoc_param_name>AssertionError</span> if the request has not been found
*/</span>
<span class=keyword>public</span> ProxyClient verify(HttpRequest httpRequest, Times times) <span class=keyword>throws</span> AssertionError;

<span class=comment>/**
* Retrieve the recorded requests that match the httpRequest parameter as expectations
*
* <span class=javadoc_param_annotation>@param</span> <span class=javadoc_param_name>httpRequest</span> the http request that is matched against when deciding whether to return each expectation,
*                    use <span class=keyword>null</span> for the parameter to retrieve for all requests
* <span class=javadoc_param_annotation>@return</span> an array of all expectations that have been recorded by the proxy
*/</span>
<span class=keyword>public</span> Expectation[] retrieveAsExpectations(HttpRequest httpRequest);

<span class=comment>/**
* Retrieve the recorded requests that match the httpRequest parameter as a JSON array
*
* <span class=javadoc_param_annotation>@param</span> <span class=javadoc_param_name>httpRequest</span> the http request that is matched against when deciding whether to return each expectation,
*                    use <span class=keyword>null</span> for the parameter to retrieve for all requests
* <span class=javadoc_param_annotation>@return</span> a JSON array of all expectations that have been recorded by the proxy
*/</span>
<span class=keyword>public</span> String retrieveAsJSON(HttpRequest httpRequest);</code></pre>
<a name=create-expectations class=anchor href="#create-expectations">&nbsp;</a>
<h3>Create Expectations</h3>
<p>To create an expectation you need to define:</p>
<ul>
<li>the <a href="#request-matchers">request matcher</a> and</li>
<li>what <a href="#mock-response">response</a> should be returned or</li>
<li>what <a href="#callback">callback</a> should be executed or</li>
<li>where the request should be <a href="#mock-forward">forwarded</a>.</li>
</ul>
<p>MockServer will play expectations in the exact order they are setup. For example, if an expectation <span class=annotation>A</span> is setup to response (or forward) <strong>3</strong> times then expectation <span class=annotation>B</span> is setup to response (or forward)
<strong>2</strong> times for the same request MockServer will response (or forward) in the following order <span class=annotation>A</span>, <span class=annotation>A</span>, <span class=annotation>A</span>, <span class=annotation>B</span>, <span class=annotation>B</span>.</p>
<p><strong>Java</strong></p>
<p>To setup an expectation that responds to a request:</p>
<pre><code class=code><span class=keyword>new</span> MockServerClient(<span class=string_literal>"127.0.0.1"</span>, <span class=numeric_literal>8080</span>)
        .when(
                request()
                        .withMethod(<span class=string_literal>"POST"</span>)
                        .withPath(<span class=string_literal>"/login"</span>)
                        .withQueryStringParameters(
                                <span class=keyword>new</span> Parameter(<span class=string_literal>"returnUrl"</span>, <span class=string_literal>"/account"</span>)
                        )
                        .withCookies(
                                <span class=keyword>new</span> Cookie(<span class=string_literal>"sessionId"</span>, <span class=string_literal>"2By8LOhBmaW5nZXJwcmludCIlMDAzMW"</span>)
                        )
                        .withBody(exact(<span class=string_literal>"{username: 'foo', password: 'bar'}"</span>)),
                exactly(<span class=numeric_literal>1</span>)
        )
        .respond(
                response()
                        .withStatusCode(<span class=numeric_literal>401</span>)
                        .withHeaders(
                                <span class=keyword>new</span> Header(<span class=string_literal>"Content-Type"</span>, <span class=string_literal>"application/json; charset=utf-8"</span>),
                                <span class=keyword>new</span> Header(<span class=string_literal>"Cache-Control"</span>, <span class=string_literal>"public, max-age=86400"</span>)
                        )
                        .withBody(<span class=string_literal>"{ message: 'incorrect username and password combination' }"</span>)
                        .withDelay(<span class=keyword>new</span> Delay(<span class=constant>SECONDS</span>, <span class=numeric_literal>1</span>))
        );</code></pre>
<p>To setup an expectation that forwards to a request:</p>
<pre><code class=code><span class=keyword>new</span> MockServerClient(<span class=string_literal>"127.0.0.1"</span>, <span class=numeric_literal>8080</span>)
        .when(
                request()
                        .withMethod(<span class=string_literal>"GET"</span>)
                        .withPath(<span class=string_literal>"/index.html"</span>),
                exactly(<span class=numeric_literal>1</span>)
        )
        .forward(
                forward()
                        .withHost(<span class=string_literal>"www.mock-server.com"</span>)
                        .withPort(<span class=numeric_literal>80</span>)
                        .withScheme(<span class=constant>HTTP</span>)
        );</code></pre>
<p><strong>Note:</strong> this requires the use of these static imports as follows:</p>
<code class=code><span class=keyword>import static</span> org.mockserver.model.HttpRequest.request;
<span class=keyword>import static</span> org.mockserver.model.HttpResponse.response;
<span class=keyword>import static</span> org.mockserver.model.HttpForward.forward;
<span class=keyword>import static</span> org.mockserver.matchers.Times.exactly;
<span class=keyword>import static</span> java.util.concurrent.TimeUnit.SECONDS;
<span class=keyword>import static</span> org.mockserver.model.HttpForward.Scheme.HTTP;</code>
<p>The <a href="https://github.com/jamesdbloom/mockserver/tree/master/mockserver-examples">mockserver-example</a> project contains an example test called
<a href="https://github.com/jamesdbloom/mockserver/blob/master/mockserver-examples/src/test/java/org/mockserver/web/controller/BooksPageIntegrationTest.java">BookPageIntegrationTest</a> that demonstrates a fully working example.</p>
<a name=create-expectations-javascript class=anchor href="#create-expectations-javascript">&nbsp;</a>
<p><strong>JavaScript</strong></p>
<p>To setup an expectation that responds to a request:</p>
<pre><code class=code><span class=keyword>var</span> xmlHttpRequest = <span class=keyword>new</span> XMLHttpRequest();
xmlHttpRequest.open(<span class=string_literal>"PUT"</span>, <span class=string_literal>"http://localhost:8080/expectation"</span>, <span class=keyword>false</span>);
xmlHttpRequest.setRequestHeader(<span class=string_literal>"Content-Type"</span>, <span class=string_literal>"application/json; charset=utf-8"</span>);
xmlHttpRequest.send(JSON.stringify({
    <span class=string_literal>"httpRequest"</span>: {
        <span class=string_literal>"method"</span>: <span class=string_literal>"POST"</span>,
        <span class=string_literal>"path"</span>: <span class=string_literal>"/login"</span>,
        <span class=string_literal>"queryStringParameters"</span>: [
            {
                <span class=string_literal>"name"</span>: <span class=string_literal>"returnUrl"</span>,
                <span class=string_literal>"values"</span>: [<span class=string_literal>"/account"</span>]
            }
        ],
        <span class=string_literal>"cookies"</span>: [
            {
                <span class=string_literal>"name"</span>: <span class=string_literal>"sessionId"</span>,
                <span class=string_literal>"values"</span>: [<span class=string_literal>"2By8LOhBmaW5nZXJwcmludCIlMDAzMW"</span>]
            }
        ],
        <span class=string_literal>"body"</span>: {
            <span class=string_literal>"type"</span>: <span class=string_literal>"JSON"</span>,
            <span class=string_literal>"value"</span>: JSON.stringify({ username: <span class=string_literal>"foo"</span>, password: <span class=string_literal>"bar"</span> })
        }
    },
    <span class=string_literal>"httpResponse"</span>: {
        <span class=string_literal>"statusCode"</span>: <span class=numeric_literal>401</span>,
        <span class=string_literal>"headers"</span>: [
            {
                <span class=string_literal>"name"</span>: <span class=string_literal>"Content-Type"</span>,
                <span class=string_literal>"values"</span>: [<span class=string_literal>"application/json; charset=utf-8"</span>]
            },
            {
                <span class=string_literal>"name"</span>: <span class=string_literal>"Cache-Control"</span>,
                <span class=string_literal>"values"</span>: [<span class=string_literal>"public, max-age=86400"</span>]
            }
        ],
        <span class=string_literal>"body"</span>: JSON.stringify({ message: <span class=string_literal>"incorrect username and password combination"</span> }),
        <span class=string_literal>"delay"</span>: {
            <span class=string_literal>"timeUnit"</span>: <span class=string_literal>"SECONDS"</span>,
            <span class=string_literal>"value"</span>: <span class=numeric_literal>1</span>
        }
    },
    <span class=string_literal>"times"</span>: {
        <span class=string_literal>"remainingTimes"</span>: <span class=numeric_literal>1</span>,
        <span class=string_literal>"unlimited"</span>: <span class=keyword>false</span>
    }
}));
</code></pre>
<p>To setup an expectation that forwards to a request:</p>
<pre><code class=code><span class=keyword>var</span> xmlHttpRequest = <span class=keyword>new</span> XMLHttpRequest();
xmlHttpRequest.open(<span class=string_literal>"PUT"</span>, <span class=string_literal>"http://localhost:8080/expectation"</span>, <span class=keyword>false</span>);
xmlHttpRequest.setRequestHeader(<span class=string_literal>"Content-Type"</span>, <span class=string_literal>"application/json; charset=utf-8"</span>);
xmlHttpRequest.send(JSON.stringify({
    <span class=string_literal>"httpRequest"</span>: {
        <span class=string_literal>"method"</span>: <span class=string_literal>"GET"</span>,
        <span class=string_literal>"path"</span>: <span class=string_literal>"/index.html"</span>
    },
    <span class=string_literal>"httpForward"</span>: {
        <span class=string_literal>"host"</span>: <span class=string_literal>"www.mock-server.com"</span>,
        <span class=string_literal>"port"</span>: <span class=numeric_literal>80</span>,
        <span class=string_literal>"scheme"</span>: <span class=string_literal>"HTTP"</span>
    },
    <span class=string_literal>"times"</span>: {
        <span class=string_literal>"remainingTimes"</span>: <span class=numeric_literal>1</span>,
        <span class=string_literal>"unlimited"</span>: <span class=keyword>false</span>
    }
}));
</code></pre>
<a name=request-matchers class=anchor href="#request-matchers">&nbsp;</a>
<h3>Request Matcher</h3>
<p>To specify when a response should be mocked a request matcher must be provided in each expectation.</p>
<p>When an incoming request matches the request matcher in an expectation MockServer will return the response for that expectation.</p>
<p>Requests can be matched on:</p>
<ul>
<li><strong>path</strong> - regex or plain text</li>
<li><strong>query string</strong> - regex or plain text</li>
<li><strong>headers</strong> - regex or plain text</li>
<li><strong>cookies</strong> - regex or plain text</li>
<li><strong>body</strong> - XPath, json, regex, plain text (exact match), or body parameters</li>
</ul>
<p>The body can be matched using plain text, a json expression, an XPath expression or a regular expression, see <a href="http://saxon.sourceforge.net/saxon6.5.3/expressions.html">XPath Expression Syntax</a> for supported XPath syntax.</p>
<p>A json expressions is a valid json object. When a json expression is matched against a request body only fields in the json expression are matched, any extra fields in the request body not specified in the json expression will be ignored, in addition the order of fields in the body will be ignored.</p>
<p>All other matching can be done using plain text or a regular expression, see <a href="http://docs.oracle.com/javase/6/docs/api/java/util/regex/Pattern.html">Pattern (Java Platform SE 6)</a> for supported regular expression syntax.</p>
<p><strong>Java</strong></p>
<p>To specify a request matcher in Java use the <strong>org.mockserver.model.HttpRequest</strong> class which specifies the details of each HTTP response with a fluent API:</p>
<pre><code class=code><span class=keyword>public class</span> HttpRequest {

    <span class=comment>/**
     * The HTTP method to match on such as <span class=string_literal>"GET"</span> or <span class=string_literal>"POST"</span>
     *
     * <span class=javadoc_param_annotation>@param</span> <span class=javadoc_param_name>method</span> the HTTP method such as <span class=string_literal>"GET"</span> or <span class=string_literal>"POST"</span>
     */</span>
    <span class=keyword>public</span> HttpRequest withMethod(String method);

    <span class=comment>/**
     * The path to match on such as <span class=string_literal>"/some_mocked_path"</span> any servlet context path is ignored for matching and should not be specified here
     * regex values are also supported such as <span class=string_literal>".*_path"</span>, see <a href="http://docs.oracle.com/javase/6/docs/api/java/util/regex/Pattern.html">http://docs.oracle.com/javase/6/docs/api/java/util/regex/Pattern.html</a>
     * for full details of the supported regex syntax
     *
     * <span class=javadoc_param_annotation>@param</span> <span class=javadoc_param_name>path</span> the path such as <span class=string_literal>"/some_mocked_path"</span> or a regex
     */</span>
    <span class=keyword>public</span> HttpRequest withPath(String path);

    <span class=comment>/**
     * The query string parameters to match on as a list of Parameter objects where the values or keys of each parameter
     * can be either a string or a regex (for more details of the supported regex syntax
     * see <a href="http://docs.oracle.com/javase/6/docs/api/java/util/regex/Pattern.html">http://docs.oracle.com/javase/6/docs/api/java/util/regex/Pattern.html</a>)
     *
     * <span class=javadoc_param_annotation>@param</span> <span class=javadoc_param_name>parameters</span> the list of Parameter objects where the values or keys of each parameter can be either a string or a regex
     */</span>
    <span class=keyword>public</span> HttpRequest withQueryStringParameters(List&lt;Parameter&gt; parameters);

    <span class=comment>/**
     * The query string parameters to match on as a varags Parameter objects where the values or keys of each parameter
     * can be either a string or a regex (for more details of the supported regex syntax
     * see <a href="http://docs.oracle.com/javase/6/docs/api/java/util/regex/Pattern.html">http://docs.oracle.com/javase/6/docs/api/java/util/regex/Pattern.html</a>)
     *
     * <span class=javadoc_param_annotation>@param</span> <span class=javadoc_param_name>parameters</span> the varags Parameter objects where the values or keys of each parameter can be either a string or a regex
     */</span>
    <span class=keyword>public</span> HttpRequest withQueryStringParameters(Parameter... parameters);

    <span class=comment>/**
     * The query string parameters to match on as a Map&lt;String, List&lt;String&gt;&gt; where the values or keys of each parameter
     * can be either a string or a regex (for more details of the supported regex syntax
     * see <a href="http://docs.oracle.com/javase/6/docs/api/java/util/regex/Pattern.html">http://docs.oracle.com/javase/6/docs/api/java/util/regex/Pattern.html</a>)
     *
     * <span class=javadoc_param_annotation>@param</span> <span class=javadoc_param_name>parameters</span> the Map&lt;String, List&lt;String&gt;&gt; object where the values or keys of each parameter can be either a string or a regex
     */</span>
    <span class=keyword>public</span> HttpRequest withQueryStringParameters(Map&lt;String, List&lt;String&gt;&gt; parameters);

    <span class=comment>/**
     * Adds one query string parameter to match on as a Parameter object where the parameter values list can be a list of strings
     * or regular expressions (for more details of the supported regex syntax
     * see <a href="http://docs.oracle.com/javase/6/docs/api/java/util/regex/Pattern.html">http://docs.oracle.com/javase/6/docs/api/java/util/regex/Pattern.html</a>)
     *
     * <span class=javadoc_param_annotation>@param</span> <span class=javadoc_param_name>parameter</span> the Parameter object which can have a values list of strings or regular expressions
     */</span>
    <span class=keyword>public</span> HttpRequest withQueryStringParameter(Parameter parameter);

    <span class=comment>/**
     * The body to match on such as <span class=string_literal>"this is an exact string body"</span> or a json expression such as <span class=string_literal>"{username: 'foo', password: 'bar'}"</span> or a regex
     * (see <a href="http://docs.oracle.com/javase/6/docs/api/java/util/regex/Pattern.html">http://docs.oracle.com/javase/6/docs/api/java/util/regex/Pattern.html</a>)
     * or an XPath expression which returns one or more values or evaluates to true
     * (see <a href="http://saxon.sourceforge.net/saxon6.5.3/expressions.html">http://saxon.sourceforge.net/saxon6.5.3/expressions.html</a>)
     *
     * <span class=javadoc_param_annotation>@param</span> <span class=javadoc_param_name>body</span> the body on such as <span class=string_literal>"this is an exact string body"</span>
     *             or a regex such as <span class=string_literal>"username[a-z]{4}"</span>
     *             or a json expression such as <span class=string_literal>"{username: 'foo', password: 'bar'}"</span>
     *             or an XPath such as <span class=string_literal>"/element[key = 'some_key' and value = 'some_value']"</span>
     */</span>
    <span class=keyword>public</span> HttpRequest withBody(String body);

    <span class=comment>/**
     * The body match rules on such as using one of the Body subclasses as follows:
     *
     * exact string match:
     *   - exact(<span class=string_literal>"this is an exact string body"</span>); or
     *   - <span class=keyword>new</span> StringBody(<span class=string_literal>"this is an exact string body"</span>)
     *
     * exact match:
     *   - regex(<span class=string_literal>"username[a-z]{4}"</span>); or
     *   - <span class=keyword>new</span> StringBody(<span class=string_literal>"username[a-z]{4}"</span>, Body.Type.<span class=constant>REGEX</span>);
     *
     * json match:
     *   - json(<span class=string_literal>"{username: 'foo', password: 'bar'}"</span>); or
     *   - <span class=keyword>new</span> StringBody(<span class=string_literal>"{username: 'foo', password: 'bar'}"</span>, Body.Type.<span class=constant>JSON</span>);
     *
     * xpath match:
     *   - xpath(<span class=string_literal>"/element[key = 'some_key' and value = 'some_value']"</span>); or
     *   - <span class=keyword>new</span> StringBody(<span class=string_literal>"/element[key = 'some_key' and value = 'some_value']"</span>, Body.Type.<span class=constant>XPATH</span>);
     *
     * body parameter match:
     *   - params(
     *             param(<span class=string_literal>"name_one"</span>, <span class=string_literal>"value_one_one"</span>, <span class=string_literal>"value_one_two"</span>)
     *             param(<span class=string_literal>"name_two"</span>, <span class=string_literal>"value_two"</span>)
     *     ); or
     *   - <span class=keyword>new</span> ParameterBody(
     *             <span class=keyword>new</span> Parameter(<span class=string_literal>"name_one"</span>, <span class=string_literal>"value_one_one"</span>, <span class=string_literal>"value_one_two"</span>)
     *             <span class=keyword>new</span> Parameter(<span class=string_literal>"name_two"</span>, <span class=string_literal>"value_two"</span>)
     *     );
     *
     * binary match:
     *   - binary(IOUtils.readFully(getClass().getClassLoader().getResourceAsStream(<span class=string_literal>"example.pdf"</span>), <span class=numeric_literal>1024</span>)); or
     *   - new BinaryBody(IOUtils.readFully(getClass().getClassLoader().getResourceAsStream(<span class=string_literal>"example.pdf"</span>), <span class=numeric_literal>1024</span>));
     *
     * for more details of the supported regex syntax see <a href="http://docs.oracle.com/javase/6/docs/api/java/util/regex/Pattern.html">http://docs.oracle.com/javase/6/docs/api/java/util/regex/Pattern.html</a>
     * for more details of the supported json syntax see <a href="http://jsonassert.skyscreamer.org">http://jsonassert.skyscreamer.org</a>
     * for more detail of XPath syntax see <a href="http://saxon.sourceforge.net/saxon6.5.3/expressions.html">http://saxon.sourceforge.net/saxon6.5.3/expressions.html</a>
     *
     * <span class=javadoc_param_annotation>@param</span> <span class=javadoc_param_name>body</span> an instance of one of the Body subclasses including StringBody or ParameterBody
     */</span>
    <span class=keyword>public</span> HttpRequest withBody(Body body);

    <span class=comment>/**
     * The headers to match on as a list of Header objects where the values or keys of each header can be either a string or a regex
     * (for more details of the supported regex syntax see <a href="http://docs.oracle.com/javase/6/docs/api/java/util/regex/Pattern.html">http://docs.oracle.com/javase/6/docs/api/java/util/regex/Pattern.html</a>)
     *
     * <span class=javadoc_param_annotation>@param</span> <span class=javadoc_param_name>headers</span> the list of Header objects where the values or keys of each header can be either a string or a regex
     */</span>
    <span class=keyword>public</span> HttpRequest withHeaders(List&lt;Header&gt; headers);
    <span class=comment>/**
     * The headers to match on as a varags of Header objects  where the values or keys of each header can be either a string or a regex
     * (for more details of the supported regex syntax see <a href="http://docs.oracle.com/javase/6/docs/api/java/util/regex/Pattern.html">http://docs.oracle.com/javase/6/docs/api/java/util/regex/Pattern.html</a>)
     *
     * <span class=javadoc_param_annotation>@param</span> <span class=javadoc_param_name>headers</span> the varags of Header objects where the values or keys of each header can be either a string or a regex
     */</span>
    <span class=keyword>public</span> HttpRequest withHeaders(Header... headers);

    <span class=comment>/**
     * Adds one header to match on as a Header object where the header values list can be a list of strings or regular expressions
     * (for more details of the supported regex syntax see <a href="http://docs.oracle.com/javase/6/docs/api/java/util/regex/Pattern.html">http://docs.oracle.com/javase/6/docs/api/java/util/regex/Pattern.html</a>)
     *
     * <span class=javadoc_param_annotation>@param</span> <span class=javadoc_param_name>header</span> the Header object which can have a values list of strings or regular expressions
     */</span>
    <span class=keyword>public</span> HttpRequest withHeader(Header header);

    <span class=comment>/**
     * The cookies to match on as a list of Cookie objects  where the values or keys of each cookie can be either a string or a regex
     * (for more details of the supported regex syntax see <a href="http://docs.oracle.com/javase/6/docs/api/java/util/regex/Pattern.html">http://docs.oracle.com/javase/6/docs/api/java/util/regex/Pattern.html</a>)
     *
     * <span class=javadoc_param_annotation>@param</span> <span class=javadoc_param_name>cookies</span> the list of Cookie objects where the values or keys of each cookie can be either a string or a regex
     */</span>
    <span class=keyword>public</span> HttpRequest withCookies(List&lt;Cookie&gt; cookies);
    <span class=comment>/**
     * The cookies to match on as a varags Cookie objects where the values or keys of each cookie can be either a string or a regex
     * (for more details of the supported regex syntax see <a href="http://docs.oracle.com/javase/6/docs/api/java/util/regex/Pattern.html">http://docs.oracle.com/javase/6/docs/api/java/util/regex/Pattern.html</a>)
     *
     * <span class=javadoc_param_annotation>@param</span> <span class=javadoc_param_name>cookies</span> the varags Cookie objects where the values or keys of each cookie can be either a string or a regex
     */</span>
    <span class=keyword>public</span> HttpRequest withCookies(Cookie... cookies);

    <span class=comment>/**
     * Adds one cookie to match on as a Cookie object where the cookie values list can be a list of strings or regular expressions
     * (for more details of the supported regex syntax see <a href="http://docs.oracle.com/javase/6/docs/api/java/util/regex/Pattern.html">http://docs.oracle.com/javase/6/docs/api/java/util/regex/Pattern.html</a>)
     *
     * <span class=javadoc_param_annotation>@param</span> <span class=javadoc_param_name>cookie</span> the Cookie object which can have a values list of strings or regular expressions
     */</span>
    <span class=keyword>public</span> HttpRequest withCookie(Cookie cookie);
}</code></pre>
<p>For example:</p>
<pre><code class=code>HttpRequest httpRequest =
        request()
                .withMethod(<span class=string_literal>"POST"</span>)
                .withPath(<span class=string_literal>"/login"</span>)
                .withBody(<span class=string_literal>"{username: 'foo', password: 'bar'}"</span>)
                .withQueryStringParameters(
                        <span class=keyword>new</span> Parameter(<span class=string_literal>"returnUrl"</span>, <span class=string_literal>"/account"</span>)
                )
                .withCookies(
                        <span class=keyword>new</span> Cookie(<span class=string_literal>"sessionId"</span>, <span class=string_literal>"2By8LOhBmaW5nZXJwcmludCIlMDAzMW"</span>)
                );</code></pre>
<p><strong>JavaScript</strong></p>
<p>To specify a request matcher in javascript use JSON to specify the details with the following format: </p>
<pre><code class=code><span class=string_literal>"httpRequest"</span>: {
    <span class=string_literal>"method"</span>: <span class=string_literal>""</span>,
    <span class=string_literal>"path"</span>: <span class=string_literal>""</span>,
    <span class=string_literal>"queryParameters"</span>: []
    <span class=string_literal>"body"</span>: {
       <span class=string_literal>"type"</span>: <span class=annotation>&lt;</span><span class=string_literal>"STRING"</span> <span class=annotation>or</span> <span class=string_literal>"REGEX"</span> <span class=annotation>or</span> <span class=string_literal>"JSON"</span> <span class=annotation>or</span> <span class=string_literal>"XPATH"</span> <span class=annotation>or</span> <span class=string_literal>"PARAMETERS"</span><span class=annotation>&gt;</span>,
       <span class=string_literal>"value"</span>: <span class=string_literal>""</span> <span class=annotation>( or</span> <span class=string_literal>"parameters"</span> <span class=annotation>as shown in more detail below )</span>
    },
    <span class=string_literal>"cookies"</span>: [],
    <span class=string_literal>"headers"</span>: [],
}</code></pre>
<p><strong>Note:</strong> Only values which are matched on need to be specified, if a value is missing then it will not be matched on. For example, below both the parameters and headers fields are not specified.</p>
<p>Each cookie, header or parameter array entry has the following syntax:</p>
<pre><code class=code>{
    <span class=string_literal>"name"</span>: <span class=string_literal>"someName"</span>,
    <span class=string_literal>"values"</span>: [<span class=string_literal>"someValueOne"</span>, <span class=string_literal>"someValueTwo"</span>, ...]
}</code></pre>
<p>The same example, as in Java above, in JavaScript would be :</p>
<pre><code class=code><span class=string_literal>"httpRequest"</span>: {
    <span class=string_literal>"method"</span>: <span class=string_literal>"POST"</span>,
    <span class=string_literal>"path"</span>: <span class=string_literal>"/login"</span>,
    <span class=string_literal>"queryStringParameters"</span>: [
        {
            <span class=string_literal>"name"</span>: <span class=string_literal>"returnUrl"</span>,
            <span class=string_literal>"values"</span>: [<span class=string_literal>"/account"</span>]
        }
    ],
    <span class=string_literal>"cookies"</span>: [
        {
            <span class=string_literal>"name"</span>: <span class=string_literal>"sessionId"</span>,
            <span class=string_literal>"values"</span>: [<span class=string_literal>"2By8LOhBmaW5nZXJwcmludCIlMDAzMW"</span>]
        }
    ],
    <span class=string_literal>"body"</span>: {
        <span class=string_literal>"type"</span>: <span class=string_literal>"STRING"</span>,
        <span class=string_literal>"value"</span>: <span class=string_literal>"{username: 'foo', password: 'bar'}"</span>
    }
}</code></pre>
<p>The <span class=string_literal>"type"</span> value in <span class=string_literal>"body"</span> can be:</p>
<pre><code class=code><span class=string_literal>"STRING"</span>
<span class=string_literal>"REGEX"</span>
<span class=string_literal>"JSON"</span>
<span class=string_literal>"XPATH"</span>
<span class=string_literal>"PARAMETERS"</span></code></pre>
<p>When the <span class=string_literal>"type"</span> field has a value of <span class=string_literal>"STRING"</span>, <span class=string_literal>"REGEX"</span>, <span class=string_literal>"JSON"</span> or <span class=string_literal>"XPATH"</span> the other field of
<span class=string_literal>"body"</span>" should be <span class=string_literal>"value"</span> and it should provide a string to perform the match against, as shown in the example above.</p>
<p>When the <span class=string_literal>"type"</span> field has a value of <span class=string_literal>"PARAMETERS"</span> the other field of <span class=string_literal>"body"</span> should be
<span class=string_literal>"parameters"</span> and it should provide a list of body parameters using the following syntax:</p>
<pre><code class=code>{
    <span class=string_literal>"name"</span>: <span class=string_literal>"someName"</span>,
    <span class=string_literal>"values"</span>: [<span class=string_literal>"someValueOne"</span>, <span class=string_literal>"someValueTwo"</span>, ...]
}</code></pre>
<p>For example:</p>
<pre><code class=code><span class=string_literal>"httpRequest"</span>: {
    <span class=string_literal>"method"</span>: <span class=string_literal>"POST"</span>,
    <span class=string_literal>"path"</span>: <span class=string_literal>"/login"</span>,
    <span class=string_literal>"queryStringParameters"</span>: [
        {
            <span class=string_literal>"name"</span>: <span class=string_literal>"returnUrl"</span>,
            <span class=string_literal>"values"</span>: [<span class=string_literal>"/account"</span>]
        }
    ],
    <span class=string_literal>"cookies"</span>: [
        {
            <span class=string_literal>"name"</span>: <span class=string_literal>"sessionId"</span>,
            <span class=string_literal>"values"</span>: [<span class=string_literal>"2By8LOhBmaW5nZXJwcmludCIlMDAzMW"</span>]
        }
    ],
    <span class=string_literal>"body"</span>: {
        <span class=string_literal>"type"</span>: <span class=string_literal>"PARAMETERS"</span>,
        <span class=string_literal>"parameters"</span>: [
            {
                <span class=string_literal>"name"</span>: <span class=string_literal>"username"</span>,
                <span class=string_literal>"values"</span>: [<span class=string_literal>"foo"</span>]
            },
            {
                <span class=string_literal>"name"</span>: <span class=string_literal>"password"</span>,
                <span class=string_literal>"values"</span>: [<span class=string_literal>"bar"</span>]
            }
        ]
    }
}</code></pre>
<p>When the <span class=string_literal>"type"</span> field has a value of <span class=string_literal>"STRING"</span> a short hand can be used where the <span class=string_literal>"body"</span> is only specified as a string literal for example:</p>
<pre><code class=code><span class=string_literal>"httpRequest"</span>: {
    <span class=string_literal>"method"</span>: <span class=string_literal>"POST"</span>,
    <span class=string_literal>"path"</span>: <span class=string_literal>"/login"</span>,
    <span class=string_literal>"queryStringParameters"</span>: [
        {
            <span class=string_literal>"name"</span>: <span class=string_literal>"returnUrl"</span>,
            <span class=string_literal>"values"</span>: [<span class=string_literal>"/account"</span>]
        }
    ],
    <span class=string_literal>"cookies"</span>: [
        {
            <span class=string_literal>"name"</span>: <span class=string_literal>"sessionId"</span>,
            <span class=string_literal>"values"</span>: [<span class=string_literal>"2By8LOhBmaW5nZXJwcmludCIlMDAzMW"</span>]
        }
    ],
    <span class=string_literal>"body"</span>: <span class=string_literal>"a string body showing the short-hand way to specify a simple string body"</span>
}</code></pre>
<p><strong>Times</strong></p>
<p>The org.mockserver.matchers.Times class is used to specify how many times you want MockServer to match a request:</p>
<p>To create an instance of Times use one of the static factory methods:</p>
<pre><code class=code>Times.unlimited();
Times.once();
Times.exactly(<span class=keyword>int</span> count);</code></pre>
<a name=mock-response class=anchor href="#mock-response">&nbsp;</a>
<h3>Mock Responses</h3>
<p>Response actions contain:</p>
<ul>
<li><strong>status code</strong> i.e. 200, 302, 404, etc</li>
<li><strong>body</strong> - a UTF-8 encoded sequence of bytes containing any content</li>
<li><strong>headers</strong> - each with a name and one or more values</li>
<li><strong>cookies</strong> - each with a name and with one or more values, more complex cookies can be modelled by using the a Set-Cookie header</li>
</ul>
<p>Responses can be further controlled using:</p>
<ul>
<li>a delay before the response is sent</li>
<li>the number of times the response is sent (including unlimited)</li>
</ul>
<p><strong>Java</strong></p>
<p>To mock a response in Java use the <strong>org.mockserver.model.HttpResponse</strong> class which specifies the details of each HTTP response with a fluent API:</p>
<pre><code class=code><span class=keyword>public class</span> HttpResponse {

    <span class=comment>/**
     * The status code to return, such as <span class=numeric_literal>200</span>, <span class=numeric_literal>404</span>, the status code specified
     * here will result in the default status message for this status code for
     * example for <span class=numeric_literal>200</span> the status message <span class=string_literal>"OK"</span> is used
     *
     * <span class=javadoc_param_annotation>@param</span> <span class=javadoc_param_name>statusCode</span> an integer such as <span class=numeric_literal>200</span> or <span class=numeric_literal>404</span>
     */</span>
    <span class=keyword>public</span> HttpResponse withStatusCode(Integer responseCode);

    <span class=comment>/**
     * The cookies to return as Set-Cookie headers as a list of Cookie objects
     *
     * <span class=javadoc_param_annotation>@param</span> <span class=javadoc_param_name>cookies</span> a list of Cookie objects
     */</span>
    <span class=keyword>public</span> HttpResponse withCookies(List&lt;Cookie&gt; cookies);
    <span class=comment>/**
     * The cookies to return as Set-Cookie headers as a varargs of Cookie objects
     *
     * <span class=javadoc_param_annotation>@param</span> <span class=javadoc_param_name>cookies</span> a varargs of Cookie objects
     */</span>
    <span class=keyword>public</span> HttpResponse withCookies(Cookie... cookies);

    <span class=comment>/**
     * Add cookie to return as Set-Cookie header
     *
     * <span class=javadoc_param_annotation>@param</span> <span class=javadoc_param_name>cookie</span> a Cookie object
     */</span>
    <span class=keyword>public</span> HttpResponse withCookie(Cookie cookie);

    <span class=comment>/**
     * The headers to return as a list of Header objects
     *
     * <span class=javadoc_param_annotation>@param</span> <span class=javadoc_param_name>headers</span> a list of Header objects
     */</span>
    <span class=keyword>public</span> HttpResponse withHeaders(List&lt;Header&gt; headers);
    <span class=comment>/**
     * The headers to return as a varargs of Header objects
     *
     * <span class=javadoc_param_annotation>@param</span> <span class=javadoc_param_name>headers</span> a varargs of Header objects
     */</span>
    <span class=keyword>public</span> HttpResponse withHeaders(Header... headers);

    <span class=comment>/**
     * A header to return as a Header objects
     *
     * <span class=javadoc_param_annotation>@param</span> <span class=javadoc_param_name>header</span> a Header objects
     */</span>
    <span class=keyword>public</span> HttpResponse withHeader(Header header)

    <span class=comment>/**
     * Set response body to return as a simple UTF-8 string response body
     *
     * <span class=javadoc_param_annotation>@param</span> <span class=javadoc_param_name>body</span> a <span class=string_literal>"UTF-8"</span> string
     */</span>
    <span class=keyword>public</span> HttpResponse withBody(String body);

    <span class=comment>/**
     * * Set response body to return as binary such as a pdf or image
     *
     * <span class=javadoc_param_annotation>@param</span> <span class=javadoc_param_name>body</span> a byte array
     */</span>
    <span class=keyword>public</span> HttpResponse withBody(<span class=keyword>byte</span>[] body);

    <span class=comment>/**
     * Set the body to return for example:
     *
     * string body:
     *   - exact(<span class=string_literal>"&lt;html&gt;&lt;head/&gt;&lt;body&gt;&lt;div&gt;a simple string body&lt;/div&gt;&lt;/body&gt;&lt;/html&gt;"</span>); or
     *   - new StringBody(<span class=string_literal>"&lt;html&gt;&lt;head/&gt;&lt;body&gt;&lt;div&gt;a simple string body&lt;/div&gt;&lt;/body&gt;&lt;/html&gt;"</span>)
     *
     * binary body:
     *   - binary(IOUtils.readFully(getClass().getClassLoader().getResourceAsStream(<span class=string_literal>"example.pdf"</span>), <span class=numeric_literal>1024</span>)); or
     *   - new BinaryBody(IOUtils.readFully(getClass().getClassLoader().getResourceAsStream(<span class=string_literal>"example.pdf"</span>), <span class=numeric_literal>1024</span>));
     *
     * <span class=javadoc_param_annotation>@param</span> <span class=javadoc_param_name>body</span> an instance of one of the Body subclasses including StringBody or BinaryBody
     */</span>
    <span class=keyword>public</span> HttpResponse withBody(Body body);

    <span class=comment>/**
     * The delay before responding with this request as a Delay object, for example <span class=keyword>new</span> Delay(TimeUnit.<span class=constant>SECONDS</span>, <span class=numeric_literal>3</span>)
     *
     * <span class=javadoc_param_annotation>@param</span> <span class=javadoc_param_name>delay</span> a Delay object, for example <span class=keyword>new</span> Delay(TimeUnit.<span class=constant>SECONDS</span>, <span class=numeric_literal>3</span>)
     */</span>
    <span class=keyword>public</span> HttpResponse withDelay(Delay delay);
}</code></pre>
<p>For example:</p>
<pre><code class=code>HttpResponse httpResponse =
        response()
                .withStatusCode(<span class=numeric_literal>401</span>)
                .withHeaders(
                        <span class=keyword>new</span> Header(<span class=string_literal>"Content-Type"</span>, <span class=string_literal>"application/json; charset=utf-8"</span>),
                        <span class=keyword>new</span> Header(<span class=string_literal>"Cache-Control"</span>, <span class=string_literal>"public, max-age=86400"</span>)
                )
                .withBody(<span class=string_literal>"{ message: 'incorrect username and password combination' }"</span>)
                .withDelay(<span class=keyword>new</span> Delay(TimeUnit.<span class=constant>SECONDS</span>, <span class=numeric_literal>1</span>));
</code></pre>
<p><strong>JavaScript</strong></p>
<p>To mock a response in javascript use JSON to specify the details with the following format: </p>
<pre><code class=code><span class=string_literal>"httpResponse"</span>: {
    <span class=string_literal>"statusCode"</span>: <span class=numeric_literal>200</span>,
    <span class=string_literal>"body"</span>: <span class=string_literal>""</span>,
    <span class=string_literal>"cookies"</span>: [],
    <span class=string_literal>"headers"</span>: [],
    <span class=string_literal>"delay"</span>: {
        <span class=string_literal>"timeUnit"</span>: <span class=string_literal>"MICROSECONDS"</span>,
        <span class=string_literal>"value"</span>: <span class=numeric_literal>0</span>
    }
}
</code></pre>
<p>Each cookie or header array entry has the following syntax:</p>
<pre><code class=code>{
    <span class=string_literal>"name"</span>: <span class=string_literal>"someName"</span>,
    <span class=string_literal>"values"</span>: [<span class=string_literal>"someValueOne"</span>, <span class=string_literal>"someValueTwo"</span>, ...]
}</code></pre>
<p>The "timeUnit" value in "delay" can be:</p>
<pre><code class=code><span class=string_literal>"NANOSECONDS"</span>
<span class=string_literal>"MICROSECONDS"</span>
<span class=string_literal>"MILLISECONDS"</span>
<span class=string_literal>"SECONDS"</span>
<span class=string_literal>"MINUTES"</span>
<span class=string_literal>"HOURS"</span>
<span class=string_literal>"DAYS"</span></code></pre>
<p>The same example as above would be:</p>
<pre><code class=code><span class=string_literal>"httpResponse"</span>: {
    <span class=string_literal>"statusCode"</span>: <span class=numeric_literal>401</span>,
    <span class=string_literal>"headers"</span>: [
        {
            <span class=string_literal>"name"</span>: <span class=string_literal>"Content-Type"</span>,
            <span class=string_literal>"values"</span>: [<span class=string_literal>"application/json; charset=utf-8"</span>]
        },
        {
            <span class=string_literal>"name"</span>: <span class=string_literal>"Cache-Control"</span>,
            <span class=string_literal>"values"</span>: [<span class=string_literal>"public, max-age=86400"</span>]
        }
    ],
    <span class=string_literal>"body"</span>: JSON.stringify({ message: <span class=string_literal>"incorrect username and password combination"</span> }),
    <span class=string_literal>"delay"</span>: {
        <span class=string_literal>"timeUnit"</span>: <span class=string_literal>"SECONDS"</span>,
        <span class=string_literal>"value"</span>: <span class=numeric_literal>1</span>
    }
}</code></pre>
<a name=mock-forward class=anchor href="#mock-forward">&nbsp;</a>
<h3>Mock Forward</h3>
<p>Forward actions contain:</p>
<ul>
<li><strong>host</strong> - the host to forward to i.e. www.mock-server.com</li>
<li><strong>port</strong> - the port to forward to, this defaults to 80 if not specified</li>
<li><strong>scheme</strong> - the scheme to use, either HTTP or HTTPS, this defaults to HTTP if not specified</li>
</ul>
<p>Forward can be further controlled using:</p>
<ul>
<li>the number of times the request is forwarded (including unlimited)</li>
</ul>
<p><strong>Java</strong></p>
<p>To setup a forward in Java use the <strong>org.mockserver.model.HttpForward</strong> class which specifies the details of each HTTP(S) forward with a fluent API:</p>
<pre><code class=code><span class=keyword>public class</span> HttpForward {

    <span class=comment>/**
     * The host or ip address to forward the request to i.e. <span class=string_literal>"www.mock-server.com"</span>
     *
     * <span class=javadoc_param_annotation>@param</span> <span class=javadoc_param_name>host</span> a hostname or ip address as a string
     */</span>
    <span class=keyword>public</span> HttpForward withHost(String host);

    <span class=comment>/**
     * The port to forward the request to i.e. <span class=numeric_literal>80</span>.  If not specified the port defaults to <span class=numeric_literal>80</span>.
     *
     * <span class=javadoc_param_annotation>@param</span> <span class=javadoc_param_name>port</span> a port as an integer
     */</span>
    <span class=keyword>public</span> HttpForward withPort(Integer port);

    <span class=comment>/**
     * The scheme to use when forwarded the request, either <span class=constant>HTTP</span> or <span class=constant>HTTPS</span>.  If not specified the scheme defaults to HTTP.
     *
     * <span class=javadoc_param_annotation>@param</span> <span class=javadoc_param_name>scheme</span> the scheme as a HttpForward.Scheme value
     */</span>
    <span class=keyword>public</span> HttpForward withScheme(Scheme scheme);
}</code></pre>
<p>For example:</p>
<pre><code class=code>HttpForward httpForward =
        forward()
                .withHost(<span class=string_literal>"www.mock-server.com"</span>)
                .withPort(<span class=numeric_literal>80</span>)
                .withScheme(HttpForward.Scheme.<span class=constant>HTTP</span>);
</code></pre>
<p><strong>JavaScript</strong></p>
<p>To mock a response in javascript use JSON to specify the details with the following format: </p>
<pre><code class=code><span class=string_literal>"httpForward"</span>: {
    <span class=string_literal>"host"</span>: <span class=string_literal>""</span>,
    <span class=string_literal>"port"</span>: <span class=numeric_literal>80</span>,
    <span class=string_literal>"scheme"</span>: <span class=string_literal>"HTTP"</span>
}
</code></pre>
<p>The "scheme" value in can be:</p>
<pre><code class=code><span class=string_literal>"HTTP"</span>
<span class=string_literal>"HTTPS"</span></code></pre>
<p>The same example as above would be:</p>
<pre><code class=code><span class=string_literal>"httpForward"</span>: {
    <span class=string_literal>"host"</span>: <span class=string_literal>"www.mock-server.com"</span>,
    <span class=string_literal>"port"</span>: <span class=numeric_literal>80</span>,
    <span class=string_literal>"scheme"</span>: <span class=string_literal>"HTTP"</span>
}
</code></pre>
<a name=callback class=anchor href="#callback">&nbsp;</a>
<h3>Callback</h3>
<p>A callback specifies a class that will be called for each matching request and can be used to dynamically generate the response.<p>
<p>Callback actions contain:</p>
<ul>
<li><strong>callbackClass</strong></li>
</ul>
<p>The callback class must:</p>
<ul>
<li>have a default constructor</li>
<li>implement <strong>org.mockserver.mock.action.ExpectationCallback</strong></li>
<li>be available on the classpath (see below)</li>
</ul>
<strong>Classpath Visibility</strong>
<p>If MockServer is started using the JUnitRule <strong>org.mockserver.junit.MockServerRule</strong> or using <strong>org.mockserver.integration.ClientAndServer</strong> or directly using the <strong>org.mockserver.mockserver.MockServerBuilder</strong> then any class present in the main or test classpaths will be visible to MockServer.</p>
<p>If MockServer is started using the plugin only the non-forked goals (such as <span class=element_value>runAndWait</span> and <span class=element_value>start</span>) will be able to load classes from the main and test classpaths. It is possible to use classes from a separate maven dependency, however, this dependency must be specified in the plugin configuration <span class=element>dependencies</span> section. Any dependency added to the plugin configuration <span class=element>dependencies</span> section will then be visible to MockServer run using both forked and non-forked goals.</p>
<p>The following configuration shows how to use classes from a separate maven dependency in callback actions.</p>
<pre><code class="code xml"> &lt;<span class=element>plugin</span>&gt;
     &lt;<span class=element>groupId</span>&gt;<span class=element_value>org.mock-server</span>&lt;/<span class=element>groupId</span>&gt;
     &lt;<span class=element>artifactId</span>&gt;<span class=element_value>mockserver-maven-plugin</span>&lt;/<span class=element>artifactId</span>&gt;
     &lt;<span class=element>version</span>&gt;<span class=element_value>3.9.8</span>&lt;/<span class=element>version</span>&gt;
     &lt;<span class=element>configuration</span>&gt;
        &lt;<span class=element>serverPort</span>&gt;<span class=element_value>1080</span>&lt;/<span class=element>serverPort</span>&gt;
        &lt;<span class=element>logLevel</span>&gt;<span class=element_value>DEBUG</span>&lt;/<span class=element>logLevel</span>&gt;
        &lt;<span class=element>pipeLogToConsole</span>&gt;<span class=element_value>true</span>&lt;/<span class=element>pipeLogToConsole</span>&gt;
     &lt;/<span class=element>configuration</span>&gt;
     &lt;<span class=element>executions</span>&gt;
         &lt;<span class=element>execution</span>&gt;
             &lt;<span class=element>id</span>&gt;<span class=element_value>pre-integration-test</span>&lt;/<span class=element>id</span>&gt;
             &lt;<span class=element>phase</span>&gt;<span class=element_value>pre-integration-test</span>&lt;/<span class=element>phase</span>&gt;
             &lt;<span class=element>goals</span>&gt;
                 &lt;<span class=element>goal</span>&gt;<span class=element_value>runForked</span>&lt;/<span class=element>goal</span>&gt;
             &lt;/<span class=element>goals</span>&gt;
         &lt;/<span class=element>execution</span>&gt;
         &lt;<span class=element>execution</span>&gt;
             &lt;<span class=element>id</span>&gt;<span class=element_value>post-integration-test</span>&lt;/<span class=element>id</span>&gt;
             &lt;<span class=element>phase</span>&gt;<span class=element_value>post-integration-test</span>&lt;/<span class=element>phase</span>&gt;
             &lt;<span class=element>goals</span>&gt;
                 &lt;<span class=element>goal</span>&gt;<span class=element_value>stopForked</span>&lt;/<span class=element>goal</span>&gt;
             &lt;/<span class=element>goals</span>&gt;
         &lt;/<span class=element>execution</span>&gt;
     &lt;/<span class=element>executions</span>&gt;
     &lt;<span class=element>dependencies</span>&gt;
         &lt;<span class=element>dependency</span>&gt;
             &lt;<span class=element>groupId</span>&gt;<span class=element_value>com.my-domain</span>&lt;/<span class=element>groupId</span>&gt;
             &lt;<span class=element>artifactId</span>&gt;<span class=element_value>my-callback-dependency</span>&lt;/<span class=element>artifactId</span>&gt;
             &lt;<span class=element>version</span>&gt;<span class=element_value>1.0.0</span>&lt;/<span class=element>version</span>&gt;
         &lt;/<span class=element>dependency</span>&gt;
     &lt;/<span class=element>dependencies</span>&gt;
 &lt;/<span class=element>plugin</span>&gt;</code></pre>
<p>If MockServer is started using the command line then the callback classes must be added to the JVM using the classpath command line switch (<strong>cp</strong> or <strong>classpath</strong>). The <strong>classpath</strong> switch is ignored by the JVM if the <strong>jar</strong> switch is used. So to run the MockServer from the command line directly (with mockserver-netty-3.9.8-jar-with-dependencies.jar) you must specify the <strong>org.mockserver.cli.Main</strong> main class specifically and not use the <strong>jar</strong> switch as follows.</p>
<pre><code class=code>java -Dfile.encoding=UTF-8 -cp mockserver-netty-3.9.8-jar-with-dependencies.jar:my-callback-dependency.jar org.mockserver.cli.Main -serverPort 1080</code></pre>
<p><strong>Java</strong></p>
<p>To setup a callback in Java use the <strong>org.mockserver.model.HttpCallback</strong> class which specifies the details class to callback as follows:</p>
<pre><code class=code><span class=keyword>public class</span> HttpCallback {

    <span class=comment>/**
     * The class to callback as a fully qualified class name
     *
     * This calls must:
     *  - implement org.mockserver.mock.action.ExpectationCallback
     *  - have a zero argument constructor
     *  - be available in the classpath of the MockServer
     *
     * <span class=javadoc_param_annotation>@param</span> <span class=javadoc_param_name>callbackClass</span> class to callback as a fully qualified class name, i.e. <span class=string_literal>"com.foo.MyExpectationCallback"</span>
     */</span>
    <span class=keyword>public</span> HttpCallback withCallbackClass(String callbackClass);

}</code></pre>
<p>The class specified must implement the <strong>org.mockserver.mock.action.ExpectationCallback</strong> interface as follows:</p>
<pre><code class=code><span class=keyword>public interface</span> ExpectationCallback {

    <span class=comment>/**
     * Called for every request when expectation condition has been satisfied.
     * The request that satisfied the expectation condition is passed as the
     * parameter and the return value is the response that will be returned to the client.
     *
     * <span class=javadoc_param_annotation>@param</span> <span class=javadoc_param_name>httpRequest</span> the request that satisfied the expectation condition
     * <span class=javadoc_param_annotation>@return</span> the response that will be returned to the client
     */</span>
    <span class=keyword>public</span> HttpResponse handle(HttpRequest httpRequest);

}</code></pre>
<p><strong>JavaScript</strong></p>
<p>To setup a callback in javascript use JSON to specify the details with the following format: </p>
<pre><code class=code><span class=string_literal>"httpCallback"</span>: {
    <span class=string_literal>"callbackClass"</span>: <span class=string_literal>"org.mypackage.MyCallbackClass"</span>
}
</code></pre>
<a name=verify-behaviour class=anchor href="#verify-behaviour">&nbsp;</a>
<h2>Verifying Behaviour</h2>
<p>Request can be verified in two ways:</p>
<ul>
<li><strong>MockServer</strong> - MockServer records all requests made to MockServer and can be used to verify which requests have been made</li>
<li><strong>Proxy</strong> - the proxy records all requests that are proxied and can be used to verify which requests have been made</li>
</ul>
<a name=verify-behaviour-with-mockserver class=anchor href="#verify-behaviour-with-mockserver">&nbsp;</a>
<h3>MockServer Verification</h3>
<p>The MockServer allows the verification of requests by specifying:</p>
<ul>
<li>an amount of a single type of request</li>
<li>a sequence of requests that is verified in order</li>
</ul>
<h4>Verifying Repeating Requests</h4>
<p>To verify that the system under test has sent an inidividual request to MockServer use the verify method of the MockServerClient as follows:</p>
<pre><code class=code><span class=keyword>new</span> MockServerClient(<span class=string_literal>"localhost"</span>, <span class=numeric_literal>9090</span>).verify(
        request()
                .withMethod(<span class=string_literal>"POST"</span>)
                .withPath(<span class=string_literal>"/login"</span>)
                .withBody(exact(<span class=string_literal>"{username: 'foo', password: 'bar'}"</span>))
                .withCookies(
                        <span class=keyword>new</span> Cookie(<span class=string_literal>"sessionId"</span>, <span class=string_literal>".*"</span>)
                ),
        VerificationTimes.exactly(<span class=numeric_literal>1</span>)
);</code></pre>
<p>The <strong>org.mockserver.verify.VerificationTimes</strong> class is used to specify how many times you want MockServer to match a request:</p>
<p>To create an instance of VerificationTimes use one of the static factory methods:</p>
<pre><code class=code>VerificationTimes.once();
VerificationTimes.exactly(<span class=keyword>int</span> count);
VerificationTimes.atLeast(<span class=keyword>int</span> count);</code></pre>
<h4>Verifying Request Sequences</h4>
<p>To verify that the system under test has sent a sequence of requests to MockServer use the verify method of the MockServerClient as follows:</p>
<pre><code class=code><span class=keyword>new</span> MockServerClient(<span class=string_literal>"localhost"</span>, <span class=numeric_literal>9090</span>).verify(
        request()
                .withMethod(<span class=string_literal>"POST"</span>)
                .withPath(<span class=string_literal>"/login"</span>)
                .withBody(exact(<span class=string_literal>"{username: 'foo', password: 'bar'}"</span>))
                .withCookies(
                        <span class=keyword>new</span> Cookie(<span class=string_literal>"sessionId"</span>, <span class=string_literal>".*"</span>)
                ),
        request()
                .withMethod(<span class=string_literal>"POST"</span>)
                .withPath(<span class=string_literal>"/deposit"</span>)
                .withBody(exact(<span class=string_literal>"{acccount: '123456789', card: '1234 5678 9012 3456', amount: '10.00'}"</span>))
                .withCookies(
                        <span class=keyword>new</span> Cookie(<span class=string_literal>"sessionId"</span>, <span class=string_literal>".*"</span>)
                ),
        request()
                .withMethod(<span class=string_literal>"POST"</span>)
                .withPath(<span class=string_literal>"/logout"</span>)
                .withCookies(
                        <span class=keyword>new</span> Cookie(<span class=string_literal>"sessionId"</span>, <span class=string_literal>".*"</span>)
                )
);</code></pre>
<p>The each request in the sequence will be verified to have been received at least once, in the exact order specified.</p>
<a name=verify-behaviour-with-proxy class=anchor href="#verify-behaviour-with-proxy">&nbsp;</a>
<h3>Proxy Verification</h3>
<p>The proxy supports exactly the same features for verifying requests <a href="#verify-behaviour-with-mockserver">described above</a> for the MockServer.</p>
<p>However, with the proxy, it it also possible to verify requests being sent to other HTTP/HTTPS endpoints. To do this the system under test must be configured to use the proxy. The proxy will then all outgoing and request and responses.</p>
<p>The following examples show how to do this with different HTTP clients:</p>
<h4>Jetty HttpClient 9.x</h4>
<pre><code class=code>HttpClient httpClient = <span class=keyword>new</span> HttpClient();
<span class=keyword>try</span> {
    httpClient.getProxyConfiguration().getProxies().add(<span class=keyword>new</span> HttpProxy(<span class=string_literal>"localhost"</span>, <span class=numeric_literal>9090</span>));
    httpClient.start();
} <span class=keyword>catch</span> (Exception e) {
    <span class=keyword>throw new</span> RuntimeException(<span class=string_literal>"Exception creating HttpClient"</span>, e);
}</code></pre>
<h4>Jetty HttpClient 8.x</h4>
<pre><code class=code>HttpClient httpClient = <span class=keyword>new</span> HttpClient();
<span class=keyword>try</span> {
    httpClient.setProxy(<span class=keyword>new</span> Address(<span class=string_literal>"localhost"</span>, <span class=numeric_literal>9090</span>));
    httpClient.start();
} <span class=keyword>catch</span> (Exception e) {
    <span class=keyword>throw new</span> RuntimeException(<span class=string_literal>"Exception creating HttpClient"</span>, e);
}</code></pre>
<p>The <a href="https://github.com/jamesdbloom/mockserver/tree/master/mockserver-examples">mockserver-example</a> project contains an example of using the proxy with Jetty HttpClient called
<a href="https://github.com/jamesdbloom/mockserver/blob/master/mockserver-examples/src/main/java/org/mockserver/service/jettyclient/BookServiceJettyHttpClient.java">BookServiceJettyHttpClient</a> that demonstrates a fully working example.</p>
<h4>Apache HttpClient</h4>
<pre><code class=code>HttpHost httpHost = <span class=keyword>new</span> HttpHost(<span class=string_literal>"localhost"</span>, <span class=numeric_literal>9090</span>);
DefaultProxyRoutePlanner defaultProxyRoutePlanner = <span class=keyword>new</span> DefaultProxyRoutePlanner(httpHost);
HttpClient httpClient = HttpClients.custom().setRoutePlanner(defaultProxyRoutePlanner).build();</code></pre>
<p>The <a href="https://github.com/jamesdbloom/mockserver/tree/master/mockserver-examples">mockserver-example</a> project contains an example of using the proxy with Apache HttpClient called
<a href="https://github.com/jamesdbloom/mockserver/blob/master/mockserver-examples/src/main/java/org/mockserver/service/apacheclient/BookServiceApacheHttpClient.java">BookServiceApacheHttpClient</a> that demonstrates a fully working example.</p>
<h4>Jersey</h4>
<pre><code class=code>ClientConfig clientConfig = <span class=keyword>new</span> ClientConfig().register(<span class=keyword>new</span> JacksonFeature())
                                              .connectorProvider(<span class=keyword>new</span> ApacheConnectorProvider());
clientConfig.property(ClientProperties.<span class=constant>PROXY_URI</span>, <span class=string_literal>"http://localhost:9090"</span>);
Client client = ClientBuilder.newClient(clientConfig);</code></pre>
<p>The <a href="https://github.com/jamesdbloom/mockserver/tree/master/mockserver-examples">mockserver-example</a> project contains an example of using the proxy with Jersey called
<a href="https://github.com/jamesdbloom/mockserver/blob/master/mockserver-examples/src/main/java/org/mockserver/service/jerseyclient/BookServiceJerseyClient.java">BookServiceJerseyClient</a> that demonstrates a fully working example.</p>
<h4>Spring Rest Template</h4>
<pre><code class=code>RestTemplate restTemplate = <span class=keyword>new</span> RestTemplate();
HttpHost httpHost = <span class=keyword>new</span> HttpHost(<span class=string_literal>"localhost"</span>, <span class=numeric_literal>9090</span>);
DefaultProxyRoutePlanner defaultProxyRoutePlanner = <span class=keyword>new</span> DefaultProxyRoutePlanner(httpHost);
HttpClient httpClient = HttpClients.custom().setRoutePlanner(defaultProxyRoutePlanner).build();
restTemplate.setRequestFactory(<span class=keyword>new</span> HttpComponentsClientHttpRequestFactory(httpClient));</code></pre>
<p>The <a href="https://github.com/jamesdbloom/mockserver/tree/master/mockserver-examples">mockserver-example</a> project contains an example of using the proxy with Spring Rest Template called
<a href="https://github.com/jamesdbloom/mockserver/blob/master/mockserver-examples/src/main/java/org/mockserver/service/springclient/BookServiceSpringRestTemplateClient.java">BookServiceSpringRestTemplateClient</a> that demonstrates a fully working example.</p>
<h4>Grizzly</h4>
<pre><code class=code>AsyncHttpClientConfig.Builder clientConfigBuilder = <span class=keyword>new</span> AsyncHttpClientConfig.Builder();
clientConfigBuilder.setProxyServerSelector(ProxyUtils.createProxyServerSelector(HttpProxy.proxySelector()));
AsyncHttpClient asyncHttpClient = <span class=keyword>new</span> AsyncHttpClient(clientConfigBuilder.build());</code></pre>
<p>The <a href="https://github.com/jamesdbloom/mockserver/tree/master/mockserver-examples">mockserver-example</a> project contains an example of using the proxy with Grizzly Http Client called
<a href="https://github.com/jamesdbloom/mockserver/blob/master/mockserver-examples/src/main/java/org/mockserver/service/grizzlyclient/BookServiceGrizzlyHttpClient.java">BookServiceGrizzlyHttpClient</a> that demonstrates a fully working example.</p>
<p>To verify that a request has been sent use the verify method of the ProxyClient as follows:</p>
<pre><code class=code><span class=keyword>new</span> ProxyClient(<span class=string_literal>"localhost"</span>, <span class=numeric_literal>9090</span>).verify(
        request()
                .withMethod(<span class=string_literal>"POST"</span>)
                .withPath(<span class=string_literal>"/login"</span>)
                .withBody(exact(<span class=string_literal>"{username: 'foo', password: 'bar'}"</span>))
                .withCookies(
                        <span class=keyword>new</span> Cookie(<span class=string_literal>"sessionId"</span>, <span class=string_literal>".*"</span>)
                ),
        VerificationTimes.exactly(<span class=numeric_literal>1</span>)
);</code></pre>
<p>The <a href="https://github.com/jamesdbloom/mockserver/tree/master/mockserver-examples">mockserver-example</a> project contains an example test called
<a href="https://github.com/jamesdbloom/mockserver/blob/master/mockserver-examples/src/test/java/org/mockserver/web/controller/BooksPageIntegrationTest.java">BookPageIntegrationTest</a> that demonstrates a fully working example.</p>
<a name=analysing-behaviour class=anchor href="#analysing-behaviour">&nbsp;</a>
<h2>Analysing Behaviour</h2>
<p>To analyse the requests that system makes the proxy can be used to record all requests and write them into the <span class=annotation>mockserver_request.log</span>. This can be particularly helpful when refactoring an existing or legacy system.</p>
<p>The requests can be written to the log in JSON or as Java code. The Java code can then be used to setup expectations in MockServer and exactly replay all interactions.</p>
<p>First the system that is being analysed must be configured to use the proxy.</p>
<p>If the proxy is being started programmatically from within the same JVM using <span class=annotation>org.mockserver.proxy.ProxyRunner</span> or <span class=annotation>org.mockserver.integration.ClientAndProxy</span> then the environment variables for <strong>"proxySet"</strong>,
<strong>"http.proxyHost"</strong> and <strong>"http.proxyPort"</strong> will be set automatically.</p>
<p>If the proxy is being started as separate JVM, for example using <a href="#running-from-command-line">the command line</a>, then the system being analysed needs the following command line options to set the correct environment variables.</p>
<pre><code class=code>-DproxySet=true -Dhttp.proxyHost=&lt;proxy hostname&gt; -Dhttp.proxyPort=&lt;proxy port&gt;</code></pre>
<p>For example:</p>
<pre><code class=code>-DproxySet=true -Dhttp.proxyHost=localhost -Dhttp.proxyPort=9090</code></pre>
<h4>Apache HttpClient</h4>
<p>To configure the proxy with an Apache HttpClient, as follows:</p>
<pre><code class=code><span class=keyword>public</span> HttpClient createHttpClient() {
    <span class=keyword>if</span> (Boolean.parseBoolean(System.getProperty(<span class=string_literal>"proxySet"</span>))) {
        HttpHost httpHost = <span class=keyword>new</span> HttpHost(System.getProperty(<span class=string_literal>"http.proxyHost"</span>), Integer.parseInt(System.getProperty(<span class=string_literal>"http.proxyPort"</span>)));
        DefaultProxyRoutePlanner defaultProxyRoutePlanner = <span class=string_literal>new</span> DefaultProxyRoutePlanner(httpHost);
        <span class=string_literal>return</span> HttpClients.custom().setRoutePlanner(defaultProxyRoutePlanner).build();
    } <span class=string_literal>else</span> {
        <span class=string_literal>return</span> HttpClients.custom().build();
    }
}</code></pre>
<p>The <a href="https://github.com/jamesdbloom/mockserver/tree/master/mockserver-examples">mockserver-example</a> project contains an example of using the proxy with a Apache HttpClient called
<a href="https://github.com/jamesdbloom/mockserver/blob/master/mockserver-examples/src/main/java/org/mockserver/service/apacheclient/BookServiceApacheHttpClient.java">BookServiceApacheHttpClient</a> that demonstrates a fully working example.</p>
<h4>Grizzly AsyncHttpClient</h4>
<p>To configure the proxy with a Grizzly AsyncHttpClient, as follows:</p>
<pre><code class=code><span class=keyword>public</span> AsyncHttpClient createHttpClient() {
    AsyncHttpClientConfig.Builder clientConfigBuilder = <span class=keyword>new</span> AsyncHttpClientConfig.Builder();
    <span class=keyword>if</span> (Boolean.parseBoolean(System.getProperty(<span class=string_literal>"proxySet"</span>))) {
        clientConfigBuilder.setProxyServerSelector(ProxyUtils.createProxyServerSelector(ProxyRunner.proxySelector()));
    }
    <span class=keyword>return new</span> AsyncHttpClient(clientConfigBuilder.build());
}</code></pre>
<p>The <a href="https://github.com/jamesdbloom/mockserver/tree/master/mockserver-examples">mockserver-example</a> project contains an example of using the proxy with a Grizzly AsyncHttpClient called
<a href="https://github.com/jamesdbloom/mockserver/blob/master/mockserver-examples/src/main/java/org/mockserver/service/grizzlyclient/BookServiceGrizzlyHttpClient.java">BookServiceGrizzlyHttpClient</a> that demonstrates a fully working example.</p>
<h4>Jersey Client</h4>
<p>To configure the proxy with a Jersey Client, as follows:</p>
<pre><code class=code><span class=keyword>public</span> Client createHttpClient() {
    ClientConfig clientConfig = <span class=keyword>new</span> ClientConfig()
            .register(<span class=keyword>new</span> JacksonFeature())
            .connectorProvider(<span class=keyword>new</span> ApacheConnectorProvider());
    <span class=keyword>if</span> (Boolean.parseBoolean(System.getProperty(<span class=string_literal>"proxySet"</span>))) {
        clientConfig.property(ClientProperties.PROXY_URI, <span class=string_literal>"http://"</span> + System.getProperty(<span class=string_literal>"http.proxyHost"</span>) + <span class=string_literal>":"</span> + System.getProperty(<span class=string_literal>"http.proxyPort"</span>));
    }
    <span class=keyword>return</span> ClientBuilder.newClient(clientConfig);
}</code></pre>
<p>The <a href="https://github.com/jamesdbloom/mockserver/tree/master/mockserver-examples">mockserver-example</a> project contains an example of using the proxy with a Jersey Client called
<a href="https://github.com/jamesdbloom/mockserver/blob/master/mockserver-examples/src/main/java/org/mockserver/service/jerseyclient/BookServiceJerseyClient.java">BookServiceJerseyClient</a> that demonstrates a fully working example.</p>
<h4>Jetty HttpClient</h4>
<p>To configure the proxy with a Jetty HttpClient, as follows:</p>
<pre><code class=code><span class=keyword>public</span> HttpClient createHttpClient() {
    HttpClient httpClient = <span class=keyword>new</span> HttpClient();
    <span class=keyword>try</span> {
        if (Boolean.parseBoolean(System.getProperty(<span class=string_literal>"proxySet"</span>))) {
            httpClient.getProxyConfiguration().getProxies().add(<span class=keyword>new</span> HttpProxy(System.getProperty(<span class=string_literal>"http.proxyHost"</span>), Integer.parseInt(System.getProperty(<span class=string_literal>"http.proxyPort"</span>))));
        }
        httpClient.start();
    } <span class=keyword>catch</span> (Exception e) {
        <span class=keyword>throw new</span> RuntimeException(<span class=string_literal>"Exception creating HttpClient"</span>, e);
    }
    <span class=keyword>return</span> httpClient;
}</code></pre>
<p>The <a href="https://github.com/jamesdbloom/mockserver/tree/master/mockserver-examples">mockserver-example</a> project contains an example of using the proxy with a Jetty HttpClient called
<a href="https://github.com/jamesdbloom/mockserver/blob/master/mockserver-examples/src/main/java/org/mockserver/service/apacheclient/BookServiceApacheHttpClient.java">BookServiceJettyHttpClient</a> that demonstrates a fully working example.</p>
<h4>Spring RestTemplate</h4>
<p>To configure the proxy with a Spring RestTemplate, as follows:</p>
<pre><code class=code><span class=keyword>public</span> RestTemplate createRestTemplate() {
    <span class=comment>// jackson message converter</span>
    MappingJacksonHttpMessageConverter mappingJacksonHttpMessageConverter = <span class=keyword>new</span> MappingJacksonHttpMessageConverter();
    mappingJacksonHttpMessageConverter.setObjectMapper(objectMapper);

    <span class=comment>// create message converters list</span>
    List&lt;HttpMessageConverter&lt;?&gt;&gt; httpMessageConverters = <span class=keyword>new</span> ArrayList<>();
    httpMessageConverters.add(mappingJacksonHttpMessageConverter);

    <span class=comment>// create rest template</span>
    RestTemplate restTemplate = <span class=keyword>new</span> RestTemplate();
    restTemplate.setMessageConverters(httpMessageConverters);

    <span class=comment>// configure proxy</span>
    <span class=keyword>if</span> (Boolean.parseBoolean(System.getProperty(<span class=string_literal>"proxySet"</span>))) {
        HttpHost httpHost = <span class=keyword>new</span> HttpHost(
                System.getProperty(<span class=string_literal>"http.proxyHost"</span>),
                Integer.parseInt(System.getProperty(<span class=string_literal>"http.proxyPort"</span>))
        );
        DefaultProxyRoutePlanner defaultProxyRoutePlanner = <span class=keyword>new</span> DefaultProxyRoutePlanner(httpHost);
        HttpClient httpClient = HttpClients.custom().setRoutePlanner(defaultProxyRoutePlanner).build();
        restTemplate.setRequestFactory(<span class=keyword>new</span> HttpComponentsClientHttpRequestFactory(httpClient));
    }

    <span class=keyword>return</span> restTemplate;
}</code></pre>
<p>The <a href="https://github.com/jamesdbloom/mockserver/tree/master/mockserver-examples">mockserver-example</a> project contains an example of using the proxy with a Spring RestTemplate called
<a href="https://github.com/jamesdbloom/mockserver/blob/master/mockserver-examples/src/main/java/org/mockserver/service/springclient/BookServiceSpringRestTemplateClient.java">BookServiceSpringRestTemplateClient</a> that demonstrates a fully working example.</p>
<p><strong>Write Requests To Log</strong></p>
<p>Write the recorded request to the log as Java code, as follows:</p>
<pre><code class=code><span class=keyword>new</span> ProxyClient(<span class=string_literal>"localhost"</span>, <span class=numeric_literal>9090</span>).dumpToLogAsJava(
        request()
                .withMethod(<span class=string_literal>"POST"</span>)
                .withPath(<span class=string_literal>"/login"</span>)
);</code></pre>
<p>The Java code format that requests are written to the logs is as follows:</p>
<pre><code class=code>2014-01-12 21:46:33,305
<span class=keyword>new</span> MockServerClient()
        .when(
                request()
                        .withMethod(<span class=string_literal>"GET"</span>)
                        .withPath(<span class=string_literal>"/get_book"</span>)
                        .withQueryString(<span class=string_literal>"id=1"</span>)
                        .withHeaders(
                                <span class=keyword>new</span> Header(<span class=string_literal>"Accept-Encoding"</span>, <span class=string_literal>"gzip"</span>),
                                <span class=keyword>new</span> Header(<span class=string_literal>"Host"</span>, <span class=string_literal>"localhost:1090"</span>),
                                <span class=keyword>new</span> Header(<span class=string_literal>"User-Agent"</span>, <span class=string_literal>"Jetty/8.1.13.v20130916"</span>)
                        ),
                Times.once()
        )
        .thenRespond(
                response()
                        .withStatusCode(<span class=numeric_literal>200</span>)
                        .withHeaders(
                                <span class=keyword>new</span> Header(<span class=string_literal>"Server"</span>, <span class=string_literal>"Jetty(8.1.13.v20130916)"</span>)
                        )
                        .withBody(<span class=string_literal>"{\n        \"id\": \"1\",\n        \"title\": \"Xenophon's imperial fiction : on the education of Cyrus\",\n        \"author\": \"James Tatum\",\n        \"isbn\": \"0691067570\",\n        \"publicationDate\": \"1989\"\n    }"</span>)
        );</code></pre>
<p>Write the recorded request to the log as JSON, as follows:</p>
<pre><code class=code><span class=keyword>new</span> ProxyClient(<span class=string_literal>"localhost"</span>, <span class=numeric_literal>9090</span>).dumpToLogAsJSON(
        request()
                .withMethod(<span class=string_literal>"POST"</span>)
                .withPath(<span class=string_literal>"/login"</span>)
);</code></pre>
<p>The JSON format that requests are written to the logs is as follows:</p>
<pre><code class=code>2014-01-12 21:46:33,299 {
    <span class=string_literal>"httpRequest"</span> : {
        <span class=string_literal>"method"</span> : <span class=string_literal>"GET"</span>,
        <span class=string_literal>"path"</span> : <span class=string_literal>"/get_book"</span>,
        <span class=string_literal>"queryString"</span> : <span class=string_literal>"id=1"</span>,
        <span class=string_literal>"headers"</span> : [
            {
                <span class=string_literal>"name"</span> : <span class=string_literal>"Accept-Encoding"</span>,
                <span class=string_literal>"values"</span> : [ <span class=string_literal>"gzip"</span> ]
            },
            {
                <span class=string_literal>"name"</span> : <span class=string_literal>"Host"</span>,
                <span class=string_literal>"values"</span> : [ <span class=string_literal>"localhost:8080"</span> ]
            },
            {
                <span class=string_literal>"name"</span> : <span class=string_literal>"User-Agent"</span>,
                <span class=string_literal>"values"</span> : [ <span class=string_literal>"Jetty/8.1.13.v20130916"</span> ]
            } ]
    },
    <span class=string_literal>"httpResponse"</span> : {
        <span class=string_literal>"statusCode"</span> : <span class=numeric_literal>200</span>,
        <span class=string_literal>"body"</span> : <span class=string_literal>"{\n    \"id\": \"1\",\n    \"title\": \"Xenophon's imperial fiction : on the education of Cyrus\",\n    \"author\": \"James Tatum\",\n    \"isbn\": \"0691067570\",\n    \"publicationDate\": \"1989\"\n}"</span>,
        <span class=string_literal>"headers"</span> : [ {
            <span class=string_literal>"name"</span> : <span class=string_literal>"Server"</span>,
            <span class=string_literal>"values"</span> : [ <span class=string_literal>"Jetty(8.1.13.v20130916)"</span> ]
        } ]
    },
    <span class=string_literal>"times"</span> : {
        <span class=string_literal>"remainingTimes"</span> : <span class=numeric_literal>1</span>,
        <span class=string_literal>"unlimited"</span> : <span class=keyword>false</span>
    }
}</code></pre>
<a name=ensuring-tests-can-run-in-parallel class=anchor href="#ensuring-tests-can-run-in-parallel">&nbsp;</a>
<h2>Running Tests In Parallel</h2>
<p>To ensure all tests can run in parallel with completely isolated independent data it is important to include a value unique to each test for the request matcher. </p>
<p>For example the code above has a sessionId cookie in the request matcher. If each test generates a different value (i.e. a UUID) for the sessionId cookie then each test can receive completely independent response. Instead of a cookie value a query parameter or header (such as the Referer header) can also be used to ensure mock responses are unique to each test.</p>
<a name=clear-and-reset class=anchor href="#clear-and-reset">&nbsp;</a>
<h2>Clear &amp; Reset</h2>
<p>To clear <strong>all expectations</strong> (without restarting) use <strong>reset</strong> as follows:</p>
<p><strong>Java</strong></p>
<pre><code class=code>mockServerClient.reset()</code></pre>
<p><strong>JavaScript</strong></p>
<pre><code class=code><span class=keyword>var</span> xmlHttpRequest = <span class=keyword>new</span> XMLHttpRequest();
xmlHttpRequest.open(<span class=string_literal>"PUT"</span>, <span class=string_literal>"http://localhost:9999/reset"</span>, <span class=keyword>false</span>);
xmlHttpRequest.send();</code></pre>
<p>To clear <strong>only specific</strong> expectations use <strong>clear</strong> as follows:</p>
<p><strong>Java</strong></p>
<pre><code class=code>mockServerClient.clear(
        request()
                .withMethod(<span class=string_literal>"POST"</span>)
                .withPath(<span class=string_literal>"/login"</span>)
);</code></pre>
<p><strong>JavaScript</strong></p>
<pre><code class=code><span class=keyword>var</span> xmlHttpRequest = <span class=keyword>new</span> XMLHttpRequest();
xmlHttpRequest.open(<span class=string_literal>"PUT"</span>, <span class=string_literal>"http://localhost:9999/clear"</span>, <span class=keyword>false</span>);
xmlHttpRequest.setRequestHeader(<span class=string_literal>"Content-Type"</span>, <span class=string_literal>"application/json; charset=utf-8"</span>);
xmlHttpRequest.send(JSON.stringify({
    <span class=string_literal>"method"</span>: <span class=string_literal>"POST"</span>,
    <span class=string_literal>"path"</span>: <span class=string_literal>"/login"</span>,
}));</code></pre>
<p>The example above clears all expectations that will match incoming requests with a <strong>POST</strong> method on the path <strong>/login</strong>.</p>
<a name=debugging-issues class=anchor href="#debugging-issues">&nbsp;</a>
<h2>Debugging Issues</h2>
<p>To simplify debugging MockServer expectations can be dumped to the log at WARN level using pretty-printed JSON.</p>
<p>To dump <strong>all expectations</strong> to the log use <strong>dumpToLog</strong> as follows:</p>
<p><strong>Java</strong></p>
<pre><code class=code>mockServerClient.dumpToLog()</code></pre>
<p><strong>JavaScript</strong></p>
<pre><code class=code><span class=keyword>var</span> xmlHttpRequest = <span class=keyword>new</span> XMLHttpRequest();
xmlHttpRequest.open(<span class=string_literal>"PUT"</span>, <span class=string_literal>"http://localhost:9999/dumpToLog"</span>, <span class=keyword>false</span>);
xmlHttpRequest.send();</code></pre>
<p>To dump <strong>only specific</strong> expectations to the log use <strong>dumpToLog</strong> as follows:</p>
<p><strong>Java</strong></p>
<pre><code class=code>mockServerClient.dumpToLog(
        request()
                .withMethod(<span class=string_literal>"POST"</span>)
                .withPath(<span class=string_literal>"/login"</span>)
);</code></pre>
<p><strong>JavaScript</strong></p>
<pre><code class=code><span class=keyword>var</span> xmlHttpRequest = <span class=keyword>new</span> XMLHttpRequest();
xmlHttpRequest.open(<span class=string_literal>"PUT"</span>, <span class=string_literal>"http://localhost:9999/dumpToLog"</span>, <span class=keyword>false</span>);
xmlHttpRequest.send(JSON.stringify({
    <span class=string_literal>"method"</span>: <span class=string_literal>"POST"</span>,
    <span class=string_literal>"path"</span>: <span class=string_literal>"/login"</span>,
}));</code></pre>
<p>The example above dumps all expectations that match incoming requests with a <strong>POST</strong> method on the path <strong>/login</strong>.</p>
<a name=requirements class=anchor href="#requirements">&nbsp;</a>
<h2>Requirements</h2>
<ul>
<li><strong>Java 6+</strong>&nbsp;&nbsp;&nbsp;to use the Netty version, the Maven Plugin and MockServer WAR and proxy WAR</li>
<li><strong>Java 7+</strong>&nbsp;&nbsp;&nbsp;to use the Vert.X module or the Embedded Jetty version as both Jetty 9 and Vert.X in turn require Java 7 (<strong>Note:</strong> all features provided in the Embedded Jetty version are also available using the Netty version)</li>
</ul>
<a name=downloads class=anchor href="#versions">&nbsp;</a>
<h2>Downloads</h2>
<p>The simplest way to run and download MockServer is by using the fully stand alone web server embedded with all dependencies that mocks HTTP and HTTPS requests, as follows:</p>
<ol>
<li><p>download <a href="http://search.maven.org/remotecontent?filepath=org/mock-server/mockserver-netty/3.9.8/mockserver-netty-3.9.8-jar-with-dependencies.jar">mockserver-netty-3.9.8-jar-with-dependencies.jar</a> from Maven Central</p></li>
<li>
<code class="code inline">java -jar &lt;path to mockserver-netty-3.9.8-jar-with-dependencies.jar&gt; -serverPort &lt;port&gt;</code>
</li>
</ol>
<p class=sub_title>For more details on downloads see:</p>
<ul>
<li><p>jar-with-dependencies / jar / war packages at <a href="#maven-central">MockServer on Maven Central</a>.</p></li>
<li><p>Vert.X Modules at <a href="#vertx-registry">MockServer on Vert.X Module Registry</a>.</p></li>
<li><p>source code at <a href="#github">MockServer on GitHub</a>.</p></li>
</ul>
<a name=github class=anchor href="#github">&nbsp;</a>
<h2>GitHub</h2>
<p>The source control for MockServer is git which is hosted at GitHub <a href="https://github.com/jamesdbloom/mockserver">jamesdbloom/mockserver</a></p>
<p>GitHub is also used to track issues / bugs and manage pull-requests.</p>
<a name=maven-central class=anchor href="#maven-central">&nbsp;</a>
<h2>Maven Central&nbsp;&nbsp;<a href="http://search.maven.org/#search%7Cga%7C1%7Cmockserver"><img width=131 height=20 src="https://camo.githubusercontent.com/e81e59784109e88f76e25361cd6b4da7a5a18947/68747470733a2f2f6d6176656e2d6261646765732e6865726f6b756170702e636f6d2f6d6176656e2d63656e7472616c2f6f72672e6d6f636b2d7365727665722f6d6f636b7365727665722d6e657474792f62616467652e7376673f7374796c653d666c6174" alt=mockserver data-canonical-src="https://maven-badges.herokuapp.com/maven-central/org.mock-server/mockserver-netty/badge.svg?style=flat" style="max-width:100%;"></a></h2>
<p>Maven Central contains the following MockServer artifacts:</p>
<ul>
<li><a href="http://search.maven.org/#search%7Cga%7C1%7Cmockserver-netty">mockserver-netty</a> - a web server for mocking and proxying using Netty, can be added to a maven build as follows:
<pre><code class="code xml">&lt;<span class=element>dependency</span>&gt;
	&lt;<span class=element>groupId</span>&gt;<span class=element_value>org.mock-server</span>&lt;/<span class=element>groupId</span>&gt;
	&lt;<span class=element>artifactId</span>&gt;<span class=element_value>mockserver-netty</span>&lt;/<span class=element>artifactId</span>&gt;
	&lt;<span class=element>version</span>&gt;<span class=element_value>RELEASE</span>&lt;/<span class=element>version</span>&gt;
&lt;/<span class=element>dependency</span>&gt;</code></pre></li>
<li><a href="http://search.maven.org/#search%7Cga%7C1%7Cmockserver-netty">mockserver-netty:jar-with-dependencies</a> - as above using Netty that includes all dependencies are bundled into the jar file, this artifact <a href="http://search.maven.org/remotecontent?filepath=org/mock-server/mockserver-netty/3.9.8/mockserver-netty-3.9.8-jar-with-dependencies.jar">can be downloaded</a>.</li>
<li><a href="http://search.maven.org/#search%7Cga%7C1%7Cmockserver-war">mockserver-war</a> - a deployable WAR for mocking that can be deployed to any JEE web server, this artifact <a href="http://search.maven.org/remotecontent?filepath=org/mock-server/mockserver-war/3.9.8/mockserver-war-3.9.8.war">can be downloaded</a>.</li>
<li><a href="http://search.maven.org/#search%7Cga%7C1%7Cmockserver-proxy-war">mockserver-proxy-war</a> - a deployable WAR for proxying that can be deployed to any JEE web server, this artifact <a href="http://search.maven.org/remotecontent?filepath=org/mock-server/mockserver-proxy-war/3.9.8/mockserver-proxy-war-3.9.8.war">can be downloaded</a>.</li>
<li><a href="http://search.maven.org/#search%7Cga%7C1%7Cmockserver-maven-plugin">mockserver-maven-plugin</a> - a set of maven plugins to start, stop and fork MockServer using maven, can be added to a maven build as follows:
<pre><code class="code xml">&lt;<span class=element>plugin</span>&gt;
    &lt;<span class=element>groupId</span>&gt;<span class=element_value>org.mock-server</span>&lt;/<span class=element>groupId</span>&gt;
    &lt;<span class=element>artifactId</span>&gt;<span class=element_value>mockserver-maven-plugin</span>&lt;/<span class=element>artifactId</span>&gt;
    &lt;<span class=element>version</span>&gt;<span class=element_value>RELEASE</span>&lt;/<span class=element>version</span>&gt;
    &lt;<span class=element>configuration</span>&gt;
        &lt;<span class=element>serverPort</span>&gt;<span class=element_value>1080</span>&lt;/<span class=element>serverPort</span>&gt;
        &lt;<span class=element>pipeLogToConsole</span>&gt;<span class=element_value>true</span>&lt;/<span class=element>pipeLogToConsole</span>&gt;
&lt;/<span class=element>plugin</span>&gt;</code></pre>
<li><a href="http://search.maven.org/#search%7Cga%7C1%7Cmockserver-client-java">mockserver-client-java</a> - a Java client to communicate with both the server and the proxy, can be added to a maven build as follows:
<pre><code class="code xml">&lt;<span class=element>dependency</span>&gt;
	&lt;<span class=element>groupId</span>&gt;<span class=element_value>org.mock-server</span>&lt;/<span class=element>groupId</span>&gt;
	&lt;<span class=element>artifactId</span>&gt;<span class=element_value>mockserver-client-java</span>&lt;/<span class=element>artifactId</span>&gt;
	&lt;<span class=element>version</span>&gt;<span class=element_value>RELEASE</span>&lt;/<span class=element>version</span>&gt;
&lt;/<span class=element>dependency</span>&gt;</code></pre></li>
</ul>
<p>In addition the continuous integration build on Travis deploys a SNAPSHOT version on every github commit these SNAPSHOT artifacts can be found at <a href="https://oss.sonatype.org/index.html#nexus-search;quick%7Emockserver">https://oss.sonatype.org/index.html#nexus-search;quick~mockserver</a> by adding the correct repository to maven:</p>
<pre><code class="code xml">&lt;<span class=element>repositories</span>&gt;
	&lt;<span class=element>repository</span>&gt;
		&lt;<span class=element>id</span>&gt;<span class=element_value>sonatype-snapshots</span>&lt;/<span class=element>id</span>&gt;
		&lt;<span class=element>url</span>&gt;<span class=element_value>https://oss.sonatype.org/content/repositories/snapshots</span>&lt;/<span class=element>url</span>&gt;
	&lt;/<span class=element>repository</span>&gt;
&lt;/<span class=element>repositories</span>&gt;</code></pre>
<p>then specifying the latest SNAPSHOT build, for example for <strong>mockserver-netty</strong> this would be as follows:</p>
<pre><code class="code xml">&lt;<span class=element>dependency</span>&gt;
	&lt;<span class=element>groupId</span>&gt;<span class=element_value>org.mock-server</span>&lt;/<span class=element>groupId</span>&gt;
	&lt;<span class=element>artifactId</span>&gt;<span class=element_value>mockserver-netty</span>&lt;/<span class=element>artifactId</span>&gt;
	&lt;<span class=element>version</span>&gt;<span class=element_value>SNAPSHOT</span>&lt;/<span class=element>version</span>&gt;
&lt;/<span class=element>dependency</span>&gt;</code></pre>
<a name=ruby-gems class=anchor href="#ruby-gems">&nbsp;</a>
<h2>Ruby Gems&nbsp;&nbsp;<a href="http://badge.fury.io/rb/mockserver-client"><img src="https://badge.fury.io/rb/mockserver-client.png" alt="Gem Version" width=104 height=18></a></h2>
<p>Ruby Gems contains the following gems:<p>
<ul>
<li><a href="https://rubygems.org/gems/mockserver-client">mockserver-client</a> - ruby client for MockServer and proxy</li>
</ul>
<a name=npm-modules class=anchor href="#npm-modules">&nbsp;</a>
<h2>Node Packaged Modules (npm)</h2>
<p>npm contains the following modules:<p>
<ul>
<li><a href="https://www.npmjs.org/package/mockserver-grunt">mockserver-grunt</a> - node module and grunt taks to start and stop MockServer and its proxy&nbsp;&nbsp;<a href="http://badge.fury.io/js/mockserver-grunt"><img src="https://badge.fury.io/js/mockserver-grunt.png" alt="npm version" width=114 height=18></a>&nbsp;<a href="http://badge.fury.io/bo/mockserver-grunt"><img src="https://badge.fury.io/bo/mockserver-grunt.png" alt="Bower version" width=110 height=18></a></li>
<li><a href="https://www.npmjs.org/package/mockserver-client">mockserver-client</a> - node client for MockServer and its proxy&nbsp;&nbsp;<a href="http://badge.fury.io/js/mockserver-client"><img src="https://badge.fury.io/js/mockserver-client.png" alt="npm version" width=109 height=18></a>&nbsp;<a href="http://badge.fury.io/bo/mockserver-client"><img src="https://badge.fury.io/bo/mockserver-client.png" alt="Bower version" width=110 height=18></a></li>
</ul>
<a name=vertx-registry class=anchor href="#vertx-registry">&nbsp;</a>
<h2>Vert.X Module Registry</h2>
<p>Vert.X Module Registry contains the following artifacts:</p>
<ul>
<li><a href="http://modulereg.vertx.io/">org.mock-server~mockserver-vertx~2.9</a> - a Vert.X module that mocks HTTP and HTTPS requests</li>
</ul>
<p>Vert.X Module Registry will shortly also have the following artifacts:</p>
<ul>
<li><a href="http://modulereg.vertx.io/">org.mock-server~mockserver-vertx-proxy~2.9</a> - a Vert.X module that proxies HTTP and HTTPS allowing the recording and querying of requests and responses</li>
</ul>
<a name=docker-index class=anchor href="#docker-index">&nbsp;</a>
<h2>Docker Container</h2>
<p>MockServer is available as a docker container that allows you to easily run MockServer as a separate container on any environment without having to install Java or any other libraries. The docker container fully encapsulates all requirements required to run MockServer (such as Java) and separates the running MockServer instance from all other parts of the system.</p>
<p>MockServer docker container can be found at <a href="https://index.docker.io/u/jamesdbloom/mockserver/">MockServer Docker</a></p>
<a name=continuous-integration class=anchor href="#continuous-integration">&nbsp;</a>
<h2>Travis CI</h2>
<p><a href="https://travis-ci.org/jamesdbloom/mockserver">Travis CI</a> is used for the continuous integration. The build uses both Java 1.6, Java 1.7 and Java 1.8 to build the different modules in their appropriate java version, the latest SNAPSHOT is also deployed to
<a href="https://oss.sonatype.org/index.html#nexus-search;quick%7Emockserver">Sonatype</a>.</p>
<p>The status of the build is shown at the top of this page and on the github project using the Travis CI logo &nbsp;&nbsp;<a href="https://travis-ci.org/jamesdbloom/mockserver"><img width=90 height=20 src="https://github-camo.global.ssl.fastly.net/2e2b9deeda5c745f167e2cabcd787322df06688f/68747470733a2f2f7472617669732d63692e6f72672f6a616d657364626c6f6f6d2f6d6f636b7365727665722e706e673f6272616e63683d6d6173746572" alt="Build Status" data-canonical-src="https://travis-ci.org/jamesdbloom/mockserver.png?branch=master" style="max-width:100%;"></a>
</p>
<h2>drone.io</h2>
<p><a href="https://drone.io/github.com/jamesdbloom/mockserver">drone.io</a> is an alternative continuous integration platform also being used. Currently Travis CI and drone.io are both being used to determine which platform works better for MockServer.</p>
<p>The status of the drone.io build is as follows: <a href="https://drone.io/github.com/jamesdbloom/mockserver"><img width=80 height=18 src="https://drone.io/github.com/jamesdbloom/mockserver/status.png" alt="Build Status"></a></p>
<a name=backlog class=anchor href="#backlog">&nbsp;</a>
<h2>Backlog</h2>
<p><a href="https://waffle.io/jamesdbloom/mockserver">Waffle</a> is used to visualise the backlog, although all the items are stored in <a href="https://github.com/jamesdbloom/mockserver/issues?milestone=&page=1&state=open">Github</a>.</p>
<p>The following icons shows the status of the backlog:
<a href="https://waffle.io/jamesdbloom/mockserver"><img width=94 height=18 src="https://camo.githubusercontent.com/7cb4115a381b12f2730184fd28e238e98450b98c/68747470733a2f2f62616467652e776166666c652e696f2f6a616d657364626c6f6f6d2f6d6f636b7365727665722e706e673f6c6162656c3d70726f706f73616c267469746c653d50726f706f73616c73" alt="Stories in Backlog" data-canonical-src="https://badge.waffle.io/jamesdbloom/mockserver.png?label=proposal&amp;title=Proposals" style="max-width:100%;"></a>
<a href="https://waffle.io/jamesdbloom/mockserver"><img width=70 height=18 src="https://camo.githubusercontent.com/0c25a2c44f691aa43b5fec8c8b3617f3eb16740b/68747470733a2f2f62616467652e776166666c652e696f2f6a616d657364626c6f6f6d2f6d6f636b7365727665722e706e673f6c6162656c3d7265616479267469746c653d5265616479" alt="Stories in Backlog" data-canonical-src="https://badge.waffle.io/jamesdbloom/mockserver.png?label=ready&amp;title=Ready" style="max-width:100%;"></a>
<a href="https://waffle.io/jamesdbloom/mockserver"><img width=106 height=18 src="https://camo.githubusercontent.com/6cb0a7e54cd194e04a1ee2ae891c1e295969d152/68747470733a2f2f62616467652e776166666c652e696f2f6a616d657364626c6f6f6d2f6d6f636b7365727665722e706e673f6c6162656c3d696e25323070726f6772657373267469746c653d496e25323050726f6772657373" alt="Stories in Backlog" data-canonical-src="https://badge.waffle.io/jamesdbloom/mockserver.png?label=in%20progress&amp;title=In%20Progress" style="max-width:100%;"></a>
</p>
<a name=site-map class=anchor href="#site-map">&nbsp;</a>
<h2>Site Map</h2>
<ul>
<li><a href="#what-is-mockserver">What Is Mockserver</a>
<ul>
<li><a href="#mocking">Mocking</a></li>
<li><a href="#proxying">Proxying</a></li>
<li><a href="#versions">Versions</a></li>
</ul>
</li>
<li><a href="#clients">Clients</a>
<ul>
<li><a href="#java-mockserver-client">Java Mockserver Client</a></li>
<li><a href="#java-proxy-client">Java Proxy Client</a></li>
<li><a href="#javascript-mockserver-client">Javascript Mockserver Client</a></li>
<li><a href="#javascript-proxy-client">Javascript Proxy Client</a></li>
</ul>
</li>
<li><a href="#why-use-mockserver">Why Use Mockserver</a></li>
<li><a href="#getting-started">Getting Started</a></li>
<li><a href="#starting-mockserver">Starting Mockserver</a>
<ul>
<li><a href="#maven-plugin">Maven Plugin</a></li>
<li><a href="#client-api">Client API</a></li>
<li><a href="#junit-rule">Junit Rule</a></li>
<li><a href="#running-from-command-line">Running From Command Line</a></li>
<li><a href="#docker-container">Docker Container</a></li>
<li><a href="#vertx-module">Vert.x Module</a></li>
<li><a href="#deployable-war">Deployable WAR</a></li>
<li><a href="#build-and-run-from-source">Build & Run From Source</a></li>
</ul>
</li>
<li><a href="#create-expectations">Create Expectations</a>
<ul>
<li><a href="#request-matchers">Request Matchers</a></li>
<li><a href="#mock-response">Response Actions</a></li>
<li><a href="#mock-forward">Forward Actions</a></li>
<li><a href="#callback">Callback Actions</a></li>
</ul>
</li>
<li><a href="#verify-behaviour">Verify Behaviour</a>
<ul>
<li><a href="#verify-behaviour-with-mockserver">Verifying With MockServer</a></li>
<li><a href="#verify-behaviour-with-proxy">Verifying With The Proxy</a></li>
</ul>
</li>
<li><a href="#analysing-behaviour">Analysing Behaviour</a></li>
<li><a href="#ensuring-tests-can-run-in-parallel">Ensuring Tests Can Run In Parallel</a></li>
<li><a href="#clear-and-reset">Clear & Reset</a></li>
<li><a href="#debugging-issues">Debugging Issues</a></li>
<li><a href="#requirements">Requirements</a></li>
<li><a href="#versions">Versions</a>
<ul>
<li><a href="#github">github</a></li>
<li><a href="#maven-central">Maven Central</a></li>
<li><a href="#ruby-gems">Ruby Gems</a></li>
<li><a href="#npm-modules">npm</a></li>
<li><a href="#vertx-registry">Vert.x Registry</a></li>
<li><a href="#docker-index">Docker Index</a></li>
</ul>
</li>
<li><a href="#continuous-integration">Continuous Integration</a></li>
<li><a href="#backlog">Backlog</a></li>
</ul>
<p style="display: block; overflow: hidden"><span style="float: right"><a href="https://plus.google.com/110954472544793839756?rel=author">James D Bloom</a> - <a href="http://blog.jamesdbloom.com">Blog</a></span></p>
<span itemprop=author itemscope itemtype="http://schema.org/Person">
<meta itemprop=name content="James D Bloom">
<meta itemprop=image content="http://blog.jamesdbloom.com/jamesdbloom.jpg">
<meta itemprop=givenName content=James>
<meta itemprop=familyName content=Bloom>
<meta itemprop=gender content=male>
</span>
<meta itemprop=name content=MockServer>
<meta itemprop=description content="An API to easily mock any system or service you integrate with via HTTP or HTTPS from either Java or JavaScript.">
</div>
</div>
</div>
</body>
<script>(function(window,document){var layout=document.getElementById('layout'),menu=document.getElementById('menu'),menuLink=document.getElementById('menuLink');function toggleClass(element,className){var classes=element.className.split(/\s+/),length=classes.length,i=0;for(;i<length;i++){if(classes[i]===className){classes.splice(i,1);break;}}
if(length===classes.length){classes.push(className);}
element.className=classes.join(' ');}
menuLink.onclick=function(e){var active='active';e.preventDefault();toggleClass(layout,active);toggleClass(menu,active);toggleClass(menuLink,active);};}(this,this.document));</script>
<script>var _gaq=_gaq||[];_gaq.push(['_setAccount','UA-32687194-4']);_gaq.push(['_trackPageview']);(function(){var ga=document.createElement('script');ga.type='text/javascript';ga.async=true;ga.src=('https:'==document.location.protocol?'https://':'http://')+'stats.g.doubleclick.net/dc.js';var s=document.getElementsByTagName('script')[0];s.parentNode.insertBefore(ga,s);})();</script>
</html>